<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>【置顶】Hello, hugo! | lvbibir's Blog</title>
<meta name=keywords content="hugo,papermod,docker,博客部署,博客优化"><meta name=description content="记录 wordpress 迁移至 hugo+papermod 的过程, 包含环境搭建、博客美化、功能实现、速度优化等……"><meta name=author content="作者:&nbsp;lvbibir"><link rel=canonical href=https://www.lvbibir.cn/en/posts/blog/hello-hugo/><link crossorigin=anonymous href=/assets/css/stylesheet.ea2d3aa74caabd1c227305342e99c488a04870896b2f729dec906b90f7870787.css integrity="sha256-6i06p0yqvRwicwU0LpnEiKBIcIlrL3Kd7JBrkPeHB4c=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=16x16 href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=32x32 href=https://www.lvbibir.cn/img/avatar.gif><link rel=apple-touch-icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=mask-icon href=https://www.lvbibir.cn/img/avatar.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="【置顶】Hello, hugo!"><meta property="og:description" content="记录 wordpress 迁移至 hugo+papermod 的过程, 包含环境搭建、博客美化、功能实现、速度优化等……"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lvbibir.cn/en/posts/blog/hello-hugo/"><meta property="og:image" content="https://image.lvbibir.cn/blog/hugo-logo-wide.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2024-01-13T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://image.lvbibir.cn/blog/hugo-logo-wide.svg"><meta name=twitter:title content="【置顶】Hello, hugo!"><meta name=twitter:description content="记录 wordpress 迁移至 hugo+papermod 的过程, 包含环境搭建、博客美化、功能实现、速度优化等……"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":5,"name":"【置顶】Hello, hugo!","item":"https://www.lvbibir.cn/en/posts/blog/hello-hugo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"【置顶】Hello, hugo!","name":"【置顶】Hello, hugo!","description":"记录 wordpress 迁移至 hugo+papermod 的过程, 包含环境搭建、博客美化、功能实现、速度优化等……","keywords":["hugo","papermod","docker","博客部署","博客优化"],"articleBody":"前言 本文内容比较杂乱, 无法保证实时更新, 如果遇到问题, 可以在 github 查看最新的配置:\nhugo 相关配置 docker 相关配置 研究 hugo 建站之初是打算采用 Github Pages 来发布静态博客\n优点 仅需一个 github 账号和简单配置即可将静态博客发布到 github pages 没有维护的时间成本, 可以将精力更多的放到博客内容本身上去 无需备案 无需 ssl 证书 缺点 访问速度较慢 访问速度较慢 访问速度较慢 虽说访问速度较慢可以通过各家的 cdn 加速来解决, 但由于刚开始建立 blog 选择的是 wordpress, 域名, 服务器, 备案, 证书等都已经一应俱全, 且之前的架构采用 docker, 添加一台 nginx 来跑 hugo 的静态网站是很方便的\n将博客部署到阿里云 整个步骤最难的地方可能就是 docker-compose 和 nginx 的配置了, 如果之前没有接触过可能会比较吃力, 因此我打包了一份开袋即食的配置文件, 只需要修改一些必要配置, 点此链接下载\n下载完将压缩包上传到自己的服务器, 解压后重命名为 blog (当然你可以用其他名字)\n下面正式开始部署:\n确保服务器公网 ip、安全组权限 (80/443), 域名绑定, ssl 证书等基础配置已经一应俱全 确保服务器安装了 docker 和 docker-compose 修改 blog/conf/nginx-hugo/nginx.conf 和 blog/conf/nginx-proxy/default.conf, 需要修改的地方在文件中已经标注出来了 将你的 ssl 证书放到 blog/ssl/ 目录下 在 blog 目录下执行 docker-compose up -d 即可启动容器 配置 twikoo 的前端代码, 参考下文 将 hugo 生成的静态文件上传到 blog/data/hugo/ 目录, 参考下文 至此已经配置完成, 应该可以通过域名访问 hugo 站点了, 后续更新内容只需要重复最后一步, 将 hugo 生成的静态文件上传到服务器即可\n所有的配置、应用数据、日志都保存在 blog 目录下, 你可以在不同的服务器上快速迁移 hugo 环境, 无需担心后续想要迁移新服务器时遇到的各种问题\nworkflow 在这里简单介绍一下我从写博客 -\u003e 发布到服务器 -\u003e 归档备份的整个流程\n总体流程:\nobsidian 编辑文章, 图片通过 Image Auto Upload Plugin 插件配合 piclist 上传到阿里云 OSS, 具体配置和操作见 docker 部署 piclist 编辑完成后将通过 此脚本 将编辑后的文章更新到 hugo site 目录, 同时也是 git 仓库 使用 hugo server -D 预览变更, 如有问题重复前两个步骤 确认无误后通过 此脚本 生成静态文件, 并将文件远程同步到公网服务器, 完成博客内容变更 最后将 git 仓库的变更提交后同步到 github 远程仓库, 完成归档备份 其实如果使用 vscode 直接编辑 git 仓库中的博客文章可以让整个流程更加简化, 但是 vscode 的 markdown 编辑体验实在是比不上 typora 或者 obsidian, 工欲善其事必先利其器, 有了好的编辑体验才更愿意输出内容\ntwikoo 部署 twikoo 官方提供了 丰富的部署方式, 考虑到访问速度, 本文使用的是 docker 方式部署到阿里云服务器\n如果是使用 将博客部署到阿里云 步骤中的配置文件部署了 twikoo, 这步直接忽略, 配置前端代码即可\ndocker run --name twikoo -e TWIKOO_THROTTLE=1000 -p 8080:8080 -v ${PWD}/data:/app/data -d imaegoo/twikoo 部署完成后看到如下结果即成功\n[root@lvbibir ~]# curl http://localhost:8080 {\"code\":100, \"message\":\"Twikoo 云函数运行正常, 请参考 https://twikoo.js.org/quick-start.html#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2 完成前端的配置\", \"version\":\"1.6.7\"} 后续最好套上反向代理, 加上域名和证书\n前端代码 创建或者修改 layouts\\partials\\comments.html\n\u003cdiv\u003e \u003cdiv class=\"pagination__title\"\u003e \u003cspan class=\"pagination__title-h\" style=\"font-size: 20px;\"\u003e💬评论\u003c/span\u003e \u003chr /\u003e \u003c/div\u003e \u003cdiv id=\"tcomment\"\u003e\u003c/div\u003e \u003cscript src=\"https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js\"\u003e\u003c/script\u003e \u003cscript\u003e twikoo.init({ envId: \"\", //填自己的, 例如：https://example.com el: \"#tcomment\", lang: 'zh-CN', path: window.TWIKOO_MAGIC_PATH||window.location.pathname, }); \u003c/script\u003e \u003c/div\u003e 调用上述 twikoo 代码的位置：layouts/_default/single.html\n\u003carticle class=\"post-single\"\u003e // 其他代码...... {{- if (.Param \"comments\") }} {{- partial \"comments.html\" . }} {{- end }} \u003c/article\u003e 在站点配置文件 config 中加上版本号\nparams: twikoo: version: 1.6.7 更新 修改 dockerfile.yml 中的镜像 tag 部署新版本容器 docker-compose up -d 在 hugo 配置文件 config.yml 中修改 twikoo 版本 修改数据 直接修改 blog/data/twikoo/ 目录下的文件后重启容器, ❗慎重修改\n修改 smms 图床的 api 地址 已于 1.6.12 新版本修复, https://github.com/imaegoo/twikoo/releases/tag/1.6.12\n由于 sm.ms 域名国内无法访问, twikoo 官方还没有出具体的修改方式, 自己修改容器配置文件进行修改\n# 复制配置文件 [root@lvbibir blog]# docker cp twikoo:/app/node_modules/twikoo-func/utils/image.js /root/blog/conf/twikoo/ # 修改配置文件, 原来的配置是 https://sm.ms/api.v2/upload [root@lvbibir blog]# grep smms conf/twikoo/image.js } else if (config.IMAGE_CDN === 'smms') { const uploadResult = await axios.post('https://smms.app/api/v2/upload', formData, { # 将配置文件映射进容器内, 重启容器即可 [root@lvbibir blog]# grep twikoo docker-compose.yml twikoo: image: imaegoo/twikoo container_name: twikoo - $PWD/data/twikoo:/app/data - $PWD/conf/twikoo/image.js:/app/node_modules/twikoo-func/utils/image.js Artitalk 官方文档\n需要注意的是如果使用的是国际版的 LeadCloud, 需要绑定自定义域名后才能正常访问\nleancloud 配置 前往 LeanCloud 国际版, 注册账号 注册完成之后根据 LeanCloud 的提示绑定手机号和邮箱 绑定完成之后点击 创建应用, 应用名称随意, 接着在 结构化数据 中创建 class, 命名为 shuoshuo 在你新建的应用中找到 结构化数据 下的 用户 点击 添加用户, 输入想用的用户名及密码 回到 结构化数据 中, 点击 class 下的 shuoshuo 找到权限, 在 Class 访问权限 中将 add_fields 以及 create 权限设置为指定用户, 输入你刚才输入的用户名会自动匹配为了安全起见, 将 delete 和 update 也设置为跟它们一样的权限 然后新建一个名为 atComment 的 class, 权限什么的使用默认的即可 点击 class 下的 _User 添加列, 列名称为 img, 默认值填上你这个账号想要用的发布说说的头像 url, 这一项不进行配置, 说说头像会显示为默认头像 —— Artitalk 的 logo 在最菜单栏中找到设置 -\u003e 应用 keys, 记下来 AppID 和 AppKey , 一会会用 最后将 _User 中的权限全部调为指定用户, 或者数据创建者, 为了保证不被篡改用户数据以达到强制发布说说 在设置 -\u003e域名绑定中绑定自定义域名 ❗ 关于设置权限的这几步 这几步一定要设置好, 才可以保证不被 “闲人” 破解发布说说的验证\nhugo 配置 新增 content/talk.md 页面, 内容如下, 注意修改标注的内容, front-matter 的内容自行修改\n--- title: \"💬 说说\" date: 2021-08-31 hidemeta: true description: \"胡言乱语\" comments: true reward: false showToc: false TocOpen: false showbreadcrumbs: false --- \u003cbody\u003e \u003cscript type=\"text/javascript\" src=\"https://unpkg.com/artitalk\"\u003e\u003c/script\u003e \u003cdiv id=\"artitalk_main\"\u003e\u003c/div\u003e \u003cscript\u003e new Artitalk({ appId: '**********', // Your LeanCloud appId appKey: '************', // Your LeanCloud appKey serverURL: '*********' // 绑定的自定义域名 }) \u003c/script\u003e \u003c/body\u003e 这个时候已经可以直接访问了, https://your.domain.com/talk\n输入 leancloud 配置步骤中的第 4 步配置的用户名密码登录后就可以发布说说了\n自定义 footer 自定义页脚内容\n添加完下面的页脚内容后要修改 assets\\css\\extended\\blank.css 中的 --footer-height 的大小, 具体数字需要考虑到行数和字体大小\n自定义徽标 徽标功能源自：https://shields.io/ 考虑到访问速度, 可以在生成完徽标后放到自己的 cdn 上\n在 layouts\\partials\\footer.html 中的 添加如下\n\u003ca href=\"https://gohugo.io/\" target=\"_blank\"\u003e \u003cimg src=\"https://img.shields.io/static/v1?\u0026style=plastic\u0026color=308fb5\u0026label=Power by\u0026message=hugo\u0026logo=hugo\" style=\"display: unset;\"\u003e \u003c/a\u003e 网站运行时间 在 layouts\\partials\\footer.html 中的 添加如下\n起始时间自行修改\n\u003cspan id=\"runtime_span\"\u003e\u003c/span\u003e \u003cscript type=\"text/javascript\"\u003efunction show_runtime(){window.setTimeout(\"show_runtime()\", 1000);X=new Date(\"7/13/2021 1:00:00\");Y=new Date();T=(Y.getTime()-X.getTime());M=24*60*60*1000;a=T/M;A=Math.floor(a);b=(a-A)*24;B=Math.floor(b);c=(b-B)*60;C=Math.floor((b-B)*60);D=Math.floor((c-C)*60);runtime_span.innerHTML=\"网站已运行\"+A+\"天\"+B+\"小时\"+C+\"分\"+D+\"秒\"}show_runtime();\u003c/script\u003e 访问人数统计 统计功能源自：http://busuanzi.ibruce.info/\n在 layouts\\partials\\footer.html 中的 添加如下\n\u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"\u003e\u003c/script\u003e \u003cspan id=\"busuanzi_container\"\u003e \u003clink rel=\"stylesheet\" href=\"//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css\"\u003e 总访客数: \u003ci class=\"fa fa-user\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003e | 总访问量: \u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003e | 本页访问量: \u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_page_pv\"\u003e\u003c/span\u003e \u003c/span\u003e 自定义字体 可以使用一些在线的字体, 可能会比较慢, 推荐下载想要的字体放到自己的服务器或者 cdn 上\n修改 assets\\css\\extended\\fonts.css, 添加 @font-face\n@font-face { font-family: \"LXGWWenKaiLite-Bold\"; src: url(\"https://your.domain.com/fonts/test.woff2\") format(\"woff2\"); font-display: swap; } 修改 assets\\css\\extended\\blank.css, 推荐将英文字体放在前面, 可以实现英文和中文使用不同字体\n.post-content { font-family: Consolas, \"LXGWWenKaiLite-Bold\"; //修改 } body { font-family: Consolas, \"LXGWWenKaiLite-Bold\"; //修改 } 修改链接颜色 在 hugo+papermod 默认配置下, 链接颜色是黑色字体带下划线的组合, 个人非常喜欢 typora-vue 的渲染风格 hugo官方文档 给出了通过 render hooks 覆盖默认的 markdown 渲染 link 的方式\n新建 layouts/_default/_markup/render-link.html 文件, 内容如下在官方给出的示例中添加了 style=\"color:#42b983, 颜色可以自行修改\n\u003ca href=\"{{ .Destination | safeURL }}\"{{ with .Title}} title=\"{{ . }}\"{{ end }}{{ if strings.HasPrefix .Destination \"http\" }} target=\"_blank\" rel=\"noopener\" style=\"color:#42b983\";{{ end }}\u003e{{ .Text | safeHTML }}\u003c/a\u003e shortcode ppt、bilibili、youtube、豆瓣阅读和电影卡片\nmermaid\n图片画廊\n其他修改 其他 css 样式修改基本都是通过 f12 控制台一点点摸索改的, 不太规范且比较琐碎就不单独记录了, 其实我根本已经忘记还改了哪些东西\n以上\n","wordCount":"2914","inLanguage":"en","image":"https://image.lvbibir.cn/blog/hugo-logo-wide.svg","datePublished":"2022-07-06T00:00:00Z","dateModified":"2024-01-13T00:00:00Z","author":{"@type":"Person","name":"lvbibir"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lvbibir.cn/en/posts/blog/hello-hugo/"},"publisher":{"@type":"Organization","name":"lvbibir's Blog","logo":{"@type":"ImageObject","url":"https://www.lvbibir.cn/img/avatar.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.lvbibir.cn/en/ accesskey=h title="lvbibir's Blog (Alt + H)"><img src=https://www.lvbibir.cn/img/avatar.gif alt aria-label=logo height=35>lvbibir's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li class=menu-item><a href=https://www.lvbibir.cn/en/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/en/posts title="📚 文章"><span>📚 文章</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/en/archives title="📈 归档"><span>📈 归档</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/en/talk title="💬 说说"><span>💬 说说</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/en/links title="🤝 友链"><span>🤝 友链</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://www.lvbibir.cn/en/>主页</a></div><h1 class=post-title>【置顶】Hello, hugo!</h1><div class=post-description>记录 wordpress 迁移至 hugo+papermod 的过程, 包含环境搭建、博客美化、功能实现、速度优化等……</div><div class=post-meta>创建:&amp;nbsp;&lt;span title='2022-07-06 00:00:00 +0000 UTC'>2022-07-06&lt;/span>&amp;nbsp;|&amp;nbsp;更新:&amp;nbsp;2024-01-13&amp;nbsp;|&amp;nbsp;字数:&amp;nbsp;2914字&amp;nbsp;|&amp;nbsp;作者:&amp;nbsp;lvbibir
|&nbsp;标签:&nbsp;<ul class=post-tags-meta><a href=https://www.lvbibir.cn/en/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/>博客搭建</a></ul><span id=busuanzi_container_page_pv>&nbsp;|&nbsp;访问:&nbsp;<span id=busuanzi_value_page_pv></span></span></div></header><figure class=entry-cover1><img loading=lazy src=https://image.lvbibir.cn/blog/hugo-logo-wide.svg alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>文章目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e5%b0%86%e5%8d%9a%e5%ae%a2%e9%83%a8%e7%bd%b2%e5%88%b0%e9%98%bf%e9%87%8c%e4%ba%91 aria-label=将博客部署到阿里云>将博客部署到阿里云</a></li><li><a href=#workflow aria-label=workflow>workflow</a></li><li><a href=#twikoo aria-label=twikoo>twikoo</a><ul><li><a href=#%e9%83%a8%e7%bd%b2 aria-label=部署>部署</a></li><li><a href=#%e5%89%8d%e7%ab%af%e4%bb%a3%e7%a0%81 aria-label=前端代码>前端代码</a></li><li><a href=#%e6%9b%b4%e6%96%b0 aria-label=更新>更新</a></li><li><a href=#%e4%bf%ae%e6%94%b9%e6%95%b0%e6%8d%ae aria-label=修改数据>修改数据</a></li><li><a href=#%e4%bf%ae%e6%94%b9-smms-%e5%9b%be%e5%ba%8a%e7%9a%84-api-%e5%9c%b0%e5%9d%80 aria-label="修改 smms 图床的 api 地址">修改 smms 图床的 api 地址</a></li></ul></li><li><a href=#artitalk aria-label=Artitalk>Artitalk</a><ul><li><a href=#leancloud-%e9%85%8d%e7%bd%ae aria-label="leancloud 配置">leancloud 配置</a></li><li><a href=#hugo-%e9%85%8d%e7%bd%ae aria-label="hugo 配置">hugo 配置</a></li></ul></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89-footer aria-label="自定义 footer">自定义 footer</a><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%be%bd%e6%a0%87 aria-label=自定义徽标>自定义徽标</a></li><li><a href=#%e7%bd%91%e7%ab%99%e8%bf%90%e8%a1%8c%e6%97%b6%e9%97%b4 aria-label=网站运行时间>网站运行时间</a></li><li><a href=#%e8%ae%bf%e9%97%ae%e4%ba%ba%e6%95%b0%e7%bb%9f%e8%ae%a1 aria-label=访问人数统计>访问人数统计</a></li></ul></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ad%97%e4%bd%93 aria-label=自定义字体>自定义字体</a></li><li><a href=#%e4%bf%ae%e6%94%b9%e9%93%be%e6%8e%a5%e9%a2%9c%e8%89%b2 aria-label=修改链接颜色>修改链接颜色</a></li><li><a href=#shortcode aria-label=shortcode>shortcode</a></li><li><a href=#%e5%85%b6%e4%bb%96%e4%bf%ae%e6%94%b9 aria-label=其他修改>其他修改</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h1><p>本文内容比较杂乱, 无法保证实时更新, 如果遇到问题, 可以在 github 查看最新的配置:</p><ul><li><a href=https://github.com/lvbibir/lvbibir.github.io target=_blank rel=noopener style=color:#42b983 ;>hugo 相关配置</a></li><li><a href=https://github.com/lvbibir/blog-bak target=_blank rel=noopener style=color:#42b983 ;>docker 相关配置</a></li></ul><p>研究 hugo 建站之初是打算采用 <code>Github Pages</code> 来发布静态博客</p><ul><li>优点<ul><li>仅需一个 github 账号和简单配置即可将静态博客发布到 github pages</li><li>没有维护的时间成本, 可以将精力更多的放到博客内容本身上去</li><li>无需备案</li><li>无需 ssl 证书</li></ul></li><li>缺点<ul><li>访问速度较慢</li><li>访问速度较慢</li><li>访问速度较慢</li></ul></li></ul><p>虽说访问速度较慢可以通过各家的 cdn 加速来解决, 但由于刚开始建立 blog 选择的是 wordpress, 域名, 服务器, 备案, 证书等都已经一应俱全, 且之前的架构采用 docker, 添加一台 nginx 来跑 hugo 的静态网站是很方便的</p><h1 id=将博客部署到阿里云>将博客部署到阿里云<a hidden class=anchor aria-hidden=true href=#将博客部署到阿里云>#</a></h1><p>整个步骤最难的地方可能就是 docker-compose 和 nginx 的配置了, 如果之前没有接触过可能会比较吃力, 因此我打包了一份开袋即食的配置文件, 只需要修改一些必要配置, <a href=https://image.lvbibir.cn/files/blog-docker-compose.zip target=_blank rel=noopener style=color:#42b983 ;>点此链接下载</a></p><p>下载完将压缩包上传到自己的服务器, 解压后重命名为 <code>blog</code> (当然你可以用其他名字)</p><p>下面正式开始部署:</p><ol><li>确保服务器公网 ip、安全组权限 (80/443), 域名绑定, ssl 证书等基础配置已经一应俱全</li><li>确保服务器安装了 docker 和 docker-compose</li><li>修改 <code>blog/conf/nginx-hugo/nginx.conf</code> 和 <code>blog/conf/nginx-proxy/default.conf</code>, 需要修改的地方在文件中已经标注出来了</li><li>将你的 ssl 证书放到 <code>blog/ssl/</code> 目录下</li><li>在 <code>blog</code> 目录下执行 <code>docker-compose up -d</code> 即可启动容器</li><li>配置 twikoo 的前端代码, <a href=#twikoo>参考下文</a></li><li>将 hugo 生成的静态文件上传到 <code>blog/data/hugo/</code> 目录, <a href=#workflow>参考下文</a></li></ol><p>至此已经配置完成, 应该可以通过域名访问 hugo 站点了, 后续更新内容只需要重复最后一步, 将 hugo 生成的静态文件上传到服务器即可</p><p>所有的配置、应用数据、日志都保存在 blog 目录下, 你可以在不同的服务器上快速迁移 hugo 环境, 无需担心后续想要迁移新服务器时遇到的各种问题</p><h1 id=workflow>workflow<a hidden class=anchor aria-hidden=true href=#workflow>#</a></h1><p>在这里简单介绍一下我从写博客 -> 发布到服务器 -> 归档备份的整个流程</p><p>总体流程:</p><ol><li>obsidian 编辑文章, 图片通过 <code>Image Auto Upload Plugin</code> 插件配合 piclist 上传到阿里云 OSS, 具体配置和操作见 <a href=https://www.lvbibir.cn/posts/blog/docker-deploy-piclist target=_blank rel=noopener style=color:#42b983 ;>docker 部署 piclist</a></li><li>编辑完成后将通过 <a href=https://github.com/lvbibir/lvbibir.github.io/blob/master/update-file.sh target=_blank rel=noopener style=color:#42b983 ;>此脚本</a> 将编辑后的文章更新到 hugo site 目录, 同时也是 git 仓库</li><li>使用 <code>hugo server -D</code> 预览变更, 如有问题重复前两个步骤</li><li>确认无误后通过 <a href=https://github.com/lvbibir/lvbibir.github.io/blob/master/upload-file.sh target=_blank rel=noopener style=color:#42b983 ;>此脚本</a> 生成静态文件, 并将文件远程同步到公网服务器, 完成博客内容变更</li><li>最后将 git 仓库的变更提交后同步到 github 远程仓库, 完成归档备份</li></ol><p>其实如果使用 vscode 直接编辑 git 仓库中的博客文章可以让整个流程更加简化, 但是 vscode 的 markdown 编辑体验实在是比不上 typora 或者 obsidian, 工欲善其事必先利其器, 有了好的编辑体验才更愿意输出内容</p><h1 id=twikoo>twikoo<a hidden class=anchor aria-hidden=true href=#twikoo>#</a></h1><h2 id=部署>部署<a hidden class=anchor aria-hidden=true href=#部署>#</a></h2><p>twikoo 官方提供了 <a href=https://twikoo.js.org/quick-start.html target=_blank rel=noopener style=color:#42b983 ;>丰富的部署方式</a>, 考虑到访问速度, 本文使用的是 docker 方式部署到阿里云服务器</p><blockquote><p>如果是使用 <a href=#%e5%b0%86%e5%8d%9a%e5%ae%a2%e9%83%a8%e7%bd%b2%e5%88%b0%e9%98%bf%e9%87%8c%e4%ba%91>将博客部署到阿里云</a> 步骤中的配置文件部署了 twikoo, 这步直接忽略, 配置前端代码即可</p></blockquote><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --name twikoo -e <span style=color:#ef6155>TWIKOO_THROTTLE</span><span style=color:#5bc4bf>=</span><span style=color:#f99b15>1000</span> -p 8080:8080 -v <span style=color:#f99b15>${</span><span style=color:#ef6155>PWD</span><span style=color:#f99b15>}</span>/data:/app/data -d imaegoo/twikoo
</span></span></code></pre></div><p>部署完成后看到如下结果即成功</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir ~<span style=color:#5bc4bf>]</span><span style=color:#776e71># curl http://localhost:8080</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>{</span><span style=color:#48b685>&#34;code&#34;</span>:100, <span style=color:#48b685>&#34;message&#34;</span>:<span style=color:#48b685>&#34;Twikoo 云函数运行正常, 请参考 https://twikoo.js.org/quick-start.html#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2 完成前端的配置&#34;</span>, <span style=color:#48b685>&#34;version&#34;</span>:<span style=color:#48b685>&#34;1.6.7&#34;</span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div><p>后续最好套上反向代理, 加上域名和证书</p><h2 id=前端代码>前端代码<a hidden class=anchor aria-hidden=true href=#前端代码>#</a></h2><p>创建或者修改 <code>layouts\partials\comments.html</code></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#776e71>&lt;!-- Twikoo --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>div</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;pagination__title&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;pagination__title-h&#34;</span> <span style=color:#06b6ef>style</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;font-size: 20px;&#34;</span>&gt;💬评论&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#5bc4bf>hr</span> /&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>div</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;tcomment&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#06b6ef>twikoo</span>.<span style=color:#06b6ef>init</span>({
</span></span><span style=display:flex><span>            <span style=color:#06b6ef>envId</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#34;&#34;</span>,  <span style=color:#776e71>//填自己的, 例如：https://example.com
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>            <span style=color:#06b6ef>el</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#34;#tcomment&#34;</span>, 
</span></span><span style=display:flex><span>            <span style=color:#06b6ef>lang</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;zh-CN&#39;</span>, 
</span></span><span style=display:flex><span>            <span style=color:#06b6ef>path</span><span style=color:#5bc4bf>:</span> window.<span style=color:#06b6ef>TWIKOO_MAGIC_PATH</span><span style=color:#5bc4bf>||</span>window.<span style=color:#06b6ef>location</span>.<span style=color:#06b6ef>pathname</span>, 
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    &lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span></code></pre></div><p>调用上述 twikoo 代码的位置：<code>layouts/_default/single.html</code></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>article</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;post-single&#34;</span>&gt;
</span></span><span style=display:flex><span>  // 其他代码......
</span></span><span style=display:flex><span>  {{- if (.Param &#34;comments&#34;) }}
</span></span><span style=display:flex><span>    {{- partial &#34;comments.html&#34; . }}
</span></span><span style=display:flex><span>  {{- end }}
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>article</span>&gt;
</span></span></code></pre></div><p>在站点配置文件 config 中加上版本号</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#5bc4bf>params</span>:
</span></span><span style=display:flex><span>	<span style=color:#5bc4bf>twikoo</span>:
</span></span><span style=display:flex><span>      <span style=color:#5bc4bf>version</span>: <span style=color:#f99b15>1.6.7</span>
</span></span></code></pre></div><h2 id=更新>更新<a hidden class=anchor aria-hidden=true href=#更新>#</a></h2><ol><li>修改 dockerfile.yml 中的镜像 tag</li><li>部署新版本容器 <code>docker-compose up -d</code></li><li>在 hugo 配置文件 config.yml 中修改 twikoo 版本</li></ol><h2 id=修改数据>修改数据<a hidden class=anchor aria-hidden=true href=#修改数据>#</a></h2><p>直接修改 <code>blog/data/twikoo/</code> 目录下的文件后重启容器, ❗慎重修改</p><h2 id=修改-smms-图床的-api-地址>修改 smms 图床的 api 地址<a hidden class=anchor aria-hidden=true href=#修改-smms-图床的-api-地址>#</a></h2><blockquote><p>已于 1.6.12 新版本修复, <a href=https://github.com/imaegoo/twikoo/releases/tag/1.6.12 target=_blank rel=noopener style=color:#42b983 ;>https://github.com/imaegoo/twikoo/releases/tag/1.6.12</a></p></blockquote><p>由于 <code>sm.ms</code> 域名国内无法访问, <del>twikoo 官方还没有出具体的修改方式</del>, 自己修改容器配置文件进行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#776e71># 复制配置文件</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir blog<span style=color:#5bc4bf>]</span><span style=color:#776e71># docker cp twikoo:/app/node_modules/twikoo-func/utils/image.js /root/blog/conf/twikoo/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#776e71># 修改配置文件, 原来的配置是 https://sm.ms/api.v2/upload</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir blog<span style=color:#5bc4bf>]</span><span style=color:#776e71># grep smms conf/twikoo/image.js</span>
</span></span><span style=display:flex><span>      <span style=color:#5bc4bf>}</span> <span style=color:#815ba4>else</span> <span style=color:#815ba4>if</span> <span style=color:#5bc4bf>(</span>config.IMAGE_CDN <span style=color:#5bc4bf>===</span> <span style=color:#48b685>&#39;smms&#39;</span><span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    const <span style=color:#ef6155>uploadResult</span> <span style=color:#5bc4bf>=</span> await axios.post<span style=color:#5bc4bf>(</span><span style=color:#48b685>&#39;https://smms.app/api/v2/upload&#39;</span>,  formData,  <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#776e71># 将配置文件映射进容器内, 重启容器即可</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir blog<span style=color:#5bc4bf>]</span><span style=color:#776e71># grep twikoo docker-compose.yml</span>
</span></span><span style=display:flex><span>  twikoo:
</span></span><span style=display:flex><span>    image: imaegoo/twikoo
</span></span><span style=display:flex><span>    container_name: twikoo
</span></span><span style=display:flex><span>      - <span style=color:#ef6155>$PWD</span>/data/twikoo:/app/data
</span></span><span style=display:flex><span>      - <span style=color:#ef6155>$PWD</span>/conf/twikoo/image.js:/app/node_modules/twikoo-func/utils/image.js
</span></span></code></pre></div><h1 id=artitalk>Artitalk<a hidden class=anchor aria-hidden=true href=#artitalk>#</a></h1><p><a href=https://artitalk.js.org/doc.html target=_blank rel=noopener style=color:#42b983 ;>官方文档</a></p><p>需要注意的是如果使用的是国际版的 LeadCloud, 需要绑定自定义域名后才能正常访问</p><h2 id=leancloud-配置>leancloud 配置<a hidden class=anchor aria-hidden=true href=#leancloud-配置>#</a></h2><ol><li>前往 <a href=https://leancloud.app/ target=_blank rel=noopener style=color:#42b983 ;>LeanCloud 国际版</a>, 注册账号</li><li>注册完成之后根据 LeanCloud 的提示绑定手机号和邮箱</li><li>绑定完成之后点击 <code>创建应用</code>, 应用名称随意, 接着在 <code>结构化数据</code> 中创建 <code>class</code>, 命名为 <code>shuoshuo</code></li><li>在你新建的应用中找到 <code>结构化数据</code> 下的 <code>用户</code> 点击 <code>添加用户</code>, 输入想用的用户名及密码</li><li>回到 <code>结构化数据</code> 中, 点击 <code>class</code> 下的 <code>shuoshuo</code> 找到权限, 在 <code>Class 访问权限</code> 中将 <code>add_fields</code> 以及 <code>create</code> 权限设置为指定用户, 输入你刚才输入的用户名会自动匹配为了安全起见, 将 <code>delete</code> 和 <code>update</code> 也设置为跟它们一样的权限</li><li>然后新建一个名为 <code>atComment</code> 的 class, 权限什么的使用默认的即可</li><li>点击 <code>class</code> 下的 <code>_User</code> 添加列, 列名称为 <code>img</code>, 默认值填上你这个账号想要用的发布说说的头像 url, 这一项不进行配置, 说说头像会显示为默认头像 —— Artitalk 的 logo</li><li>在最菜单栏中找到设置 -> 应用 keys, 记下来 <code>AppID</code> 和 <code>AppKey</code> , 一会会用</li><li>最后将 <code>_User</code> 中的权限全部调为指定用户, 或者数据创建者, 为了保证不被篡改用户数据以达到强制发布说说</li><li>在设置 ->域名绑定中绑定自定义域名</li></ol><blockquote><p>❗ 关于设置权限的这几步
这几步一定要设置好, 才可以保证不被 “闲人” 破解发布说说的验证</p></blockquote><h2 id=hugo-配置>hugo 配置<a hidden class=anchor aria-hidden=true href=#hugo-配置>#</a></h2><p>新增 <code>content/talk.md</code> 页面, 内容如下, 注意修改标注的内容, front-matter 的内容自行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;💬 说说&#34;
</span></span><span style=display:flex><span>date: 2021-08-31
</span></span><span style=display:flex><span>hidemeta: true
</span></span><span style=display:flex><span>description: &#34;胡言乱语&#34;
</span></span><span style=display:flex><span>comments: true
</span></span><span style=display:flex><span>reward: false
</span></span><span style=display:flex><span>showToc: false 
</span></span><span style=display:flex><span>TocOpen: false 
</span></span><span style=display:flex><span>showbreadcrumbs: false
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>body</span>&gt;
</span></span><span style=display:flex><span><span style=color:#776e71>&lt;!-- 引用 artitalk --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>type</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;text/javascript&#34;</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://unpkg.com/artitalk&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#776e71>&lt;!-- 存放说说的容器 --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>div</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;artitalk_main&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#815ba4>new</span> <span style=color:#06b6ef>Artitalk</span>({
</span></span><span style=display:flex><span>    <span style=color:#06b6ef>appId</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;**********&#39;</span>,  <span style=color:#776e71>// Your LeanCloud appId
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>    <span style=color:#06b6ef>appKey</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;************&#39;</span>,  <span style=color:#776e71>// Your LeanCloud appKey
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>    <span style=color:#06b6ef>serverURL</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;*********&#39;</span> <span style=color:#776e71>// 绑定的自定义域名
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>})
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>body</span>&gt;
</span></span></code></pre></div><p>这个时候已经可以直接访问了, <code>https://your.domain.com/talk</code></p><p>输入 leancloud 配置步骤中的第 4 步配置的用户名密码登录后就可以发布说说了</p><h1 id=自定义-footer>自定义 footer<a hidden class=anchor aria-hidden=true href=#自定义-footer>#</a></h1><p>自定义页脚内容</p><p><img loading=lazy src=https://image.lvbibir.cn/blog/image-20220911150229930.png alt=image-20220911150229930></p><blockquote><p>添加完下面的页脚内容后要修改 <code>assets\css\extended\blank.css</code> 中的 <code>--footer-height</code> 的大小, 具体数字需要考虑到行数和字体大小</p></blockquote><h2 id=自定义徽标>自定义徽标<a hidden class=anchor aria-hidden=true href=#自定义徽标>#</a></h2><blockquote><p>徽标功能源自：<a href=https://shields.io/ target=_blank rel=noopener style=color:#42b983 ;>https://shields.io/</a>
考虑到访问速度, 可以在生成完徽标后放到自己的 cdn 上</p></blockquote><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>a</span> <span style=color:#06b6ef>href</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://gohugo.io/&#34;</span> <span style=color:#06b6ef>target</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;_blank&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>img</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://img.shields.io/static/v1?&amp;style=plastic&amp;color=308fb5&amp;label=Power by&amp;message=hugo&amp;logo=hugo&#34;</span> <span style=color:#06b6ef>style</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;display: unset;&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>a</span>&gt;
</span></span></code></pre></div><h2 id=网站运行时间>网站运行时间<a hidden class=anchor aria-hidden=true href=#网站运行时间>#</a></h2><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><p>起始时间自行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;runtime_span&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt; 
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>type</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;text/javascript&#34;</span>&gt;<span style=color:#815ba4>function</span> <span style=color:#06b6ef>show_runtime</span>(){window.<span style=color:#06b6ef>setTimeout</span>(<span style=color:#48b685>&#34;show_runtime()&#34;</span>, <span style=color:#f99b15>1000</span>);<span style=color:#06b6ef>X</span><span style=color:#5bc4bf>=</span><span style=color:#815ba4>new</span> Date(<span style=color:#48b685>&#34;7/13/2021 1:00:00&#34;</span>);<span style=color:#06b6ef>Y</span><span style=color:#5bc4bf>=</span><span style=color:#815ba4>new</span> Date();<span style=color:#06b6ef>T</span><span style=color:#5bc4bf>=</span>(<span style=color:#06b6ef>Y</span>.<span style=color:#06b6ef>getTime</span>()<span style=color:#5bc4bf>-</span><span style=color:#06b6ef>X</span>.<span style=color:#06b6ef>getTime</span>());<span style=color:#06b6ef>M</span><span style=color:#5bc4bf>=</span><span style=color:#f99b15>24</span><span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span><span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span><span style=color:#5bc4bf>*</span><span style=color:#f99b15>1000</span>;<span style=color:#06b6ef>a</span><span style=color:#5bc4bf>=</span><span style=color:#06b6ef>T</span><span style=color:#5bc4bf>/</span><span style=color:#06b6ef>M</span>;<span style=color:#06b6ef>A</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>(<span style=color:#06b6ef>a</span>);<span style=color:#06b6ef>b</span><span style=color:#5bc4bf>=</span>(<span style=color:#06b6ef>a</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>A</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>24</span>;<span style=color:#06b6ef>B</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>(<span style=color:#06b6ef>b</span>);<span style=color:#06b6ef>c</span><span style=color:#5bc4bf>=</span>(<span style=color:#06b6ef>b</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>B</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span>;<span style=color:#06b6ef>C</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>((<span style=color:#06b6ef>b</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>B</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span>);<span style=color:#06b6ef>D</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>((<span style=color:#06b6ef>c</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>C</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span>);<span style=color:#06b6ef>runtime_span</span>.<span style=color:#06b6ef>innerHTML</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;网站已运行&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>A</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;天&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>B</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;小时&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>C</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;分&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>D</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;秒&#34;</span>}<span style=color:#06b6ef>show_runtime</span>();&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span></code></pre></div><h2 id=访问人数统计>访问人数统计<a hidden class=anchor aria-hidden=true href=#访问人数统计>#</a></h2><blockquote><p>统计功能源自：<a href=http://busuanzi.ibruce.info/ target=_blank rel=noopener style=color:#42b983 ;>http://busuanzi.ibruce.info/</a></p></blockquote><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>async</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_container&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>link</span> <span style=color:#06b6ef>rel</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;stylesheet&#34;</span> <span style=color:#06b6ef>href</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css&#34;</span>&gt;
</span></span><span style=display:flex><span>    总访客数: &lt;<span style=color:#5bc4bf>i</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;fa fa-user&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>i</span>&gt;&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_value_site_uv&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>    |
</span></span><span style=display:flex><span>    总访问量: &lt;<span style=color:#5bc4bf>i</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;fa fa-eye&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>i</span>&gt;&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_value_site_pv&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>    |
</span></span><span style=display:flex><span>    本页访问量: &lt;<span style=color:#5bc4bf>i</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;fa fa-eye&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>i</span>&gt;&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_value_page_pv&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span></code></pre></div><h1 id=自定义字体>自定义字体<a hidden class=anchor aria-hidden=true href=#自定义字体>#</a></h1><p>可以使用一些在线的字体, 可能会比较慢, 推荐下载想要的字体放到自己的服务器或者 cdn 上</p><p>修改 <code>assets\css\extended\fonts.css</code>, 添加 <code>@font-face</code></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#815ba4>font-face</span> {
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>font-family</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#34;LXGWWenKaiLite-Bold&#34;</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>src</span><span style=color:#5bc4bf>:</span> <span style=color:#5bc4bf>url</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;https://your.domain.com/fonts/test.woff2&#34;</span><span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>format</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;woff2&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>font-display</span><span style=color:#5bc4bf>:</span> <span style=color:#5bc4bf>swap</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>修改 <code>assets\css\extended\blank.css</code>, 推荐将英文字体放在前面, 可以实现英文和中文使用不同字体</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>.<span style=color:#fec418>post-content</span> {
</span></span><span style=display:flex><span>    <span style=color:#815ba4>font-family</span>: Consolas,  <span style=color:#48b685>&#34;LXGWWenKaiLite-Bold&#34;</span>; <span style=color:#ef6155>//修改</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>body</span> {
</span></span><span style=display:flex><span>    <span style=color:#815ba4>font-family</span>: Consolas,  <span style=color:#48b685>&#34;LXGWWenKaiLite-Bold&#34;</span>; <span style=color:#ef6155>//修改</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=修改链接颜色>修改链接颜色<a hidden class=anchor aria-hidden=true href=#修改链接颜色>#</a></h1><p>在 hugo+papermod 默认配置下, 链接颜色是黑色字体带下划线的组合, 个人非常喜欢 <a href=https://github.com/blinkfox/typora-vue-theme target=_blank rel=noopener style=color:#42b983 ;>typora-vue</a> 的渲染风格 <a href=https://gohugo.io/templates/render-hooks/#link-with-title-markdown-example target=_blank rel=noopener style=color:#42b983 ;>hugo官方文档</a> 给出了通过 <code>render hooks</code> 覆盖默认的 markdown 渲染 link 的方式</p><p>新建 <code>layouts/_default/_markup/render-link.html</code> 文件, 内容如下在官方给出的示例中添加了 <code>style="color:#42b983</code>, 颜色可以自行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>a</span> <span style=color:#06b6ef>href</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;{{ .Destination | safeURL }}&#34;</span><span style=color:#ef6155>{{</span> <span style=color:#06b6ef>with</span> <span style=color:#ef6155>.</span><span style=color:#06b6ef>Title</span><span style=color:#ef6155>}}</span> <span style=color:#06b6ef>title</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;{{ . }}&#34;</span><span style=color:#ef6155>{{</span> <span style=color:#06b6ef>end</span> <span style=color:#ef6155>}}{{</span> <span style=color:#06b6ef>if</span> <span style=color:#06b6ef>strings</span><span style=color:#ef6155>.</span><span style=color:#06b6ef>HasPrefix</span> <span style=color:#ef6155>.</span><span style=color:#06b6ef>Destination</span> <span style=color:#ef6155>&#34;</span><span style=color:#06b6ef>http</span><span style=color:#ef6155>&#34;</span> <span style=color:#ef6155>}}</span> <span style=color:#06b6ef>target</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;_blank&#34;</span> <span style=color:#06b6ef>rel</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;noopener&#34;</span> <span style=color:#06b6ef>style</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;color:#42b983&#34;</span><span style=color:#ef6155>;{{</span> <span style=color:#06b6ef>end</span> <span style=color:#ef6155>}}</span>&gt;{{ .Text | safeHTML }}&lt;/<span style=color:#5bc4bf>a</span>&gt;
</span></span></code></pre></div><h1 id=shortcode>shortcode<a hidden class=anchor aria-hidden=true href=#shortcode>#</a></h1><p><a href=https://www.sulvblog.cn/posts/blog/shortcodes/ target=_blank rel=noopener style=color:#42b983 ;>ppt、bilibili、youtube、豆瓣阅读和电影卡片</a></p><p><a href=https://www.sulvblog.cn/posts/blog/hugo_mermaid/ target=_blank rel=noopener style=color:#42b983 ;>mermaid</a></p><p><a href=https://github.com/liwenyip/hugo-easy-gallery/ target=_blank rel=noopener style=color:#42b983 ;>图片画廊</a></p><h1 id=其他修改>其他修改<a hidden class=anchor aria-hidden=true href=#其他修改>#</a></h1><p>其他 css 样式修改基本都是通过 f12 控制台一点点摸索改的, 不太规范且比较琐碎就不单独记录了, <del>其实我根本已经忘记还改了哪些东西</del></p><p>以上</p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://www.lvbibir.cn/img/wechat_pay.png alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://www.lvbibir.cn/img/alipay.png alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>🧧 鼓励</span></button></div></div><footer class=post-footer><nav class=paginav><a class=next href=https://www.lvbibir.cn/en/posts/tech/windows-wsl-5-node/><span class=title>下一页 »</span><br><span>wsl | 安装配置 nodejs 环境</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.15/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo.lvbibir.cn/",el:"#tcomment",lang:"zh-CN",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><a href=https://gohugo.io/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/frame-hugo-blue.svg>
</a><a href=https://github.com/adityatelange/hugo-PaperMod target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/theme-papermod-lightgrey.svg>
</a><a href=https://cn.aliyun.com/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/图床-阿里云-orange.svg></a><br><span id=runtime_span></span>
<script type=text/javascript>function show_runtime(){window.setTimeout("show_runtime()",1e3),X=new Date("7/13/2021 1:00:00"),Y=new Date,T=Y.getTime()-X.getTime(),M=24*60*60*1e3,a=T/M,A=Math.floor(a),b=(a-A)*24,B=Math.floor(b),c=(b-B)*60,C=Math.floor((b-B)*60),D=Math.floor((c-C)*60),runtime_span.innerHTML="网站已运行"+A+"天"+B+"小时"+C+"分"+D+"秒"}show_runtime()</script>|
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container>总访客数: <span id=busuanzi_value_site_uv></span>
|
总访问量: <span id=busuanzi_value_site_pv></span></span><br><a href=https://beian.miit.gov.cn/ target=_blank style="border-bottom:1px solid">京ICP备2021023168号-1</a>&nbsp;
|
<span>Copyright
&copy;
2020-2024
<a href=https://www.lvbibir.cn/en/ style="border-bottom:1px solid">lvbibir's Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span>
</span></a><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="📄复制";function c(){t.innerText="👌🏻已复制!",setTimeout(()=>{t.innerText="📄复制"},2e3)}t.addEventListener("click",t=>{const n=document.createRange();n.selectNodeContents(e);const s=window.getSelection();s.removeAllRanges(),s.addRange(n);try{document.execCommand("copy"),c()}catch{}s.removeRange(n)});let l=e.className.replaceAll("language-",""),n=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div");o.innerText=l,n.setAttribute("class","mac-tool"),i.setAttribute("class","mac bb1"),a.setAttribute("class","mac bb2"),r.setAttribute("class","mac bb3"),o.setAttribute("class","language-type"),n.appendChild(i),n.appendChild(a),n.appendChild(r),n.appendChild(o),s.classList.contains("highlight")?(s.appendChild(t),s.appendChild(n)):s.parentNode.firstChild===s||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==="TABLE"?(e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t),s.appendChild(n)):(e.parentNode.appendChild(t),s.appendChild(n)))})</script><script src=https://code.jquery.com/jquery-1.12.4.min.js></script></body></html>