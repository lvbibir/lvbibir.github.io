---
title: "CVE-1999-0526" 
date: 2022-01-01
lastmod: 2024-01-27
tags:
  - linux
keywords:
  - linux
  - CVE
description: "介绍如何在 centos6 中修复 CVE-1999-0526 披露的漏洞" 
cover:
    image: "images/cover-default.webp" 
---

# 0 前言

本文参考以下链接:

- [Bug 1647621 - Xorg listening on port 6000 by default in 7.6](https://bugzilla.redhat.com/show_bug.cgi?id=1647621)

基于 `CVE-1999-0526` 漏洞的披露，对系统 X 服务的 6000 端口进行关闭

有三种方式：

- 修改系统/usr/bin/X 内容，增加 `nolisten` 参数
- 开启系统防火墙，关闭 6000 端口的对外访问
- 禁用桌面 (runlevel-5)，开机进入字符界面 (runlevel-3)

# 1 修改 /usr/bin/X 脚本

## 1.1 关闭

```bash
rm -f /usr/bin/X

vim /usr/bin/X

###################
添加如下内容
#!/bin/bash
exec /usr/bin/Xorg "$@" -nolisten tcp
exit 0
####################

chmod 777 /usr/bin/X

kill -9 进程号 # ps -elf |grep X 显示的进程号
```

![image-20220214130429656](/images/image-20220214-130429.png)

## 1.2 恢复

```bash
rm -f /usr/bin/X
ln -s /usr/bin/Xorg /usr/bin/X
kill -9 进程号 # pe -elf | grep Xorg 显示的进程号
```

![image-20220214130544760](/images/image-20220214-130544.png)

在测试过程中出现过杀死 X 服务进程后没有自启的情况，可尝试使用 init 3 && init 5 尝试重新启动 X 服务

# 2 修改防火墙方式

```bash
# 开启除6000端口以外的所有端口(6000端口无法访问)
systemctl start firewalld
firewall-cmd --permanent --zone=public --add-port=1-65535/udp
firewall-cmd --permanent --zone=public --add-port=1-5999/tcp
firewall-cmd --permanent --zone=public --add-port=6001-65535/tcp
firewall-cmd --reload
firewall-cmd --list-all

# 恢复（6000端口可以访问）
firewall-cmd --permanent --zone=public --add-port=6000/tcp
firewall-cmd --reload
firewall-cmd --list-all
```

以上
