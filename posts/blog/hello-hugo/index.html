<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>【置顶】Hello,hugo! | lvbibir's Blog</title><meta name=keywords content="hugo,papermod,docker,博客部署,博客优化"><meta name=description content="记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……"><meta name=author content="作者:&nbsp;lvbibir"><link rel=canonical href=https://www.lvbibir.cn/posts/blog/hello-hugo/><link crossorigin=anonymous href=/assets/css/stylesheet.fdd960116232b38cb838b1af465c00c0bbe01a6f7b72e582d221d3fcce0de8ed.css integrity="sha256-/dlgEWIys4y4OLGvRlwAwLvgGm97cuWC0iHT/M4N6O0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=16x16 href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=32x32 href=https://www.lvbibir.cn/img/avatar.gif><link rel=apple-touch-icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=mask-icon href=https://www.lvbibir.cn/img/avatar.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="【置顶】Hello,hugo!"><meta property="og:description" content="记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lvbibir.cn/posts/blog/hello-hugo/"><meta property="og:image" content="https://image.lvbibir.cn/blog/hugo-logo-wide.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-11T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://image.lvbibir.cn/blog/hugo-logo-wide.svg"><meta name=twitter:title content="【置顶】Hello,hugo!"><meta name=twitter:description content="记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"📚 文章","item":"https://www.lvbibir.cn/posts/"},{"@type":"ListItem","position":3,"name":"🏗️ 建站","item":"https://www.lvbibir.cn/posts/blog/"},{"@type":"ListItem","position":4,"name":"【置顶】Hello,hugo!","item":"https://www.lvbibir.cn/posts/blog/hello-hugo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"【置顶】Hello,hugo!","name":"【置顶】Hello,hugo!","description":"记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……","keywords":["hugo","papermod","docker","博客部署","博客优化"],"articleBody":"前言 研究 hugo 建站之初是打算采用 Github Pages 来发布静态博客\n优点 仅需一个github账号和简单配置即可将静态博客发布到 github pages 没有维护的时间成本，可以将精力更多的放到博客内容本身上去 无需备案 无需ssl证书 缺点 访问速度较慢 访问速度较慢 访问速度较慢 虽说访问速度较慢可以通过各家的cdn加速来解决，但由于刚开始建立 blog 选择的是 wordpress ，域名、服务器、备案、证书等都已经一应俱全，且之前的架构采用 docker，添加一台 nginx 来跑 hugo 的静态网站是很方便的\n一键将hugo博客部署到阿里云 虽说标题带有一键，但还是有一定的门槛的，需要对dokcer | docker-compose | nginx有一定了解\n配置文件下载 下载完将目录上传到自己的服务器，重命名为 blog (当然你可以用其他名字)\n确保服务器网络、ssl证书申请、服务器公网ip、服务器安全组权限(80/443)等基础配置已经一应俱全 确保服务器安装了 docker 和 docker-compose 修改blog/conf/nginx-hugo/nginx.conf和blog/conf/nginx-proxy/default.conf，需要修改的地方在文件中已经标注出来了 将你的ssl证书放到hugo-blog-dockercompose/ssl/目录下 在blog目录下执行docker-compose up -d即可启动容器 将hugo生成的public目录上传到服务器blog/data/hugo/中，参考下文 在域名提供商处为你的域名添加A记录，指向服务器的公网ip地址(主域名和twikoo域名都要配置) 都配置完后 参考下文 配置twikoo 至此已经配置完成，应该可以通过域名访问hugo站点了，后续更新内容只需要hugo生成静态文件上传到服务即可\n所有的配置、应用数据、日志都保存在blog目录下，你可以在不同的服务器上快速迁移hugo环境，无需担心后续想要迁移新服务器时遇到的各种问题\nworkflow 编辑文章 采用 typora + picgo + 七牛云图床流程，参考我的另一篇文章：typora+picgo+七牛云上传图片\n生成静态文件 hugo -F --cleanDestinationDir 后面两个参数表示会先删除之前生成的 public 目录，保证每次生成的 public 都是新的\n上传静态文件 将mobaxterm的命令添加到用户环境变量中，以实现git bash | vscode | windows terminal中运行一些 mobaxterm 本地终端附带的命令，也就无需再专门打开一次 mobaxterm 去上传文件了\nrsync -avuz --progress --delete public/ root@lvbibir.cn:/root/blog/data/hugo/ 归档备份 沿用搭建Github pages时使用的 github仓库 ，来作为我博客的归档管理，也可以方便家里电脑和工作电脑之间的数据同步\ntwikoo评论 所有部署方式：https://twikoo.js.org/quick-start.html\nvercel+mongodb+github部署方式参考：https://www.sulvblog.cn/posts/blog/hugo_twikoo/\n记录一下账号关系：mongodb使用google账号登录，vercel使用github登录\n私有部署(docker) 如果是使用 一键将hugo博客部署到阿里云 中的步骤部署了twikoo，这步直接忽略，配置前端代码即可\ndocker run --name twikoo -e TWIKOO_THROTTLE=1000 -p 8080:8080 -v ${PWD}/data:/app/data -d imaegoo/twikoo 部署完成后看到如下结果即成功\n[root@lvbibir ~]# curl http://localhost:8080 {\"code\":100,\"message\":\"Twikoo 云函数运行正常，请参考 https://twikoo.js.org/quick-start.html#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2 完成前端的配置\",\"version\":\"1.6.7\"} 后续最好套上反向代理，加上域名和证书\n前端代码 创建或者修改 layouts\\partials\\comments.html\n\u003cdiv\u003e \u003cdiv class=\"pagination__title\"\u003e \u003cspan class=\"pagination__title-h\" style=\"font-size: 20px;\"\u003e💬评论\u003c/span\u003e \u003chr /\u003e \u003c/div\u003e \u003cdiv id=\"tcomment\"\u003e\u003c/div\u003e \u003cscript src=\"https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js\"\u003e\u003c/script\u003e \u003cscript\u003e twikoo.init({ envId: \"\", //填自己的，例如：https://example.com el: \"#tcomment\", lang: 'zh-CN', path: window.TWIKOO_MAGIC_PATH||window.location.pathname, }); \u003c/script\u003e \u003c/div\u003e 调用上述twikoo代码的位置：layouts/_default/single.html\n\u003carticle class=\"post-single\"\u003e // 其他代码...... {{- if (.Param \"comments\") }} {{- partial \"comments.html\" . }} {{- end }} \u003c/article\u003e 在站点配置文件config中加上版本号\nparams: twikoo: version: 1.6.7 更新 拉取新版本docker pull imaegoo/twikoo 停止旧版本容器docker stop twikoo 删除旧版本容器docker rm twikoo 部署新版本容器docker-compose up -d 在hugo配置文件 config.yml 中修改 twikoo版本 修改数据 直接修改blog/data/twikoo/目录下的文件后重启容器，❗慎重修改\n修改smms图床的api地址 已于 1.6.12 新版本修复，https://github.com/imaegoo/twikoo/releases/tag/1.6.12\n由于sm.ms域名国内无法访问，twikoo官方还没有出具体的修改方式，自己修改容器配置文件进行修改\n# 复制配置文件 [root@lvbibir blog]# docker cp twikoo:/app/node_modules/twikoo-func/utils/image.js /root/blog/conf/twikoo/ # 修改配置文件，原来的配置是 https://sm.ms/api.v2/upload [root@lvbibir blog]# grep smms conf/twikoo/image.js } else if (config.IMAGE_CDN === 'smms') { const uploadResult = await axios.post('https://smms.app/api/v2/upload', formData, { # 将配置文件映射进容器内，重启容器即可 [root@lvbibir blog]# grep twikoo docker-compose.yml twikoo: image: imaegoo/twikoo container_name: twikoo - $PWD/data/twikoo:/app/data - $PWD/conf/twikoo/image.js:/app/node_modules/twikoo-func/utils/image.js 自定义字体 可以使用一些在线的字体，可能会比较慢，推荐下载想要的字体放到自己的服务器或者cdn上\n修改assets\\css\\extended\\fonts.css，添加@font-face\n@font-face { font-family: \"LXGWWenKaiLite-Bold\"; src: url(\"https://your.domain.com/fonts/test.woff2\") format(\"woff2\"); font-display: swap; } 修改assets\\css\\extended\\blank.css，推荐将英文字体放在前面，可以实现英文和中文使用不同字体。\n.post-content { font-family: Consolas, \"LXGWWenKaiLite-Bold\"; //修改 } body { font-family: Consolas, \"LXGWWenKaiLite-Bold\"; //修改 } 修改链接颜色 在 hugo+papermod 默认配置下，链接颜色是黑色字体带下划线的组合，个人非常喜欢typora-vue的渲染风格hugo官方文档给出了通过render hooks覆盖默认的markdown渲染link的方式\n新建layouts/_default/_markup/render-link.html文件，内容如下。在官方给出的示例中添加了 style=\"color:#42b983，颜色可以自行修改\n\u003ca href=\"{{ .Destination | safeURL }}\"{{ with .Title}} title=\"{{ . }}\"{{ end }}{{ if strings.HasPrefix .Destination \"http\" }} target=\"_blank\" rel=\"noopener\" style=\"color:#42b983\";{{ end }}\u003e{{ .Text | safeHTML }}\u003c/a\u003e Artitalk说说 官方文档\n需要注意的是如果使用的是国际版的LeadCloud，需要绑定自定义域名后才能正常访问\n记录一下账号关系：LeadCloud使用163邮箱登录\nleancloud配置 前往 LeanCloud 国际版，注册账号。 注册完成之后根据 LeanCloud 的提示绑定手机号和邮箱。 绑定完成之后点击创建应用，应用名称随意，接着在结构化数据中创建 class，命名为 shuoshuo。 在你新建的应用中找到结构化数据下的用户。点击添加用户，输入想用的用户名及密码。 回到结构化数据中，点击 class 下的 shuoshuo。找到权限，在 Class 访问权限中将 add_fields 以及 create 权限设置为指定用户，输入你刚才输入的用户名会自动匹配。为了安全起见，将 delete 和 update 也设置为跟它们一样的权限。 然后新建一个名为atComment的class，权限什么的使用默认的即可。 点击 class 下的 _User 添加列，列名称为 img，默认值填上你这个账号想要用的发布说说的头像url，这一项不进行配置，说说头像会显示为默认头像 —— Artitalk 的 logo。 在最菜单栏中找到设置-\u003e 应用 keys，记下来 AppID 和 AppKey ，一会会用。 最后将 _User 中的权限全部调为指定用户，或者数据创建者，为了保证不被篡改用户数据以达到强制发布说说。 在设置-\u003e域名绑定中绑定自定义域名 ❗ 关于设置权限的这几步\n这几步一定要设置好，才可以保证不被 “闲人” 破解发布说说的验证\nhugo配置 新增 content/talk.md 页面，内容如下，注意修改标注的内容，front-matter 的内容自行修改\n--- title: \"💬 说说\" date: 2021-08-31 hidemeta: true description: \"胡言乱语\" comments: true reward: false showToc: false TocOpen: false showbreadcrumbs: false --- \u003cbody\u003e \u003cscript type=\"text/javascript\" src=\"https://unpkg.com/artitalk\"\u003e\u003c/script\u003e \u003cdiv id=\"artitalk_main\"\u003e\u003c/div\u003e \u003cscript\u003e new Artitalk({ appId: '**********', // Your LeanCloud appId appKey: '************', // Your LeanCloud appKey serverURL: '*********' // 绑定的自定义域名 }) \u003c/script\u003e \u003c/body\u003e 这个时候已经可以直接访问了，https://your.domain.com/talk\n输入 leancloud配置 步骤中的第4步配置的用户名密码登录后就可以发布说说了\nshortcode ppt、bilibili、youtube、豆瓣阅读和电影卡片\nhttps://www.sulvblog.cn/posts/blog/shortcodes/\nmermaid\nhttps://www.sulvblog.cn/posts/blog/hugo_mermaid/\n图片画廊\nhttps://github.com/liwenyip/hugo-easy-gallery/\nhttps://www.liwen.id.au/heg/\n自定义footer 自定义页脚内容\n添加完下面的页脚内容后要修改 assets\\css\\extended\\blank.css 中的 --footer-height 的大小，具体数字需要考虑到行数和字体大小\n自定义徽标 徽标功能源自：https://shields.io/ 考虑到访问速度，可以在生成完徽标后放到自己的cdn上\n在 layouts\\partials\\footer.html 中的 添加如下\n\u003ca href=\"https://gohugo.io/\" target=\"_blank\"\u003e \u003cimg src=\"https://img.shields.io/static/v1?\u0026style=plastic\u0026color=308fb5\u0026label=Power by\u0026message=hugo\u0026logo=hugo\" style=\"display: unset;\"\u003e \u003c/a\u003e 网站运行时间 在 layouts\\partials\\footer.html 中的 添加如下\n起始时间自行修改\n\u003cspan id=\"runtime_span\"\u003e\u003c/span\u003e \u003cscript type=\"text/javascript\"\u003efunction show_runtime(){window.setTimeout(\"show_runtime()\",1000);X=new Date(\"7/13/2021 1:00:00\");Y=new Date();T=(Y.getTime()-X.getTime());M=24*60*60*1000;a=T/M;A=Math.floor(a);b=(a-A)*24;B=Math.floor(b);c=(b-B)*60;C=Math.floor((b-B)*60);D=Math.floor((c-C)*60);runtime_span.innerHTML=\"网站已运行\"+A+\"天\"+B+\"小时\"+C+\"分\"+D+\"秒\"}show_runtime();\u003c/script\u003e 访问人数统计 统计功能源自：http://busuanzi.ibruce.info/\n在 layouts\\partials\\footer.html 中的 添加如下\n\u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"\u003e\u003c/script\u003e \u003cspan id=\"busuanzi_container\"\u003e \u003clink rel=\"stylesheet\" href=\"//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css\"\u003e 总访客数: \u003ci class=\"fa fa-user\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003e | 总访问量: \u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003e | 本页访问量: \u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_page_pv\"\u003e\u003c/span\u003e \u003c/span\u003e 其他修改 其他 css样式修改 基本都是通过 f12控制台 一点点摸索改的，不太规范且比较琐碎就不单独记录了，其实我根本已经忘记还改了哪些东西\n","wordCount":"3693","inLanguage":"en","image":"https://image.lvbibir.cn/blog/hugo-logo-wide.svg","datePublished":"2022-07-06T00:00:00Z","dateModified":"2022-09-11T00:00:00Z","author":{"@type":"Person","name":"lvbibir"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lvbibir.cn/posts/blog/hello-hugo/"},"publisher":{"@type":"Organization","name":"lvbibir's Blog","logo":{"@type":"ImageObject","url":"https://www.lvbibir.cn/img/avatar.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.lvbibir.cn accesskey=h title="lvbibir's Blog (Alt + H)"><img src=https://www.lvbibir.cn/img/avatar.gif alt aria-label=logo height=35>lvbibir's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li class=menu-item><a href=https://www.lvbibir.cn/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/posts title="📚 文章"><span>📚 文章</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/archives title="📈 归档"><span>📈 归档</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/talk title="💬 说说"><span>💬 说说</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/links title="🤝 友链"><span>🤝 友链</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://www.lvbibir.cn>主页</a>&nbsp;»&nbsp;<a href=https://www.lvbibir.cn/posts/>📚 文章</a>&nbsp;»&nbsp;<a href=https://www.lvbibir.cn/posts/blog/>🏗️ 建站</a></div><h1 class=post-title>【置顶】Hello,hugo!</h1><div class=post-description>记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……</div><div class=post-meta>创建:&nbsp;<span title='2022-07-06 00:00:00 +0000 UTC'>2022-07-06</span>&nbsp;|&nbsp;更新:&nbsp;2022-09-11&nbsp;|&nbsp;字数:&nbsp;3693字&nbsp;|&nbsp;作者:&nbsp;lvbibir
|&nbsp;标签:&nbsp;<ul class=post-tags-meta><a href=https://www.lvbibir.cn/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/>博客搭建</a>
<a href=https://www.lvbibir.cn/tags/docker/>、docker</a></ul><span id=busuanzi_container_page_pv>&nbsp;|&nbsp;访问:&nbsp;<span id=busuanzi_value_page_pv></span></span></div></header><figure class=entry-cover1><img loading=lazy src=https://image.lvbibir.cn/blog/hugo-logo-wide.svg alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>文章目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e4%b8%80%e9%94%ae%e5%b0%86hugo%e5%8d%9a%e5%ae%a2%e9%83%a8%e7%bd%b2%e5%88%b0%e9%98%bf%e9%87%8c%e4%ba%91 aria-label=一键将hugo博客部署到阿里云>一键将hugo博客部署到阿里云</a></li><li><a href=#workflow aria-label=workflow>workflow</a><ul><li><a href=#%e7%bc%96%e8%be%91%e6%96%87%e7%ab%a0 aria-label=编辑文章>编辑文章</a></li><li><a href=#%e7%94%9f%e6%88%90%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6 aria-label=生成静态文件>生成静态文件</a></li><li><a href=#%e4%b8%8a%e4%bc%a0%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6 aria-label=上传静态文件>上传静态文件</a></li><li><a href=#%e5%bd%92%e6%a1%a3%e5%a4%87%e4%bb%bd aria-label=归档备份>归档备份</a></li></ul></li><li><a href=#twikoo%e8%af%84%e8%ae%ba aria-label=twikoo评论>twikoo评论</a><ul><li><a href=#%e7%a7%81%e6%9c%89%e9%83%a8%e7%bd%b2docker aria-label=私有部署(docker)>私有部署(docker)</a></li><li><a href=#%e5%89%8d%e7%ab%af%e4%bb%a3%e7%a0%81 aria-label=前端代码>前端代码</a></li><li><a href=#%e6%9b%b4%e6%96%b0 aria-label=更新>更新</a></li><li><a href=#%e4%bf%ae%e6%94%b9%e6%95%b0%e6%8d%ae aria-label=修改数据>修改数据</a></li><li><a href=#%e4%bf%ae%e6%94%b9smms%e5%9b%be%e5%ba%8a%e7%9a%84api%e5%9c%b0%e5%9d%80 aria-label=修改smms图床的api地址>修改smms图床的api地址</a></li></ul></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ad%97%e4%bd%93 aria-label=自定义字体>自定义字体</a></li><li><a href=#%e4%bf%ae%e6%94%b9%e9%93%be%e6%8e%a5%e9%a2%9c%e8%89%b2 aria-label=修改链接颜色>修改链接颜色</a></li><li><a href=#artitalk%e8%af%b4%e8%af%b4 aria-label=Artitalk说说>Artitalk说说</a><ul><li><a href=#leancloud%e9%85%8d%e7%bd%ae aria-label=leancloud配置>leancloud配置</a></li><li><a href=#hugo%e9%85%8d%e7%bd%ae aria-label=hugo配置>hugo配置</a></li></ul></li><li><a href=#shortcode aria-label=shortcode>shortcode</a></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89footer aria-label=自定义footer>自定义footer</a><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%be%bd%e6%a0%87 aria-label=自定义徽标>自定义徽标</a></li><li><a href=#%e7%bd%91%e7%ab%99%e8%bf%90%e8%a1%8c%e6%97%b6%e9%97%b4 aria-label=网站运行时间>网站运行时间</a></li><li><a href=#%e8%ae%bf%e9%97%ae%e4%ba%ba%e6%95%b0%e7%bb%9f%e8%ae%a1 aria-label=访问人数统计>访问人数统计</a></li></ul></li><li><a href=#%e5%85%b6%e4%bb%96%e4%bf%ae%e6%94%b9 aria-label=其他修改>其他修改</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h1><p>研究 hugo 建站之初是打算采用 <code>Github Pages</code> 来发布静态博客</p><ul><li>优点</li><li><ul><li>仅需一个github账号和简单配置即可将静态博客发布到 github pages</li><li>没有维护的时间成本，可以将精力更多的放到博客内容本身上去</li><li>无需备案</li><li>无需ssl证书</li></ul></li><li>缺点</li><li><ul><li>访问速度较慢</li><li>访问速度较慢</li><li>访问速度较慢</li></ul></li></ul><p>虽说访问速度较慢可以通过各家的cdn加速来解决，但由于刚开始建立 blog 选择的是 wordpress ，域名、服务器、备案、证书等都已经一应俱全，且之前的架构采用 docker，添加一台 nginx 来跑 hugo 的静态网站是很方便的</p><h1 id=一键将hugo博客部署到阿里云>一键将hugo博客部署到阿里云<a hidden class=anchor aria-hidden=true href=#一键将hugo博客部署到阿里云>#</a></h1><blockquote><p>虽说标题带有一键，但还是有一定的门槛的，需要对<code>dokcer | docker-compose | nginx</code>有一定了解</p></blockquote><p><a href=https://image.lvbibir.cn/files/blog-docker-compose.zip target=_blank rel=noopener style=color:#42b983 ;>配置文件下载</a> 下载完将目录上传到自己的服务器，重命名为 <code>blog</code> (当然你可以用其他名字)</p><ol><li>确保服务器网络、ssl证书申请、服务器公网ip、服务器安全组权限(80/443)等基础配置已经一应俱全</li><li>确保服务器安装了 docker 和 docker-compose</li><li>修改<code>blog/conf/nginx-hugo/nginx.conf</code>和<code>blog/conf/nginx-proxy/default.conf</code>，需要修改的地方在文件中已经标注出来了</li><li>将你的ssl证书放到<code>hugo-blog-dockercompose/ssl/</code>目录下</li><li>在<code>blog</code>目录下执行<code>docker-compose up -d</code>即可启动容器</li><li>将hugo生成的<code>public</code>目录上传到服务器<code>blog/data/hugo/</code>中，<a href=#workflow>参考下文</a></li><li>在域名提供商处为你的域名添加A记录，指向服务器的公网ip地址(主域名和twikoo域名都要配置)
<img loading=lazy src=https://image.lvbibir.cn/blog/image-20230313142456952.png alt=image-20230313142456952></li><li>都配置完后 <a href=#twikoo%e8%af%84%e8%ae%ba>参考下文</a> 配置twikoo</li></ol><p>至此已经配置完成，应该可以通过域名访问hugo站点了，后续更新内容只需要hugo生成静态文件上传到服务即可</p><p>所有的配置、应用数据、日志都保存在blog目录下，你可以在不同的服务器上快速迁移hugo环境，无需担心后续想要迁移新服务器时遇到的各种问题</p><h1 id=workflow>workflow<a hidden class=anchor aria-hidden=true href=#workflow>#</a></h1><h2 id=编辑文章>编辑文章<a hidden class=anchor aria-hidden=true href=#编辑文章>#</a></h2><p>采用 typora + picgo + 七牛云图床流程，参考我的另一篇文章：<a href=https://www.lvbibir.cn/posts/blog/typora-picgo-qiniu-upload-image/ target=_blank rel=noopener style=color:#42b983 ;>typora+picgo+七牛云上传图片</a></p><h2 id=生成静态文件>生成静态文件<a hidden class=anchor aria-hidden=true href=#生成静态文件>#</a></h2><pre tabindex=0><code>hugo -F --cleanDestinationDir
</code></pre><p>后面两个参数表示会先删除之前生成的 public 目录，保证每次生成的 public 都是新的</p><h2 id=上传静态文件>上传静态文件<a hidden class=anchor aria-hidden=true href=#上传静态文件>#</a></h2><p>将<code>mobaxterm</code>的命令添加到用户环境变量中，以实现<code>git bash | vscode | windows terminal</code>中运行一些 mobaxterm 本地终端附带的命令，也就无需再专门打开一次 mobaxterm 去上传文件了</p><pre tabindex=0><code>rsync -avuz --progress --delete public/ root@lvbibir.cn:/root/blog/data/hugo/
</code></pre><h2 id=归档备份>归档备份<a hidden class=anchor aria-hidden=true href=#归档备份>#</a></h2><p>沿用搭建<code>Github pages</code>时使用的 <a href=https://github.com/lvbibir/lvbibir.github.io target=_blank rel=noopener style=color:#42b983 ;>github仓库</a> ，来作为我博客的归档管理，也可以方便家里电脑和工作电脑之间的数据同步</p><h1 id=twikoo评论>twikoo评论<a hidden class=anchor aria-hidden=true href=#twikoo评论>#</a></h1><p>所有部署方式：https://twikoo.js.org/quick-start.html</p><p>vercel+mongodb+github部署方式参考：https://www.sulvblog.cn/posts/blog/hugo_twikoo/</p><p>记录一下账号关系：mongodb使用google账号登录，vercel使用github登录</p><h2 id=私有部署docker>私有部署(docker)<a hidden class=anchor aria-hidden=true href=#私有部署docker>#</a></h2><blockquote><p>如果是使用 <a href=#%e4%b8%80%e9%94%ae%e5%b0%86hugo%e5%8d%9a%e5%ae%a2%e9%83%a8%e7%bd%b2%e5%88%b0%e9%98%bf%e9%87%8c%e4%ba%91>一键将hugo博客部署到阿里云</a> 中的步骤部署了twikoo，这步直接忽略，配置前端代码即可</p></blockquote><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --name twikoo -e <span style=color:#ef6155>TWIKOO_THROTTLE</span><span style=color:#5bc4bf>=</span><span style=color:#f99b15>1000</span> -p 8080:8080 -v <span style=color:#f99b15>${</span><span style=color:#ef6155>PWD</span><span style=color:#f99b15>}</span>/data:/app/data -d imaegoo/twikoo
</span></span></code></pre></div><p>部署完成后看到如下结果即成功</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir ~<span style=color:#5bc4bf>]</span><span style=color:#776e71># curl http://localhost:8080</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>{</span><span style=color:#48b685>&#34;code&#34;</span>:100,<span style=color:#48b685>&#34;message&#34;</span>:<span style=color:#48b685>&#34;Twikoo 云函数运行正常，请参考 https://twikoo.js.org/quick-start.html#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2 完成前端的配置&#34;</span>,<span style=color:#48b685>&#34;version&#34;</span>:<span style=color:#48b685>&#34;1.6.7&#34;</span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div><p>后续最好套上反向代理，加上域名和证书</p><h2 id=前端代码>前端代码<a hidden class=anchor aria-hidden=true href=#前端代码>#</a></h2><p>创建或者修改 <code>layouts\partials\comments.html</code></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#776e71>&lt;!-- Twikoo --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>div</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;pagination__title&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;pagination__title-h&#34;</span> <span style=color:#06b6ef>style</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;font-size: 20px;&#34;</span>&gt;💬评论&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#5bc4bf>hr</span> /&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>div</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;tcomment&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#06b6ef>twikoo</span>.<span style=color:#06b6ef>init</span>({
</span></span><span style=display:flex><span>            <span style=color:#06b6ef>envId</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#34;&#34;</span>, <span style=color:#776e71>//填自己的，例如：https://example.com
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>            <span style=color:#06b6ef>el</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#34;#tcomment&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#06b6ef>lang</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;zh-CN&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#06b6ef>path</span><span style=color:#5bc4bf>:</span> window.<span style=color:#06b6ef>TWIKOO_MAGIC_PATH</span><span style=color:#5bc4bf>||</span>window.<span style=color:#06b6ef>location</span>.<span style=color:#06b6ef>pathname</span>,
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    &lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span></code></pre></div><p>调用上述twikoo代码的位置：<code>layouts/_default/single.html</code></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>article</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;post-single&#34;</span>&gt;
</span></span><span style=display:flex><span>  // 其他代码......
</span></span><span style=display:flex><span>  {{- if (.Param &#34;comments&#34;) }}
</span></span><span style=display:flex><span>    {{- partial &#34;comments.html&#34; . }}
</span></span><span style=display:flex><span>  {{- end }}
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>article</span>&gt;
</span></span></code></pre></div><p>在站点配置文件config中加上版本号</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#5bc4bf>params</span>:
</span></span><span style=display:flex><span>	<span style=color:#5bc4bf>twikoo</span>:
</span></span><span style=display:flex><span>      <span style=color:#5bc4bf>version</span>: <span style=color:#f99b15>1.6.7</span>
</span></span></code></pre></div><h2 id=更新>更新<a hidden class=anchor aria-hidden=true href=#更新>#</a></h2><ol><li>拉取新版本<code>docker pull imaegoo/twikoo</code></li><li>停止旧版本容器<code>docker stop twikoo</code></li><li>删除旧版本容器<code>docker rm twikoo</code></li><li>部署新版本容器<code>docker-compose up -d</code></li><li>在hugo配置文件 config.yml 中修改 twikoo版本</li></ol><h2 id=修改数据>修改数据<a hidden class=anchor aria-hidden=true href=#修改数据>#</a></h2><p>直接修改<code>blog/data/twikoo/</code>目录下的文件后重启容器，❗慎重修改</p><h2 id=修改smms图床的api地址>修改smms图床的api地址<a hidden class=anchor aria-hidden=true href=#修改smms图床的api地址>#</a></h2><blockquote><p>已于 1.6.12 新版本修复，https://github.com/imaegoo/twikoo/releases/tag/1.6.12</p></blockquote><p>由于<code>sm.ms</code>域名国内无法访问，<del>twikoo官方还没有出具体的修改方式</del>，自己修改容器配置文件进行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#776e71># 复制配置文件</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir blog<span style=color:#5bc4bf>]</span><span style=color:#776e71># docker cp twikoo:/app/node_modules/twikoo-func/utils/image.js /root/blog/conf/twikoo/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#776e71># 修改配置文件，原来的配置是 https://sm.ms/api.v2/upload</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir blog<span style=color:#5bc4bf>]</span><span style=color:#776e71># grep smms conf/twikoo/image.js</span>
</span></span><span style=display:flex><span>      <span style=color:#5bc4bf>}</span> <span style=color:#815ba4>else</span> <span style=color:#815ba4>if</span> <span style=color:#5bc4bf>(</span>config.IMAGE_CDN <span style=color:#5bc4bf>===</span> <span style=color:#48b685>&#39;smms&#39;</span><span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    const <span style=color:#ef6155>uploadResult</span> <span style=color:#5bc4bf>=</span> await axios.post<span style=color:#5bc4bf>(</span><span style=color:#48b685>&#39;https://smms.app/api/v2/upload&#39;</span>, formData, <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#776e71># 将配置文件映射进容器内，重启容器即可</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span>root@lvbibir blog<span style=color:#5bc4bf>]</span><span style=color:#776e71># grep twikoo docker-compose.yml</span>
</span></span><span style=display:flex><span>  twikoo:
</span></span><span style=display:flex><span>    image: imaegoo/twikoo
</span></span><span style=display:flex><span>    container_name: twikoo
</span></span><span style=display:flex><span>      - <span style=color:#ef6155>$PWD</span>/data/twikoo:/app/data
</span></span><span style=display:flex><span>      - <span style=color:#ef6155>$PWD</span>/conf/twikoo/image.js:/app/node_modules/twikoo-func/utils/image.js
</span></span></code></pre></div><h1 id=自定义字体>自定义字体<a hidden class=anchor aria-hidden=true href=#自定义字体>#</a></h1><p>可以使用一些在线的字体，可能会比较慢，推荐下载想要的字体放到自己的服务器或者cdn上</p><p>修改<code>assets\css\extended\fonts.css</code>，添加<code>@font-face</code></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>@<span style=color:#815ba4>font-face</span> {
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>font-family</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#34;LXGWWenKaiLite-Bold&#34;</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>src</span><span style=color:#5bc4bf>:</span> <span style=color:#5bc4bf>url</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;https://your.domain.com/fonts/test.woff2&#34;</span><span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>format</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;woff2&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>font-display</span><span style=color:#5bc4bf>:</span> <span style=color:#5bc4bf>swap</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>修改<code>assets\css\extended\blank.css</code>，推荐将英文字体放在前面，可以实现英文和中文使用不同字体。</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>.<span style=color:#fec418>post-content</span> {
</span></span><span style=display:flex><span>    <span style=color:#815ba4>font-family</span>: Consolas, <span style=color:#48b685>&#34;LXGWWenKaiLite-Bold&#34;</span>; <span style=color:#ef6155>//修改</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>body</span> {
</span></span><span style=display:flex><span>    <span style=color:#815ba4>font-family</span>: Consolas, <span style=color:#48b685>&#34;LXGWWenKaiLite-Bold&#34;</span>; <span style=color:#ef6155>//修改</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=修改链接颜色>修改链接颜色<a hidden class=anchor aria-hidden=true href=#修改链接颜色>#</a></h1><p>在 hugo+papermod 默认配置下，链接颜色是黑色字体带下划线的组合，个人非常喜欢<a href=https://github.com/blinkfox/typora-vue-theme target=_blank rel=noopener style=color:#42b983 ;>typora-vue</a>的渲染风格<a href=https://gohugo.io/templates/render-hooks/#link-with-title-markdown-example target=_blank rel=noopener style=color:#42b983 ;>hugo官方文档</a>给出了通过<code>render hooks</code>覆盖默认的markdown渲染link的方式</p><p>新建<code>layouts/_default/_markup/render-link.html</code>文件，内容如下。在官方给出的示例中添加了 <code>style="color:#42b983</code>，颜色可以自行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>a</span> <span style=color:#06b6ef>href</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;{{ .Destination | safeURL }}&#34;</span><span style=color:#ef6155>{{</span> <span style=color:#06b6ef>with</span> <span style=color:#ef6155>.</span><span style=color:#06b6ef>Title</span><span style=color:#ef6155>}}</span> <span style=color:#06b6ef>title</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;{{ . }}&#34;</span><span style=color:#ef6155>{{</span> <span style=color:#06b6ef>end</span> <span style=color:#ef6155>}}{{</span> <span style=color:#06b6ef>if</span> <span style=color:#06b6ef>strings</span><span style=color:#ef6155>.</span><span style=color:#06b6ef>HasPrefix</span> <span style=color:#ef6155>.</span><span style=color:#06b6ef>Destination</span> <span style=color:#ef6155>&#34;</span><span style=color:#06b6ef>http</span><span style=color:#ef6155>&#34;</span> <span style=color:#ef6155>}}</span> <span style=color:#06b6ef>target</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;_blank&#34;</span> <span style=color:#06b6ef>rel</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;noopener&#34;</span> <span style=color:#06b6ef>style</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;color:#42b983&#34;</span><span style=color:#ef6155>;{{</span> <span style=color:#06b6ef>end</span> <span style=color:#ef6155>}}</span>&gt;{{ .Text | safeHTML }}&lt;/<span style=color:#5bc4bf>a</span>&gt;
</span></span></code></pre></div><h1 id=artitalk说说>Artitalk说说<a hidden class=anchor aria-hidden=true href=#artitalk说说>#</a></h1><p><a href=https://artitalk.js.org/doc.html target=_blank rel=noopener style=color:#42b983 ;>官方文档</a></p><p>需要注意的是如果使用的是国际版的LeadCloud，需要绑定自定义域名后才能正常访问</p><p>记录一下账号关系：LeadCloud使用163邮箱登录</p><h2 id=leancloud配置>leancloud配置<a hidden class=anchor aria-hidden=true href=#leancloud配置>#</a></h2><ol><li>前往 <a href=https://leancloud.app/ target=_blank rel=noopener style=color:#42b983 ;>LeanCloud 国际版</a>，注册账号。</li><li>注册完成之后根据 LeanCloud 的提示绑定手机号和邮箱。</li><li>绑定完成之后点击<code>创建应用</code>，应用名称随意，接着在<code>结构化数据</code>中创建 <code>class</code>，命名为 <code>shuoshuo</code>。</li><li>在你新建的应用中找到<code>结构化数据</code>下的<code>用户</code>。点击<code>添加用户</code>，输入想用的用户名及密码。</li><li>回到<code>结构化数据</code>中，点击 <code>class</code> 下的 <code>shuoshuo</code>。找到权限，在 <code>Class 访问权限</code>中将 <code>add_fields</code> 以及 <code>create</code> 权限设置为指定用户，输入你刚才输入的用户名会自动匹配。为了安全起见，将 <code>delete</code> 和 <code>update</code> 也设置为跟它们一样的权限。</li><li>然后新建一个名为<code>atComment</code>的class，权限什么的使用默认的即可。</li><li>点击 <code>class</code> 下的 <code>_User</code> 添加列，列名称为 <code>img</code>，默认值填上你这个账号想要用的发布说说的头像url，这一项不进行配置，说说头像会显示为默认头像 —— Artitalk 的 logo。</li><li>在最菜单栏中找到设置-> 应用 keys，记下来 <code>AppID</code> 和 <code>AppKey</code> ，一会会用。</li><li>最后将 <code>_User</code> 中的权限全部调为指定用户，或者数据创建者，为了保证不被篡改用户数据以达到强制发布说说。</li><li>在设置->域名绑定中绑定自定义域名</li></ol><blockquote><p>❗ 关于设置权限的这几步</p><p>这几步一定要设置好，才可以保证不被 “闲人” 破解发布说说的验证</p></blockquote><h2 id=hugo配置>hugo配置<a hidden class=anchor aria-hidden=true href=#hugo配置>#</a></h2><p>新增 <code>content/talk.md</code> 页面，内容如下，注意修改标注的内容，front-matter 的内容自行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;💬 说说&#34;
</span></span><span style=display:flex><span>date: 2021-08-31
</span></span><span style=display:flex><span>hidemeta: true
</span></span><span style=display:flex><span>description: &#34;胡言乱语&#34;
</span></span><span style=display:flex><span>comments: true
</span></span><span style=display:flex><span>reward: false
</span></span><span style=display:flex><span>showToc: false 
</span></span><span style=display:flex><span>TocOpen: false 
</span></span><span style=display:flex><span>showbreadcrumbs: false
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>body</span>&gt;
</span></span><span style=display:flex><span><span style=color:#776e71>&lt;!-- 引用 artitalk --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>type</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;text/javascript&#34;</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://unpkg.com/artitalk&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#776e71>&lt;!-- 存放说说的容器 --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>div</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;artitalk_main&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#815ba4>new</span> <span style=color:#06b6ef>Artitalk</span>({
</span></span><span style=display:flex><span>    <span style=color:#06b6ef>appId</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;**********&#39;</span>, <span style=color:#776e71>// Your LeanCloud appId
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>    <span style=color:#06b6ef>appKey</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;************&#39;</span>, <span style=color:#776e71>// Your LeanCloud appKey
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>    <span style=color:#06b6ef>serverURL</span><span style=color:#5bc4bf>:</span> <span style=color:#48b685>&#39;*********&#39;</span> <span style=color:#776e71>// 绑定的自定义域名
</span></span></span><span style=display:flex><span><span style=color:#776e71></span>})
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>body</span>&gt;
</span></span></code></pre></div><p>这个时候已经可以直接访问了，<code>https://your.domain.com/talk</code></p><p>输入 leancloud配置 步骤中的第4步配置的用户名密码登录后就可以发布说说了</p><h1 id=shortcode>shortcode<a hidden class=anchor aria-hidden=true href=#shortcode>#</a></h1><p>ppt、bilibili、youtube、豆瓣阅读和电影卡片</p><p><a href=https://www.sulvblog.cn/posts/blog/shortcodes/ target=_blank rel=noopener style=color:#42b983 ;>https://www.sulvblog.cn/posts/blog/shortcodes/</a></p><p>mermaid</p><p><a href=https://www.sulvblog.cn/posts/blog/hugo_mermaid/ target=_blank rel=noopener style=color:#42b983 ;>https://www.sulvblog.cn/posts/blog/hugo_mermaid/</a></p><p>图片画廊</p><p><a href=https://github.com/liwenyip/hugo-easy-gallery/ target=_blank rel=noopener style=color:#42b983 ;>https://github.com/liwenyip/hugo-easy-gallery/</a></p><p><a href=https://www.liwen.id.au/heg/ target=_blank rel=noopener style=color:#42b983 ;>https://www.liwen.id.au/heg/</a></p><h1 id=自定义footer>自定义footer<a hidden class=anchor aria-hidden=true href=#自定义footer>#</a></h1><p>自定义页脚内容</p><p><img loading=lazy src=https://image.lvbibir.cn/blog/image-20220911150229930.png alt=image-20220911150229930></p><blockquote><p>添加完下面的页脚内容后要修改 <code>assets\css\extended\blank.css</code> 中的 <code>--footer-height</code> 的大小，具体数字需要考虑到行数和字体大小</p></blockquote><h2 id=自定义徽标>自定义徽标<a hidden class=anchor aria-hidden=true href=#自定义徽标>#</a></h2><blockquote><p>徽标功能源自：https://shields.io/
考虑到访问速度，可以在生成完徽标后放到自己的cdn上</p></blockquote><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>a</span> <span style=color:#06b6ef>href</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://gohugo.io/&#34;</span> <span style=color:#06b6ef>target</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;_blank&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>img</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;https://img.shields.io/static/v1?&amp;style=plastic&amp;color=308fb5&amp;label=Power by&amp;message=hugo&amp;logo=hugo&#34;</span> <span style=color:#06b6ef>style</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;display: unset;&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>a</span>&gt;
</span></span></code></pre></div><h2 id=网站运行时间>网站运行时间<a hidden class=anchor aria-hidden=true href=#网站运行时间>#</a></h2><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><p>起始时间自行修改</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;runtime_span&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt; 
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>type</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;text/javascript&#34;</span>&gt;<span style=color:#815ba4>function</span> <span style=color:#06b6ef>show_runtime</span>(){window.<span style=color:#06b6ef>setTimeout</span>(<span style=color:#48b685>&#34;show_runtime()&#34;</span>,<span style=color:#f99b15>1000</span>);<span style=color:#06b6ef>X</span><span style=color:#5bc4bf>=</span><span style=color:#815ba4>new</span> Date(<span style=color:#48b685>&#34;7/13/2021 1:00:00&#34;</span>);<span style=color:#06b6ef>Y</span><span style=color:#5bc4bf>=</span><span style=color:#815ba4>new</span> Date();<span style=color:#06b6ef>T</span><span style=color:#5bc4bf>=</span>(<span style=color:#06b6ef>Y</span>.<span style=color:#06b6ef>getTime</span>()<span style=color:#5bc4bf>-</span><span style=color:#06b6ef>X</span>.<span style=color:#06b6ef>getTime</span>());<span style=color:#06b6ef>M</span><span style=color:#5bc4bf>=</span><span style=color:#f99b15>24</span><span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span><span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span><span style=color:#5bc4bf>*</span><span style=color:#f99b15>1000</span>;<span style=color:#06b6ef>a</span><span style=color:#5bc4bf>=</span><span style=color:#06b6ef>T</span><span style=color:#5bc4bf>/</span><span style=color:#06b6ef>M</span>;<span style=color:#06b6ef>A</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>(<span style=color:#06b6ef>a</span>);<span style=color:#06b6ef>b</span><span style=color:#5bc4bf>=</span>(<span style=color:#06b6ef>a</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>A</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>24</span>;<span style=color:#06b6ef>B</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>(<span style=color:#06b6ef>b</span>);<span style=color:#06b6ef>c</span><span style=color:#5bc4bf>=</span>(<span style=color:#06b6ef>b</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>B</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span>;<span style=color:#06b6ef>C</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>((<span style=color:#06b6ef>b</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>B</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span>);<span style=color:#06b6ef>D</span><span style=color:#5bc4bf>=</span>Math.<span style=color:#06b6ef>floor</span>((<span style=color:#06b6ef>c</span><span style=color:#5bc4bf>-</span><span style=color:#06b6ef>C</span>)<span style=color:#5bc4bf>*</span><span style=color:#f99b15>60</span>);<span style=color:#06b6ef>runtime_span</span>.<span style=color:#06b6ef>innerHTML</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;网站已运行&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>A</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;天&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>B</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;小时&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>C</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;分&#34;</span><span style=color:#5bc4bf>+</span><span style=color:#06b6ef>D</span><span style=color:#5bc4bf>+</span><span style=color:#48b685>&#34;秒&#34;</span>}<span style=color:#06b6ef>show_runtime</span>();&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span></code></pre></div><h2 id=访问人数统计>访问人数统计<a hidden class=anchor aria-hidden=true href=#访问人数统计>#</a></h2><blockquote><p>统计功能源自：http://busuanzi.ibruce.info/</p></blockquote><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#5bc4bf>script</span> <span style=color:#06b6ef>async</span> <span style=color:#06b6ef>src</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_container&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#5bc4bf>link</span> <span style=color:#06b6ef>rel</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;stylesheet&#34;</span> <span style=color:#06b6ef>href</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css&#34;</span>&gt;
</span></span><span style=display:flex><span>    总访客数: &lt;<span style=color:#5bc4bf>i</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;fa fa-user&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>i</span>&gt;&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_value_site_uv&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>    |
</span></span><span style=display:flex><span>    总访问量: &lt;<span style=color:#5bc4bf>i</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;fa fa-eye&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>i</span>&gt;&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_value_site_pv&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>    |
</span></span><span style=display:flex><span>    本页访问量: &lt;<span style=color:#5bc4bf>i</span> <span style=color:#06b6ef>class</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;fa fa-eye&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>i</span>&gt;&lt;<span style=color:#5bc4bf>span</span> <span style=color:#06b6ef>id</span><span style=color:#5bc4bf>=</span><span style=color:#48b685>&#34;busuanzi_value_page_pv&#34;</span>&gt;&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#5bc4bf>span</span>&gt;
</span></span></code></pre></div><h1 id=其他修改>其他修改<a hidden class=anchor aria-hidden=true href=#其他修改>#</a></h1><p>其他 css样式修改 基本都是通过 f12控制台 一点点摸索改的，不太规范且比较琐碎就不单独记录了，<del>其实我根本已经忘记还改了哪些东西</del></p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://www.lvbibir.cn/img/wechat_pay.png alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://www.lvbibir.cn/img/alipay.png alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>🧧 鼓励</span></button></div></div><footer class=post-footer><nav class=paginav><a class=next href=https://www.lvbibir.cn/posts/tech/kubernetes-prometheus-2-servicemonitor/><span class=title>下一页 »</span><br><span>prometheus (二) 服务发现(serviceMonitor)</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.15/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo.lvbibir.cn/",el:"#tcomment",lang:"zh-CN",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><a href=https://gohugo.io/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/frame-hugo-blue.svg></a>
<a href=https://github.com/adityatelange/hugo-PaperMod target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/theme-papermod-lightgrey.svg></a>
<a href=https://cn.aliyun.com/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/图床-阿里云-orange.svg></a><br><span id=runtime_span></span>
<script type=text/javascript>function show_runtime(){window.setTimeout("show_runtime()",1e3),X=new Date("7/13/2021 1:00:00"),Y=new Date,T=Y.getTime()-X.getTime(),M=24*60*60*1e3,a=T/M,A=Math.floor(a),b=(a-A)*24,B=Math.floor(b),c=(b-B)*60,C=Math.floor((b-B)*60),D=Math.floor((c-C)*60),runtime_span.innerHTML="网站已运行"+A+"天"+B+"小时"+C+"分"+D+"秒"}show_runtime()</script>|
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container>总访客数: <span id=busuanzi_value_site_uv></span>
|
总访问量: <span id=busuanzi_value_site_pv></span></span><br><a href=https://beian.miit.gov.cn/ target=_blank style="border-bottom:1px solid">京ICP备2021023168号-1</a>&nbsp;
|
<span>Copyright
&copy;
2020-2023
<a href=https://www.lvbibir.cn style="border-bottom:1px solid">lvbibir's Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a>
<script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="📄复制";function s(){t.innerText="👌🏻已复制!",setTimeout(()=>{t.innerText="📄复制"},2e3)}t.addEventListener("click",t=>{const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild===n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>