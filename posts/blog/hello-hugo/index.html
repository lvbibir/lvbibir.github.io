<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>【置顶】Hello,hugo! | lvbibir's Blog</title><meta name=keywords content="hugo,papermod,docker,博客部署,博客优化"><meta name=description content="记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……"><meta name=author content="
作者:&nbsp;lvbibir"><link rel=canonical href=https://www.lvbibir.cn/posts/blog/hello-hugo/><link crossorigin=anonymous href=/assets/css/stylesheet.e4e8bad103cf0b7c54d7d8b3d20729f6840eac66925b902480aff8dce45dda67.css integrity="sha256-5Oi60QPPC3xU19iz0gcp9oQOrGaSW5AkgK/43ORd2mc=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=16x16 href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=32x32 href=https://www.lvbibir.cn/img/avatar.gif><link rel=apple-touch-icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=mask-icon href=https://www.lvbibir.cn/img/avatar.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="【置顶】Hello,hugo!"><meta property="og:description" content="记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lvbibir.cn/posts/blog/hello-hugo/"><meta property="og:image" content="https://image.lvbibir.cn/blog/hugo-logo-wide.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-11T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://image.lvbibir.cn/blog/hugo-logo-wide.svg"><meta name=twitter:title content="【置顶】Hello,hugo!"><meta name=twitter:description content="记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"📚 文章","item":"https://www.lvbibir.cn/posts/"},{"@type":"ListItem","position":3,"name":"🏗️ 建站","item":"https://www.lvbibir.cn/posts/blog/"},{"@type":"ListItem","position":4,"name":"【置顶】Hello,hugo!","item":"https://www.lvbibir.cn/posts/blog/hello-hugo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"【置顶】Hello,hugo!","name":"【置顶】Hello,hugo!","description":"记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……","keywords":["hugo","papermod","docker","博客部署","博客优化"],"articleBody":"前言 这篇文章是个大杂烩，且之后对于我博客的修改基本都会记录在这里，所以本文偏向个人备忘，并不是一个很合格的教程\n一键将hugo博客部署到阿里云 虽说标题带有一键，但还是有一定的门槛的，需要对dokcer、docker-compose、nginx有一定了解\n之前的wordpress博客部署在阿里云的一套 docker-compose 环境下，wordpress迁移到docker 有详细记录\n基于之前的配置进行了一些优化和调整，基于需求下载对应的配置文件：hugo、wordpress、hugo + wordpress\nhugo 包含 nginx-proxy、nginx-hugo 和 twikoo 组件\n既然已经有了自己的服务器，我将 twikoo 评论组件也集成了进来访问速度要快很多，具体配置参考下文 twikoo评论\n确保服务器网络、ssl证书申请、服务器公网ip、域名解析、服务器安全组权限(80/443)等基础配置已经一应俱全 确保服务器安装了 docker 和 docker-compose 按照下文先把自定义的配置添加进去（域名和证书） 配置完之后在hugo-blog-dockercompose目录下执行docker-compose -f docker-compose.yml up -d即可启动容器 hugo-blog-dockercompose/conf/nginx-hugo/nginx.conf\n...... server { listen 80 default_server; listen [::]:80 default_server; server_name ******; # 修改域名(hugo) root /var/www/html; ...... hugo-blog-dockercompose/conf/nginx-proxy/default.conf\n将你的ssl证书放到hugo-blog-dockercompose/ssl/目录下\n这里共4个server，分别对应 hugo的nginx 和 twikoo的http 和 https，证书申请参考 阿里云wordpress配置免费ssl证书\nserver { listen 80; listen [::]:80; server_name ******; # 修改域名(hugo) return 301 https://$host$request_uri; } server { listen 80; listen [::]:80; server_name ******; # 修改域名(twikoo) return 301 https://$host$request_uri; } server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name ******; # 修改域名(hugo) ...... ssl_certificate /etc/nginx/ssl/******; # 证书(hugo) ssl_certificate_key /etc/nginx/ssl/******; # 证书(hugo)） ...... } server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name ******; # 修改域名(twikoo) ...... ssl_certificate /etc/nginx/ssl/******; # 证书(twikoo) ssl_certificate_key /etc/nginx/ssl/******; # 证书(twikoo) ...... } hugo+wordpress 包含组件：nginx-proxy | nginx-hugo、twikoo | nginx-wordpress、wordpress-php、redis、mysql\n这里就不过多介绍了，是我目前在用的方案，基于 wordpress迁移到docker 中介绍到的方案中加入了hugo的元素\nworkflow 编辑文章 采用 typora + picgo + 七牛云图床流程，参考我的另一篇文章：typora+picgo+七牛云上传图片\n生成静态文件 hugo -F --cleanDestinationDir 后面两个参数表示会先删除之前生成的 public 目录，保证每次生成的 public 都是新的\n上传静态文件 将 mobaxterm 的命令添加到用户环境变量中，以实现 git bash 、 vscode 、以及 windows terminal 中运行一些 mobaxterm 本地终端附带的命令，也就无需再专门打开一次 mobaxterm 去上传文件了\nrsync -avuz --progress --delete public/ root@lvbibir.cn:/root/blog/data/hugo/ 归档备份 研究 hugo 建站之初是打算采用 github pages 来发布静态博客\n优点 仅需一个github账号和简单配置即可将静态博客发布到 github pages 没有维护的时间成本，可以将精力更多的放到博客内容本身上去 无需备案 无需ssl证书 缺点 访问速度较慢 访问速度较慢 访问速度较慢 虽说访问速度较慢可以通过各家的cdn加速来解决，但由于刚开始建立 blog 选择的是 wordpress ，域名、服务器、备案、证书等都已经一应俱全，且之前的架构采用 docker，添加一台 nginx 来跑 hugo 的静态网站是很方便的\n所以干脆沿用之前的 github仓库 ，来作为我博客的归档管理，也可以方便家里电脑和工作电脑之间的数据同步\n图片并排展示 当主题默认配置下，图片宽度为 max-width: 100%;，如果是手机截图类型的图片，可能一个页面都展示不全一个图片\n单张图片建议修改尺寸，多张图片可以并排展示\n\u003ccenter class=\"half\"\u003e \u003cimg src=\"图片路径\" width=\"194\" style=\"display: unset;\"/\u003e \u003cimg src=\"图片路径\" width=\"194\" style=\"display: unset;\"/\u003e \u003cimg src=\"图片路径\" width=\"194\" style=\"display: unset;\"/\u003e \u003cimg src=\"图片路径\" width=\"194\" style=\"display: unset;\"/\u003e \u003c/center\u003e 另外也可以通过在线的免费工具拼接图片\n修改链接颜色 在 hugo+papermod 默认配置下，链接颜色是黑色字体带下划线的组合，个人非常喜欢 typora-vue 的渲染风格，hugo官方文档给出了通过render hooks覆盖默认的markdown渲染的方式\n新建layouts/_default/_markup/render-link.html文件，在官方给出的示例中添加了 style=\"color:#42b983，颜色可以自行修改，代码如下\n\u003ca href=\"{{ .Destination | safeURL }}\"{{ with .Title}} title=\"{{ . }}\"{{ end }}{{ if strings.HasPrefix .Destination \"http\" }} target=\"_blank\" rel=\"noopener\" style=\"color:#42b983\";{{ end }}\u003e{{ .Text | safeHTML }}\u003c/a\u003e url管理 https://gohugo.io/content-management/urls/\nseo优化 https://www.sulvblog.cn/posts/blog/hugo_seo/\ntwikoo评论 基本完全按照 sulv 博主的文章来操作，某些地方官方有更新，不过也只是更改了页面罢了\n顺便记录一下账号关系：mongodb使用google账号登录，vercel使用github登录\n官方文档：https://twikoo.js.org/quick-start.html\nvercel+mongodb+github部署方式参考：https://www.sulvblog.cn/posts/blog/hugo_twikoo/\n私有部署（docker) docker run --name twikoo -e TWIKOO_THROTTLE=1000 -p 8080:8080 -v ${PWD}/data:/app/data -d imaegoo/twikoo 部署完成后看到如下结果即成功\n[root@lvbibir ~]# curl http://localhost:8080 {\"code\":100,\"message\":\"Twikoo 云函数运行正常，请参考 https://twikoo.js.org/quick-start.html#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2 完成前端的配置\",\"version\":\"1.6.7\"} 后续最好套上反向代理，加上域名和证书\n更新 拉取新版本 docker pull imaegoo/twikoo\n停止旧版本容器 docker stop twikoo\n删除旧版本容器 docker rm twikoo\n部署新版本容器\n前端代码 创建或者修改 layouts\\partials\\comments.html\n💬评论 调用上述twikoo代码的位置：layouts/_default/single.html\n// 其他代码...... {{- if (.Param \"comments\") }} {{- partial \"comments.html\" . }} {{- end }} 在站点配置文件config中加上版本号\nparams: twikoo: version: 1.6.7 shortcode ppt、bilibili、youtube、豆瓣阅读和电影卡片\nhttps://www.sulvblog.cn/posts/blog/shortcodes/\nmermaid\nhttps://www.sulvblog.cn/posts/blog/hugo_mermaid/\n图片画廊\nhttps://github.com/liwenyip/hugo-easy-gallery/\nhttps://www.liwen.id.au/heg/\n自定义footer 自定义页脚内容\n添加完下面的页脚内容后要修改 assets\\css\\extended\\blank.css 中的 --footer-height 的大小，具体数字需要考虑到行数和字体大小\n自定义徽标 徽标功能源自：https://shields.io/ 考虑到访问速度，可以在生成完徽标后放到自己的cdn上\n在 layouts\\partials\\footer.html 中的 添加如下\n\u003ca href=\"https://gohugo.io/\" target=\"_blank\"\u003e \u003cimg src=\"https://img.shields.io/static/v1?\u0026style=plastic\u0026color=308fb5\u0026label=Power by\u0026message=hugo\u0026logo=hugo\" style=\"display: unset;\"\u003e \u003c/a\u003e 网站运行时间 在 layouts\\partials\\footer.html 中的 添加如下\n起始时间自行修改\n\u003cspan id=\"runtime_span\"\u003e\u003c/span\u003e \u003cscript type=\"text/javascript\"\u003efunction show_runtime(){window.setTimeout(\"show_runtime()\",1000);X=new Date(\"7/13/2021 1:00:00\");Y=new Date();T=(Y.getTime()-X.getTime());M=24*60*60*1000;a=T/M;A=Math.floor(a);b=(a-A)*24;B=Math.floor(b);c=(b-B)*60;C=Math.floor((b-B)*60);D=Math.floor((c-C)*60);runtime_span.innerHTML=\"网站已运行\"+A+\"天\"+B+\"小时\"+C+\"分\"+D+\"秒\"}show_runtime();\u003c/script\u003e 访问人数统计 统计功能源自：http://busuanzi.ibruce.info/\n在 layouts\\partials\\footer.html 中的 添加如下\n\u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"\u003e\u003c/script\u003e \u003cspan id=\"busuanzi_container\"\u003e \u003clink rel=\"stylesheet\" href=\"//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css\"\u003e 总访客数: \u003ci class=\"fa fa-user\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003e | 总访问量: \u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003e | 本页访问量: \u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e\u003cspan id=\"busuanzi_value_page_pv\"\u003e\u003c/span\u003e \u003c/span\u003e todo 修改所有文章的文件名为全英文 百度seo优化 谷歌seo优化 必应seo优化 尝试再次优化nginx的配置，之前的配置对于 php 程序更适用 图床备份 将所有文章进行内容整理 说说页面 朋友圈页面 ","wordCount":"2937","inLanguage":"en","image":"https://image.lvbibir.cn/blog/hugo-logo-wide.svg","datePublished":"2022-07-06T00:00:00Z","dateModified":"2022-09-11T00:00:00Z","author":{"@type":"Person","name":"lvbibir"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lvbibir.cn/posts/blog/hello-hugo/"},"publisher":{"@type":"Organization","name":"lvbibir's Blog","logo":{"@type":"ImageObject","url":"https://www.lvbibir.cn/img/avatar.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.lvbibir.cn accesskey=h title="lvbibir's Blog (Alt + H)"><img src=https://www.lvbibir.cn/img/avatar.gif alt aria-label=logo height=35>lvbibir's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.lvbibir.cn/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://www.lvbibir.cn/ title="🏡 主页"><span>🏡 主页</span></a></li><li><a href=https://www.lvbibir.cn/posts title="📚 文章"><span>📚 文章</span></a></li><li><a href=https://www.lvbibir.cn/tags title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://www.lvbibir.cn/archives title="📈 归档"><span>📈 归档</span></a></li><li><a href=https://www.lvbibir.cn/links title="🤝 友链"><span>🤝 友链</span></a></li><li><a href=https://www.lvbibir.cn/about title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://www.lvbibir.cn>主页</a>&nbsp;»&nbsp;<a href=https://www.lvbibir.cn/posts/>📚 文章</a>&nbsp;»&nbsp;<a href=https://www.lvbibir.cn/posts/blog/>🏗️ 建站</a></div><h1 class=post-title>【置顶】Hello,hugo!</h1><div class=post-description>记录wordpress迁移至hugo+papermod的过程包含环境搭建、博客美化、功能实现、速度优化等……</div><div class=post-meta>创建:&nbsp;<span title='2022-07-06 00:00:00 +0000 UTC'>2022-07-06</span>&nbsp;|&nbsp;更新:&nbsp;2022-09-11&nbsp;|&nbsp;字数:&nbsp;2937字&nbsp;|&nbsp;时长:&nbsp;6分钟&nbsp;|&nbsp;
作者:&nbsp;lvbibir
&nbsp;|&nbsp;标签: &nbsp;<ul class=post-tags-meta><a href=https://www.lvbibir.cn/tags/hugo/>hugo</a>
<a href=https://www.lvbibir.cn/tags/docker/>、docker</a></ul><span id=busuanzi_container_page_pv>&nbsp;| 访问: <span id=busuanzi_value_page_pv></span></span></div></header><figure class=entry-cover1><img loading=lazy src=https://image.lvbibir.cn/blog/hugo-logo-wide.svg alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>文章目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e4%b8%80%e9%94%ae%e5%b0%86hugo%e5%8d%9a%e5%ae%a2%e9%83%a8%e7%bd%b2%e5%88%b0%e9%98%bf%e9%87%8c%e4%ba%91 aria-label=一键将hugo博客部署到阿里云>一键将hugo博客部署到阿里云</a><ul><li><a href=#hugo aria-label=hugo>hugo</a></li><li><a href=#hugowordpress aria-label=hugo+wordpress>hugo+wordpress</a></li></ul></li><li><a href=#workflow aria-label=workflow>workflow</a><ul><li><a href=#%e7%bc%96%e8%be%91%e6%96%87%e7%ab%a0 aria-label=编辑文章>编辑文章</a></li><li><a href=#%e7%94%9f%e6%88%90%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6 aria-label=生成静态文件>生成静态文件</a></li><li><a href=#%e4%b8%8a%e4%bc%a0%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6 aria-label=上传静态文件>上传静态文件</a></li><li><a href=#%e5%bd%92%e6%a1%a3%e5%a4%87%e4%bb%bd aria-label=归档备份>归档备份</a></li></ul></li><li><a href=#%e5%9b%be%e7%89%87%e5%b9%b6%e6%8e%92%e5%b1%95%e7%a4%ba aria-label=图片并排展示>图片并排展示</a></li><li><a href=#%e4%bf%ae%e6%94%b9%e9%93%be%e6%8e%a5%e9%a2%9c%e8%89%b2 aria-label=修改链接颜色>修改链接颜色</a></li><li><a href=#url%e7%ae%a1%e7%90%86 aria-label=url管理>url管理</a></li><li><a href=#seo%e4%bc%98%e5%8c%96 aria-label=seo优化>seo优化</a></li><li><a href=#twikoo%e8%af%84%e8%ae%ba aria-label=twikoo评论>twikoo评论</a><ul><li><a href=#%e7%a7%81%e6%9c%89%e9%83%a8%e7%bd%b2docker aria-label=私有部署（docker)>私有部署（docker)</a></li><li><a href=#%e6%9b%b4%e6%96%b0 aria-label=更新>更新</a></li><li><a href=#%e5%89%8d%e7%ab%af%e4%bb%a3%e7%a0%81 aria-label=前端代码>前端代码</a></li></ul></li><li><a href=#shortcode aria-label=shortcode>shortcode</a></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89footer aria-label=自定义footer>自定义footer</a><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%be%bd%e6%a0%87 aria-label=自定义徽标>自定义徽标</a></li><li><a href=#%e7%bd%91%e7%ab%99%e8%bf%90%e8%a1%8c%e6%97%b6%e9%97%b4 aria-label=网站运行时间>网站运行时间</a></li><li><a href=#%e8%ae%bf%e9%97%ae%e4%ba%ba%e6%95%b0%e7%bb%9f%e8%ae%a1 aria-label=访问人数统计>访问人数统计</a></li></ul></li><li><a href=#todo aria-label=todo>todo</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h1><p>这篇文章是个大杂烩，且之后对于我博客的修改基本都会记录在这里，所以本文偏向个人备忘，并不是一个很合格的教程</p><h1 id=一键将hugo博客部署到阿里云>一键将hugo博客部署到阿里云<a hidden class=anchor aria-hidden=true href=#一键将hugo博客部署到阿里云>#</a></h1><blockquote><p>虽说标题带有一键，但还是有一定的门槛的，需要对<code>dokcer</code>、<code>docker-compose</code>、<code>nginx</code>有一定了解</p></blockquote><p>之前的<a href=https://lvbibir.cn target=_blank rel=noopener style=color:#42b983 ;>wordpress博客</a>部署在阿里云的一套 docker-compose 环境下，<a href=https://www.lvbibir.cn/posts/blog/wordpress-to-docker/ target=_blank rel=noopener style=color:#42b983 ;>wordpress迁移到docker</a> 有详细记录</p><p>基于之前的配置进行了一些优化和调整，基于需求下载对应的配置文件：<a href=https://image.lvbibir.cn/files/hugo-blog-dockercompose.tar.gz target=_blank rel=noopener style=color:#42b983 ;>hugo</a>、<a href=https://image.lvbibir.cn/files/wordpress-blog.zip target=_blank rel=noopener style=color:#42b983 ;>wordpress</a>、<a href=https://image.lvbibir.cn/files/hugo-and-wordpress-dockercompose.tar.gz target=_blank rel=noopener style=color:#42b983 ;>hugo + wordpress</a></p><h2 id=hugo>hugo<a hidden class=anchor aria-hidden=true href=#hugo>#</a></h2><blockquote><p>包含 nginx-proxy、nginx-hugo 和 twikoo 组件</p></blockquote><p>既然已经有了自己的服务器，我将 twikoo 评论组件也集成了进来访问速度要快很多，具体配置参考下文 <a href=#twikoo%e8%af%84%e8%ae%ba>twikoo评论</a></p><ol><li>确保服务器网络、ssl证书申请、服务器公网ip、域名解析、服务器安全组权限(80/443)等基础配置已经一应俱全</li><li>确保服务器安装了 docker 和 docker-compose</li><li>按照下文先把自定义的配置添加进去（域名和证书）</li><li>配置完之后在<code>hugo-blog-dockercompose</code>目录下执行<code>docker-compose -f docker-compose.yml up -d</code>即可启动容器</li></ol><p><strong>hugo-blog-dockercompose/conf/nginx-hugo/nginx.conf</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>......</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span>       <span style=color:#ae81ff>80</span> <span style=color:#e6db74>default_server</span>; 
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span>       <span style=color:#e6db74>[::]:80</span> <span style=color:#e6db74>default_server</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>******</span>; <span style=color:#75715e># 修改域名(hugo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/var/www/html</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>......</span>
</span></span></code></pre></div><p><strong>hugo-blog-dockercompose/conf/nginx-proxy/default.conf</strong></p><p>将你的ssl证书放到<code>hugo-blog-dockercompose/ssl/</code>目录下</p><p>这里共4个<code>server</code>，分别对应 <code>hugo的nginx 和 twikoo</code>的<code>http 和 https</code>，证书申请参考 <a href=https://www.lvbibir.cn/posts/blog/wordpress-ssl/ target=_blank rel=noopener style=color:#42b983 ;>阿里云wordpress配置免费ssl证书</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#e6db74>[::]:80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>******</span>; <span style=color:#75715e># 修改域名(hugo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>return</span> <span style=color:#ae81ff>301</span> <span style=color:#e6db74>https://</span>$host$request_uri;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#e6db74>[::]:80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>******</span>; <span style=color:#75715e># 修改域名(twikoo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>return</span> <span style=color:#ae81ff>301</span> <span style=color:#e6db74>https://</span>$host$request_uri;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#e6db74>[::]:443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>******</span>; <span style=color:#75715e># 修改域名(hugo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>......</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>ssl_certificate</span> <span style=color:#e6db74>/etc/nginx/ssl/******</span>; <span style=color:#75715e># 证书(hugo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/etc/nginx/ssl/******</span>; <span style=color:#75715e># 证书(hugo)）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>......</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#e6db74>[::]:443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>******</span>; <span style=color:#75715e># 修改域名(twikoo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>......</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>ssl_certificate</span> <span style=color:#e6db74>/etc/nginx/ssl/******</span>; <span style=color:#75715e># 证书(twikoo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/etc/nginx/ssl/******</span>; <span style=color:#75715e># 证书(twikoo)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>......</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><h2 id=hugowordpress>hugo+wordpress<a hidden class=anchor aria-hidden=true href=#hugowordpress>#</a></h2><blockquote><p>包含组件：nginx-proxy | nginx-hugo、twikoo | nginx-wordpress、wordpress-php、redis、mysql</p></blockquote><p>这里就不过多介绍了，是我目前在用的方案，基于 <a href=https://www.lvbibir.cn/posts/blog/wordpress-to-docker/ target=_blank rel=noopener style=color:#42b983 ;>wordpress迁移到docker</a> 中介绍到的方案中加入了hugo的元素</p><h1 id=workflow>workflow<a hidden class=anchor aria-hidden=true href=#workflow>#</a></h1><h2 id=编辑文章>编辑文章<a hidden class=anchor aria-hidden=true href=#编辑文章>#</a></h2><p>采用 typora + picgo + 七牛云图床流程，参考我的另一篇文章：<a href=https://www.lvbibir.cn/posts/blog/typora-picgo-qiniu-upload-image/ target=_blank rel=noopener style=color:#42b983 ;>typora+picgo+七牛云上传图片</a></p><h2 id=生成静态文件>生成静态文件<a hidden class=anchor aria-hidden=true href=#生成静态文件>#</a></h2><pre tabindex=0><code>hugo -F --cleanDestinationDir
</code></pre><p>后面两个参数表示会先删除之前生成的 public 目录，保证每次生成的 public 都是新的</p><h2 id=上传静态文件>上传静态文件<a hidden class=anchor aria-hidden=true href=#上传静态文件>#</a></h2><p>将 <code>mobaxterm</code> 的命令添加到用户环境变量中，以实现 <code>git bash</code> 、 <code>vscode</code> 、以及 <code>windows terminal</code> 中运行一些 mobaxterm 本地终端附带的命令，也就无需再专门打开一次 mobaxterm 去上传文件了</p><pre tabindex=0><code>rsync -avuz --progress --delete public/ root@lvbibir.cn:/root/blog/data/hugo/
</code></pre><h2 id=归档备份>归档备份<a hidden class=anchor aria-hidden=true href=#归档备份>#</a></h2><p>研究 hugo 建站之初是打算采用 github pages 来发布静态博客</p><ul><li>优点</li><li><ul><li>仅需一个github账号和简单配置即可将静态博客发布到 github pages</li><li>没有维护的时间成本，可以将精力更多的放到博客内容本身上去</li><li>无需备案</li><li>无需ssl证书</li></ul></li><li>缺点</li><li><ul><li>访问速度较慢</li><li>访问速度较慢</li><li>访问速度较慢</li></ul></li></ul><p>虽说访问速度较慢可以通过各家的cdn加速来解决，但由于刚开始建立 blog 选择的是 wordpress ，域名、服务器、备案、证书等都已经一应俱全，且之前的架构采用 docker，添加一台 nginx 来跑 hugo 的静态网站是很方便的</p><p>所以干脆沿用之前的 <a href=https://github.com/lvbibir/lvbibir.github.io target=_blank rel=noopener style=color:#42b983 ;>github仓库</a> ，来作为我博客的归档管理，也可以方便家里电脑和工作电脑之间的数据同步</p><h1 id=图片并排展示>图片并排展示<a hidden class=anchor aria-hidden=true href=#图片并排展示>#</a></h1><p>当主题默认配置下，图片宽度为 <code>max-width: 100%;</code>，如果是手机截图类型的图片，可能一个页面都展示不全一个图片</p><p>单张图片建议修改尺寸，多张图片可以并排展示</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>center</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;half&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;图片路径&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;194&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;display: unset;&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;图片路径&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;194&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;display: unset;&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;图片路径&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;194&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;display: unset;&#34;</span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;图片路径&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;194&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;display: unset;&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>center</span>&gt;
</span></span></code></pre></div><p>另外也可以通过在线的免费工具拼接图片</p><h1 id=修改链接颜色>修改链接颜色<a hidden class=anchor aria-hidden=true href=#修改链接颜色>#</a></h1><p>在 hugo+papermod 默认配置下，链接颜色是黑色字体带下划线的组合，个人非常喜欢 <a href=https://github.com/blinkfox/typora-vue-theme target=_blank rel=noopener style=color:#42b983 ;>typora-vue</a> 的渲染风格，<a href=https://gohugo.io/templates/render-hooks/#link-with-title-markdown-example target=_blank rel=noopener style=color:#42b983 ;>hugo官方文档</a>给出了通过<code>render hooks</code>覆盖默认的markdown渲染的方式</p><p>新建<code>layouts/_default/_markup/render-link.html</code>文件，在官方给出的示例中添加了 <code>style="color:#42b983</code>，颜色可以自行修改，代码如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ .Destination | safeURL }}&#34;</span><span style=color:#960050;background-color:#1e0010>{{</span> <span style=color:#a6e22e>with</span> <span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>Title</span><span style=color:#960050;background-color:#1e0010>}}</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ . }}&#34;</span><span style=color:#960050;background-color:#1e0010>{{</span> <span style=color:#a6e22e>end</span> <span style=color:#960050;background-color:#1e0010>}}{{</span> <span style=color:#a6e22e>if</span> <span style=color:#a6e22e>strings</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>HasPrefix</span> <span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>Destination</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>http</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#960050;background-color:#1e0010>}}</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;noopener&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;color:#42b983&#34;</span><span style=color:#960050;background-color:#1e0010>;{{</span> <span style=color:#a6e22e>end</span> <span style=color:#960050;background-color:#1e0010>}}</span>&gt;{{ .Text | safeHTML }}&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><h1 id=url管理>url管理<a hidden class=anchor aria-hidden=true href=#url管理>#</a></h1><p><a href=https://gohugo.io/content-management/urls/ target=_blank rel=noopener style=color:#42b983 ;>https://gohugo.io/content-management/urls/</a></p><h1 id=seo优化>seo优化<a hidden class=anchor aria-hidden=true href=#seo优化>#</a></h1><p><a href=https://www.sulvblog.cn/posts/blog/hugo_seo/ target=_blank rel=noopener style=color:#42b983 ;>https://www.sulvblog.cn/posts/blog/hugo_seo/</a></p><h1 id=twikoo评论>twikoo评论<a hidden class=anchor aria-hidden=true href=#twikoo评论>#</a></h1><p><del>基本完全按照 <a href=https://www.sulvblog.cn/posts/blog/hugo_twikoo/ target=_blank rel=noopener style=color:#42b983 ;>sulv 博主</a>的文章来操作，某些地方官方有更新，不过也只是更改了页面罢了</del></p><p><del>顺便记录一下账号关系：mongodb使用google账号登录，vercel使用github登录</del></p><blockquote><p>官方文档：https://twikoo.js.org/quick-start.html</p><p>vercel+mongodb+github部署方式参考：https://www.sulvblog.cn/posts/blog/hugo_twikoo/</p></blockquote><h2 id=私有部署docker>私有部署（docker)<a hidden class=anchor aria-hidden=true href=#私有部署docker>#</a></h2><pre tabindex=0><code>docker run --name twikoo -e TWIKOO_THROTTLE=1000 -p 8080:8080 -v ${PWD}/data:/app/data -d imaegoo/twikoo
</code></pre><p>部署完成后看到如下结果即成功</p><pre tabindex=0><code>[root@lvbibir ~]# curl http://localhost:8080
{&#34;code&#34;:100,&#34;message&#34;:&#34;Twikoo 云函数运行正常，请参考 https://twikoo.js.org/quick-start.html#%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2 完成前端的配置&#34;,&#34;version&#34;:&#34;1.6.7&#34;}
</code></pre><p>后续最好套上反向代理，加上域名和证书</p><h2 id=更新>更新<a hidden class=anchor aria-hidden=true href=#更新>#</a></h2><ol><li><p>拉取新版本 <code>docker pull imaegoo/twikoo</code></p></li><li><p>停止旧版本容器 <code>docker stop twikoo</code></p></li><li><p>删除旧版本容器 <code>docker rm twikoo</code></p></li><li><p>部署新版本容器</p></li></ol><h2 id=前端代码>前端代码<a hidden class=anchor aria-hidden=true href=#前端代码>#</a></h2><p>创建或者修改 <code>layouts\partials\comments.html</code></p><pre tabindex=0><code>&lt;!-- Twikoo --&gt;
&lt;div&gt;
    &lt;div class=&#34;pagination__title&#34;&gt;
        &lt;span class=&#34;pagination__title-h&#34; style=&#34;font-size: 20px;&#34;&gt;💬评论&lt;/span&gt;
        &lt;hr /&gt;
    &lt;/div&gt;
    &lt;div id=&#34;tcomment&#34;&gt;&lt;/div&gt;
    &lt;script src=&#34;https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js&#34;&gt;&lt;/script&gt;
    &lt;script&gt;
        twikoo.init({
            envId: &#34;&#34;, //填自己的，例如：https://example.com
            el: &#34;#tcomment&#34;,
            lang: &#39;zh-CN&#39;,
            path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        });
    &lt;/script&gt;
&lt;/div&gt;
</code></pre><p>调用上述twikoo代码的位置：<code>layouts/_default/single.html</code></p><pre tabindex=0><code>&lt;article class=&#34;post-single&#34;&gt;
  // 其他代码......
  {{- if (.Param &#34;comments&#34;) }}
    {{- partial &#34;comments.html&#34; . }}
  {{- end }}
&lt;/article&gt;
</code></pre><p>在站点配置文件config中加上版本号</p><pre tabindex=0><code>params:
	twikoo:
      version: 1.6.7
</code></pre><h1 id=shortcode>shortcode<a hidden class=anchor aria-hidden=true href=#shortcode>#</a></h1><p>ppt、bilibili、youtube、豆瓣阅读和电影卡片</p><p><a href=https://www.sulvblog.cn/posts/blog/shortcodes/ target=_blank rel=noopener style=color:#42b983 ;>https://www.sulvblog.cn/posts/blog/shortcodes/</a></p><p>mermaid</p><p><a href=https://www.sulvblog.cn/posts/blog/hugo_mermaid/ target=_blank rel=noopener style=color:#42b983 ;>https://www.sulvblog.cn/posts/blog/hugo_mermaid/</a></p><p>图片画廊</p><p><a href=https://github.com/liwenyip/hugo-easy-gallery/ target=_blank rel=noopener style=color:#42b983 ;>https://github.com/liwenyip/hugo-easy-gallery/</a></p><p><a href=https://www.liwen.id.au/heg/ target=_blank rel=noopener style=color:#42b983 ;>https://www.liwen.id.au/heg/</a></p><h1 id=自定义footer>自定义footer<a hidden class=anchor aria-hidden=true href=#自定义footer>#</a></h1><p>自定义页脚内容</p><p><img loading=lazy src=https://image.lvbibir.cn/blog/image-20220911150229930.png alt=image-20220911150229930></p><p>添加完下面的页脚内容后要修改 <code>assets\css\extended\blank.css</code> 中的 <code>--footer-height</code> 的大小，具体数字需要考虑到行数和字体大小</p><h2 id=自定义徽标>自定义徽标<a hidden class=anchor aria-hidden=true href=#自定义徽标>#</a></h2><blockquote><p>徽标功能源自：https://shields.io/
考虑到访问速度，可以在生成完徽标后放到自己的cdn上</p></blockquote><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://gohugo.io/&#34;</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://img.shields.io/static/v1?&amp;style=plastic&amp;color=308fb5&amp;label=Power by&amp;message=hugo&amp;logo=hugo&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;display: unset;&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><h2 id=网站运行时间>网站运行时间<a hidden class=anchor aria-hidden=true href=#网站运行时间>#</a></h2><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><p>起始时间自行修改</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>    &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;runtime_span&#34;</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt; 
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span>&gt;<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>show_runtime</span>(){window.<span style=color:#a6e22e>setTimeout</span>(<span style=color:#e6db74>&#34;show_runtime()&#34;</span>,<span style=color:#ae81ff>1000</span>);<span style=color:#a6e22e>X</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> Date(<span style=color:#e6db74>&#34;7/13/2021 1:00:00&#34;</span>);<span style=color:#a6e22e>Y</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> Date();<span style=color:#a6e22e>T</span><span style=color:#f92672>=</span>(<span style=color:#a6e22e>Y</span>.<span style=color:#a6e22e>getTime</span>()<span style=color:#f92672>-</span><span style=color:#a6e22e>X</span>.<span style=color:#a6e22e>getTime</span>());<span style=color:#a6e22e>M</span><span style=color:#f92672>=</span><span style=color:#ae81ff>24</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span><span style=color:#f92672>*</span><span style=color:#ae81ff>1000</span>;<span style=color:#a6e22e>a</span><span style=color:#f92672>=</span><span style=color:#a6e22e>T</span><span style=color:#f92672>/</span><span style=color:#a6e22e>M</span>;<span style=color:#a6e22e>A</span><span style=color:#f92672>=</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>a</span>);<span style=color:#a6e22e>b</span><span style=color:#f92672>=</span>(<span style=color:#a6e22e>a</span><span style=color:#f92672>-</span><span style=color:#a6e22e>A</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>24</span>;<span style=color:#a6e22e>B</span><span style=color:#f92672>=</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>b</span>);<span style=color:#a6e22e>c</span><span style=color:#f92672>=</span>(<span style=color:#a6e22e>b</span><span style=color:#f92672>-</span><span style=color:#a6e22e>B</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>60</span>;<span style=color:#a6e22e>C</span><span style=color:#f92672>=</span>Math.<span style=color:#a6e22e>floor</span>((<span style=color:#a6e22e>b</span><span style=color:#f92672>-</span><span style=color:#a6e22e>B</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>60</span>);<span style=color:#a6e22e>D</span><span style=color:#f92672>=</span>Math.<span style=color:#a6e22e>floor</span>((<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#a6e22e>C</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>60</span>);<span style=color:#a6e22e>runtime_span</span>.<span style=color:#a6e22e>innerHTML</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;网站已运行&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>A</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;天&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>B</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;小时&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>C</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;分&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>D</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;秒&#34;</span>}<span style=color:#a6e22e>show_runtime</span>();&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><h2 id=访问人数统计>访问人数统计<a hidden class=anchor aria-hidden=true href=#访问人数统计>#</a></h2><blockquote><p>统计功能源自：http://busuanzi.ibruce.info/</p></blockquote><p>在 <code>layouts\partials\footer.html</code> 中的 <code>&lt;footer></code> 添加如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>async</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;busuanzi_container&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css&#34;</span>&gt;
</span></span><span style=display:flex><span>    总访客数: &lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fa fa-user&#34;</span>&gt;&lt;/<span style=color:#f92672>i</span>&gt;&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;busuanzi_value_site_uv&#34;</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>    |
</span></span><span style=display:flex><span>    总访问量: &lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fa fa-eye&#34;</span>&gt;&lt;/<span style=color:#f92672>i</span>&gt;&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;busuanzi_value_site_pv&#34;</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>    |
</span></span><span style=display:flex><span>    本页访问量: &lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fa fa-eye&#34;</span>&gt;&lt;/<span style=color:#f92672>i</span>&gt;&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;busuanzi_value_page_pv&#34;</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>span</span>&gt;
</span></span></code></pre></div><h1 id=todo>todo<a hidden class=anchor aria-hidden=true href=#todo>#</a></h1><ul><li><input checked disabled type=checkbox> 修改所有文章的文件名为全英文</li><li><input checked disabled type=checkbox> 百度seo优化</li><li><input checked disabled type=checkbox> 谷歌seo优化</li><li><input checked disabled type=checkbox> 必应seo优化</li><li><input checked disabled type=checkbox> 尝试再次优化nginx的配置，之前的配置对于 php 程序更适用</li><li><input disabled type=checkbox> 图床备份</li><li><input checked disabled type=checkbox> 将所有文章进行内容整理</li><li><input disabled type=checkbox> 说说页面</li><li><input disabled type=checkbox> 朋友圈页面</li></ul></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://www.lvbibir.cn/img/wechat_pay.png alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://www.lvbibir.cn/img/alipay.png alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>🧧 鼓励</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://www.lvbibir.cn/posts/life/running/><span class=title>« 上一页</span><br><span>跑步日常</span></a>
<a class=next href=https://www.lvbibir.cn/posts/tech/ceph-v16.2-cpehadm-offline/><span class=title>下一页 »</span><br><span>cephadm离线安装ceph-V16.2.8</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo.lvbibir.cn/",el:"#tcomment",lang:"zh-CN",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><a href=https://gohugo.io/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/frame-hugo-blue.svg></a>
<a href=https://github.com/adityatelange/hugo-PaperMod target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/theme-papermod-lightgrey.svg></a>
<a href=https://cn.aliyun.com/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/图床-阿里云-orange.svg></a><br><span id=runtime_span></span>
<script type=text/javascript>function show_runtime(){window.setTimeout("show_runtime()",1e3),X=new Date("7/13/2021 1:00:00"),Y=new Date,T=Y.getTime()-X.getTime(),M=24*60*60*1e3,a=T/M,A=Math.floor(a),b=(a-A)*24,B=Math.floor(b),c=(b-B)*60,C=Math.floor((b-B)*60),D=Math.floor((c-C)*60),runtime_span.innerHTML="网站已运行"+A+"天"+B+"小时"+C+"分"+D+"秒"}show_runtime()</script>|
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container>总访客数: <span id=busuanzi_value_site_uv></span>
|
总访问量: <span id=busuanzi_value_site_pv></span></span><br><a href=https://beian.miit.gov.cn/ target=_blank style="border-bottom:1px solid">京ICP备2021023168号-1</a>&nbsp;
|
<span>Copyright
&copy;
2020-2022
<a href=https://www.lvbibir.cn style="border-bottom:1px solid">lvbibir's Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a>
<script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="📄复制";function s(){t.innerText="👌🏻已复制!",setTimeout(()=>{t.innerText="📄复制"},2e3)}t.addEventListener("click",t=>{const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>