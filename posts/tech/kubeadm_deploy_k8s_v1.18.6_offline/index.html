<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 | lvbibir's Blog</title><meta name=keywords content="k8s"><meta name=description content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 å‚è€ƒï¼šhttps://www.cnblogs.com/hukey/p/13773927.html Kubernetes æ¦‚è¿° kubernetes æ˜¯ä»€ä¹ˆ kubernetes æ˜¯ Google"><meta name=author content="
ä½œè€…:&nbsp;lvbibir"><link rel=canonical href=https://www.lvbibir.cn/posts/tech/kubeadm_deploy_k8s_v1.18.6_offline/><link crossorigin=anonymous href=/assets/css/stylesheet.94a5f2945cc847b4c3112f143e6b54636a3fafdf14267e8c7dd0d91a59fe87f9.css integrity="sha256-lKXylFzIR7TDES8UPmtUY2o/r98UJn6MfdDZGln+h/k=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.lvbibir.cn/img/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://www.lvbibir.cn/img/avatar.png><link rel=icon type=image/png sizes=32x32 href=https://www.lvbibir.cn/img/avatar.png><link rel=apple-touch-icon href=https://www.lvbibir.cn/img/avatar.png><link rel=mask-icon href=https://www.lvbibir.cn/img/avatar.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6"><meta property="og:description" content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 å‚è€ƒï¼šhttps://www.cnblogs.com/hukey/p/13773927.html Kubernetes æ¦‚è¿° kubernetes æ˜¯ä»€ä¹ˆ kubernetes æ˜¯ Google"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lvbibir.cn/posts/tech/kubeadm_deploy_k8s_v1.18.6_offline/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-01T00:00:00+08:00"><meta property="article:modified_time" content="2021-10-01T00:00:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6"><meta name=twitter:description content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 å‚è€ƒï¼šhttps://www.cnblogs.com/hukey/p/13773927.html Kubernetes æ¦‚è¿° kubernetes æ˜¯ä»€ä¹ˆ kubernetes æ˜¯ Google"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"ğŸ“šæ–‡ç« ","item":"https://www.lvbibir.cn/posts/"},{"@type":"ListItem","position":3,"name":"ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯","item":"https://www.lvbibir.cn/posts/tech/"},{"@type":"ListItem","position":4,"name":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6","item":"https://www.lvbibir.cn/posts/tech/kubeadm_deploy_k8s_v1.18.6_offline/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6","name":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6","description":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 å‚è€ƒï¼šhttps://www.cnblogs.com/hukey/p/13773927.html Kubernetes æ¦‚è¿° kubernetes æ˜¯ä»€ä¹ˆ kubernetes æ˜¯ Google","keywords":["k8s"],"articleBody":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 å‚è€ƒï¼šhttps://www.cnblogs.com/hukey/p/13773927.html\nKubernetes æ¦‚è¿° kubernetes æ˜¯ä»€ä¹ˆ kubernetes æ˜¯ Google åœ¨ 2014å¹´å¼€æºçš„ä¸€ä¸ªå®¹å™¨é›†ç¾¤ç®¡ç†å¹³å°ï¼Œkubernetesç®€ç§° k8s k8sç”¨äºå®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ï¼Œæ‰©å±•å’Œç®¡ç†ã€‚ k8sæä¾›äº†å®¹å™¨çš„ç¼–æ’ï¼Œèµ„æºè°ƒåº¦ï¼Œå¼¹æ€§ä¼¸ç¼©ï¼Œéƒ¨ç½²ç®¡ç†ï¼ŒæœåŠ¡å‘ç°ç­‰ä¸€ç³»åˆ—åŠŸèƒ½ kubernetesç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–åº”ç”¨ç®€å•é«˜æ•ˆ Kubernetes ç‰¹æ€§ è‡ªæˆ‘ä¿®å¤ åœ¨èŠ‚ç‚¹æ•…éšœæ—¶é‡æ–°å¯åŠ¨å¤±è´¥çš„å®¹å™¨ï¼Œæ›¿æ¢å’Œé‡æ–°éƒ¨ç½²ï¼Œä¿è¯é¢„æœŸçš„å‰¯æœ¬æ•°é‡ï¼›æ€æ­»å¥åº·æ£€æŸ¥å¤±è´¥çš„å®¹å™¨ï¼Œå¹¶ä¸”åœ¨æœªå‡†å¤‡å¥½ä¹‹å‰ä¸ä¼šå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç¡®ä¿çº¿ä¸ŠæœåŠ¡ä¸ä¸­æ–­ã€‚ ä¼¸ç¼©æ€§ ä½¿ç”¨å‘½ä»¤ã€UIæˆ–è€…åŸºäºCPUä½¿ç”¨æƒ…å†µè‡ªåŠ¨å¿«é€Ÿæ‰©å®¹å’Œç¼©å®¹åº”ç”¨ç¨‹åºå®ä¾‹ï¼Œä¿è¯åº”ç”¨ä¸šåŠ¡é«˜å³°å¹¶å‘æ—¶çš„é«˜å¯ç”¨æ€§ï¼›ä¸šåŠ¡ä½å³°æ—¶å›æ”¶èµ„æºï¼Œä»¥æœ€å°æˆæœ¬è¿è¡ŒæœåŠ¡ã€‚ è‡ªåŠ¨éƒ¨ç½²å’Œå›æ»š K8Sé‡‡ç”¨æ»šåŠ¨æ›´æ–°ç­–ç•¥æ›´æ–°åº”ç”¨ï¼Œä¸€æ¬¡æ›´æ–°ä¸€ä¸ªPodï¼Œè€Œä¸æ˜¯åŒæ—¶åˆ é™¤æ‰€æœ‰Podï¼Œå¦‚æœæ›´æ–°è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œå°†å›æ»šæ›´æ”¹ï¼Œç¡®ä¿å‡çº§ä¸å—å½±å“ä¸šåŠ¡ã€‚ æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ K8Sä¸ºå¤šä¸ªå®¹å™¨æä¾›ä¸€ä¸ªç»Ÿä¸€è®¿é—®å…¥å£ï¼ˆå†…éƒ¨IPåœ°å€å’Œä¸€ä¸ªDNSåç§°ï¼‰ï¼Œå¹¶ä¸”è´Ÿè½½å‡è¡¡å…³è”çš„æ‰€æœ‰å®¹å™¨ï¼Œä½¿å¾—ç”¨æˆ·æ— éœ€è€ƒè™‘å®¹å™¨IPé—®é¢˜ã€‚ æœºå¯†å’Œé…ç½®ç®¡ç† ç®¡ç†æœºå¯†æ•°æ®å’Œåº”ç”¨ç¨‹åºé…ç½®ï¼Œè€Œä¸éœ€è¦æŠŠæ•æ„Ÿæ•°æ®æš´éœ²åœ¨é•œåƒé‡Œï¼Œæé«˜æ•æ„Ÿæ•°æ®å®‰å…¨æ€§ã€‚å¹¶å¯ä»¥å°†ä¸€äº›å¸¸ç”¨çš„é…ç½®å­˜å‚¨åœ¨K8Sä¸­ï¼Œæ–¹ä¾¿åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚ å­˜å‚¨ç¼–æ’ æŒ‚è½½å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿï¼Œæ— è®ºæ˜¯æ¥è‡ªæœ¬åœ°å­˜å‚¨ï¼Œå…¬æœ‰äº‘ï¼ˆå¦‚AWSï¼‰ï¼Œè¿˜æ˜¯ç½‘ç»œå­˜å‚¨ï¼ˆå¦‚NFSã€GlusterFSã€Cephï¼‰éƒ½ä½œä¸ºé›†ç¾¤èµ„æºçš„ä¸€éƒ¨åˆ†ä½¿ç”¨ï¼Œæå¤§æé«˜å­˜å‚¨ä½¿ç”¨çµæ´»æ€§ã€‚ æ‰¹å¤„ç† æä¾›ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œå®šæ—¶ä»»åŠ¡ï¼›æ»¡è¶³æ‰¹é‡æ•°æ®å¤„ç†å’Œåˆ†æçš„åœºæ™¯ã€‚ Kubeadm æ¦‚è¿° kubeadmæ˜¯Kubernetesé¡¹ç›®è‡ªå¸¦çš„åŠé›†ç¾¤æ„å»ºå·¥å…·ï¼Œè´Ÿè´£æ‰§è¡Œæ„å»ºä¸€ä¸ªæœ€å°åŒ–çš„å¯ç”¨é›†ç¾¤ä»¥åŠå°†å…¶å¯åŠ¨ç­‰çš„å¿…è¦åŸºæœ¬æ­¥éª¤ï¼Œkubeadmæ˜¯Kubernetesé›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†å·¥å…·ï¼Œå¯ç”¨äºå®ç°é›†ç¾¤çš„éƒ¨ç½²ã€å‡çº§ã€é™çº§åŠæ‹†é™¤ã€‚kubeadméƒ¨ç½²Kubernetesé›†ç¾¤æ˜¯å°†å¤§éƒ¨åˆ†èµ„æºä»¥podçš„æ–¹å¼è¿è¡Œï¼Œä¾‹å¦‚ï¼ˆkube-proxyã€kube-controller-managerã€kube-schedulerã€kube-apiserverã€flannel)éƒ½æ˜¯ä»¥podæ–¹å¼è¿è¡Œã€‚\nKubeadmä»…å…³å¿ƒå¦‚ä½•åˆå§‹åŒ–å¹¶å¯åŠ¨é›†ç¾¤ï¼Œä½™ä¸‹çš„å…¶ä»–æ“ä½œï¼Œä¾‹å¦‚å®‰è£…Kubernetes Dashboardã€ç›‘æ§ç³»ç»Ÿã€æ—¥å¿—ç³»ç»Ÿç­‰å¿…è¦çš„é™„åŠ ç»„ä»¶åˆ™ä¸åœ¨å…¶è€ƒè™‘èŒƒå›´ä¹‹å†…ï¼Œéœ€è¦ç®¡ç†å‘˜è‡ªè¡Œéƒ¨ç½²ã€‚\nKubeadmé›†æˆäº†Kubeadm initå’Œkubeadm joinç­‰å·¥å…·ç¨‹åºï¼Œå…¶ä¸­kubeadm initç”¨äºé›†ç¾¤çš„å¿«é€Ÿåˆå§‹åŒ–ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯éƒ¨ç½²MasterèŠ‚ç‚¹çš„å„ä¸ªç»„ä»¶ï¼Œè€Œkubeadm joinåˆ™ç”¨äºå°†èŠ‚ç‚¹å¿«é€ŸåŠ å…¥åˆ°æŒ‡å®šé›†ç¾¤ä¸­ï¼Œå®ƒä»¬æ˜¯åˆ›å»ºKubernetesé›†ç¾¤æœ€ä½³å®è·µçš„â€œå¿«é€Ÿè·¯å¾„â€ã€‚å¦å¤–ï¼Œkubeadm tokenå¯äºé›†ç¾¤æ„å»ºåç®¡ç†ç”¨äºåŠ å…¥é›†ç¾¤æ—¶ä½¿ç”¨çš„è®¤è¯ä»¤ç‰Œï¼ˆtoken)ï¼Œè€Œkubeadm resetå‘½ä»¤çš„åŠŸèƒ½åˆ™æ˜¯åˆ é™¤é›†ç¾¤æ„å»ºè¿‡ç¨‹ä¸­ç”Ÿæˆçš„æ–‡ä»¶ä»¥é‡ç½®å›åˆå§‹çŠ¶æ€ã€‚\nKuberadm ç¦»çº¿éƒ¨ç½² k8s é›†ç¾¤ æ¶æ„å›¾ ç¯å¢ƒè§„åˆ’ æ“ä½œç³»ç»Ÿ IP CPU/MEM ä¸»æœºå è§’è‰² CentOS 7.7-x86_64 192.168.1.14 2/4G k8s-master Master CentOS 7.7-x86_64 192.168.1.15 2/4G k8s-node1 Work node CentOS 7.7-x86_64 192.168.1.16 2/4G k8s-node2 Work node ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘\nname version Docker 3:19.03.13 kubeadm v1.18.6 kubernetes v1.18.6 å®‰è£…å‰ææ¡ä»¶ Centos 7.x æœ€å°åŒ–å®‰è£… æ—¶é’ŸåŒæ­¥ ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ… æ›´æ–°ä¿®å¤ï¼Œè¯·ä¸‹è½½ k8s-kubeadmin.zip å‹ç¼©åŒ…ï¼ï¼ï¼\né“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg æå–ç ï¼šhhhh\néƒ¨ç½²MasterèŠ‚ç‚¹ æ‰§è¡Œè‡ªåŠ¨å®‰è£…è„šæœ¬ å°†ä¸‹è½½åˆ°çš„ç¨‹åºåŒ…æ‹·è´åˆ° k8s-master èŠ‚ç‚¹è§£å‹ï¼Œæˆ‘è¿™é‡Œçš„masterèŠ‚ç‚¹æ˜¯ 192.168.1.14\n[root@localhost ~]# ip a | egrep global inet 192.168.1.14/24 brd 192.168.1.255 scope global noprefixroute eth0 [root@localhost ~]# ls anaconda-ks.cfg k8s-kubeadm.tar.gz [root@localhost ~]# tar xf k8s-kubeadm.tar.gz [root@localhost ~]# cd k8s-kubeadm [root@localhost k8s-kubeadm]# ls docker-ce-19.03.12.tar.gz flannel-v0.12.0-linux-amd64.tar.gz install.sh k8s-imagesV1.18.6.tar.gz k8s-V1.18.6.tar.gz kube-flannel.yml packages.tar.gz # æ‰§è¡Œè„šæœ¬ ./install.sh [ä¸»æœºå] [root@localhost k8s-kubeadm]# ./install.sh k8s-master ç­‰å¾…è„šæœ¬æ‰§è¡Œè‡ªåŠ¨å®‰è£…ã€‚ã€‚ã€‚\næ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‡ºç°ä»¥ä¸‹æç¤ºï¼š\nå› ä¸ºå†…æ ¸è¿›è¡Œäº†å‡çº§ï¼Œè¯·é‡å¯æœåŠ¡å™¨ã€‚\né‡å¯ä»¥åï¼Œå†…æ ¸ç‰ˆæœ¬æ›´æ–°ä¸º 5.8.13\nä½¿ç”¨ kubeadm åˆå§‹åŒ–é›†ç¾¤ kubeadm init --kubernetes-version=v1.18.6 --apiserver-advertise-address=192.168.1.14 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12 ç­‰å¾…é›†ç¾¤åˆå§‹åŒ–å®Œæˆã€‚ã€‚ã€‚\nkubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e \\ --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4 ä¸Šé¢å‘½ä»¤è®°å½•ä¸‹æ¥ï¼Œè¿™æ˜¯å°† node èŠ‚ç‚¹åŠ å…¥åˆ° é›†ç¾¤çš„æ‰§è¡Œæ“ä½œå‘½ä»¤ã€‚\nå‡ºç°å¦‚ä¸Šæç¤ºï¼Œé›†ç¾¤åˆå§‹åŒ–æˆåŠŸï¼Œæ‰§è¡Œæç¤ºå‘½ä»¤ï¼š\n[root@k8s-master ~]# mkdir -p $HOME/.kube [root@k8s-master ~]# cp -i /etc/kubernetes/admin.conf $HOME/.kube/config [root@k8s-master ~]# chown $(id -u):$(id -g) $HOME/.kube/config ä½¿ç”¨ kubectl æŸ¥çœ‹ nodes\n[root@k8s-master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSION k8s-master NotReady master 74s v1.18.6 åˆå§‹åŒ–ç½‘ç»œæ’ä»¶ flannel # è¿›å…¥å‹ç¼©åçš„ç›®å½•é‡Œ [root@k8s-master ~]# cd k8s-kubeadm/ # å¼€å§‹è¿›è¡Œ flannel åˆå§‹åŒ–å®‰è£… [root@k8s-master k8s-kubeadm]# kubectl apply -f kube-flannel.yml podsecuritypolicy.policy/psp.flannel.unprivileged created clusterrole.rbac.authorization.k8s.io/flannel created clusterrolebinding.rbac.authorization.k8s.io/flannel created serviceaccount/flannel created configmap/kube-flannel-cfg created daemonset.apps/kube-flannel-ds created flannel åˆå§‹åŒ–å®Œæˆåï¼ŒæŸ¥çœ‹ nodes çŠ¶æ€ï¼š\n[root@k8s-master k8s-kubeadm]# kubectl get nodes NAME STATUS ROLES AGE VERSION k8s-master Ready master 3m58s v1.18.6 åˆ°æ­¤ï¼Œé€šè¿‡ kubeadm åˆå§‹åŒ–å®‰è£… master èŠ‚ç‚¹å®Œæ¯•ã€‚æ¥ä¸‹æ¥æ˜¯ node èŠ‚ç‚¹å°±å¾ˆç®€å•ã€‚\néƒ¨ç½²nodeèŠ‚ç‚¹ å°†ä¸‹è½½çš„å‹ç¼©åŒ…æ‹·è´åˆ° node èŠ‚ç‚¹æ‰§è¡Œ [root@k8s-master ~]# scp k8s-kubeadm.tar.gz 192.168.1.15:/root/ ------ä»¥ä¸‹nodeèŠ‚ç‚¹æ‰§è¡Œ------ [root@localhost ~]# ls anaconda-ks.cfg k8s-kubeadm.tar.gz [root@localhost ~]# tar xf k8s-kubeadm.tar.gz [root@localhost ~]# cd k8s-kubeadm/ # ./install.sh ä¸»æœºå [root@localhost k8s-kubeadm]# ./install.sh k8s-node1 è¿™é‡Œå’Œä¸Šé¢ master åˆå§‹åŒ–ä¸€æ ·ï¼Œå®Œæˆåé‡å¯ä¸»æœºã€‚\né‡å¯å®Œæˆåï¼Œæ‰§è¡Œ join å‘½ä»¤åŠ å…¥é›†ç¾¤ # å°±æ˜¯ä¸Šé¢è®°å½•çš„å‘½ä»¤ kubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e \\ --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4 åˆ‡æ¢åˆ° k8s-master æŸ¥çœ‹ k8s-node1 æ˜¯å¦åŠ å…¥é›†ç¾¤ k8s-node1 æˆåŠŸåŠ å…¥é›†ç¾¤ï¼Œå‰©ä¸‹çš„ node èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„æ“ä½œã€‚\nåˆ°æ­¤ï¼Œé€šè¿‡ kubeadm æ­å»º k8s ç¯å¢ƒå·²ç»å®Œæˆã€‚\nk8s é›†ç¾¤ç®€å•æµ‹è¯• æ³¨æ„ï¼šæœ¬èŠ‚æµ‹è¯•éœ€è¦ç½‘ç»œæ‹‰å–é•œåƒï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œå°† é•œåƒæ‹·è´åˆ°ä¸»æœºé‡Œ æ‰€éœ€é•œåƒï¼š nginx:alpine / busybox\nè¿™é‡Œåšä¸€ä¸ªç®€å•çš„å°æµ‹è¯•æ¥è¯æ˜é›†ç¾¤æ˜¯å¥åº·æ­£å¸¸è¿è¡Œçš„ã€‚\nåˆ›å»ºä¸€ä¸ª nginx pod [root@k8s-master ~]# kubectl run nginx-deploy --image=nginx:alpine pod/nginx-deploy created [root@k8s-master ~]# kubectl get pods NAME READY STATUS RESTARTS AGE nginx-deploy 1/1 Running 0 11s [root@k8s-master ~]# kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES nginx-deploy 1/1 Running 0 18s 10.244.1.2 k8s-node1 ä¸º nginx pod åˆ›å»ºä¸€ä¸ªæœåŠ¡ [root@k8s-master ~]# kubectl expose pod nginx-deploy --name=nginx --port=80 --target-port=80 --protocol=TCP service/nginx exposed [root@k8s-master ~]# kubectl get service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.96.0.1 443/TCP 21m nginx ClusterIP 10.106.14.253 80/TCP 9s [root@k8s-master ~]# curl 10.106.14.253 \u003c!DOCTYPE html\u003e Welcome to nginx! Welcome to nginx! If you see this page, the nginx web server is successfully installed and working. Further configuration is required.\nFor online documentation and support please refer to ","wordCount":"2379","inLanguage":"en","datePublished":"2021-10-01T00:00:00+08:00","dateModified":"2021-10-01T00:00:00+08:00","author":[{"@type":"Person","name":"lvbibir"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lvbibir.cn/posts/tech/kubeadm_deploy_k8s_v1.18.6_offline/"},"publisher":{"@type":"Organization","name":"lvbibir's Blog","logo":{"@type":"ImageObject","url":"https://www.lvbibir.cn/img/avatar.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.lvbibir.cn accesskey=h title="lvbibir's Blog (Alt + H)"><img src=https://www.lvbibir.cn/img/avatar.png alt=logo aria-label=logo height=35>lvbibir's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.lvbibir.cn/search title="ğŸ” æœç´¢ (Alt + /)" accesskey=/><span>ğŸ” æœç´¢</span></a></li><li><a href=https://www.lvbibir.cn/ title="ğŸ  ä¸»é¡µ"><span>ğŸ  ä¸»é¡µ</span></a></li><li><a href=https://www.lvbibir.cn/posts title="ğŸ“š æ–‡ç« "><span>ğŸ“š æ–‡ç« </span></a></li><li><a href=https://www.lvbibir.cn/tags title="ğŸ§© æ ‡ç­¾"><span>ğŸ§© æ ‡ç­¾</span></a></li><li><a href=https://www.lvbibir.cn/archives/ title="â± æ—¶é—´è½´"><span>â± æ—¶é—´è½´</span></a></li><li><a href=https://www.lvbibir.cn/about title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº"><span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span></a></li><li><a href=https://www.lvbibir.cn/links title="ğŸ¤ å‹é“¾"><span>ğŸ¤ å‹é“¾</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://www.lvbibir.cn>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://www.lvbibir.cn/posts/>ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href=https://www.lvbibir.cn/posts/tech/>ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div><h1 class=post-title>kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6</h1><div class=post-meta>åˆ›å»º:&nbsp;<span title='2021-10-01 00:00:00 +0800 +0800'>2021-10-01</span>&nbsp;|&nbsp;æ›´æ–°:&nbsp;2021-10-01&nbsp;|&nbsp;å­—æ•°:&nbsp;2379å­—&nbsp;|&nbsp;æ—¶é•¿:&nbsp;5åˆ†é’Ÿ&nbsp;|&nbsp;
ä½œè€…:&nbsp;lvbibir
&nbsp;|&nbsp;æ ‡ç­¾: &nbsp;<ul class=post-tags-meta><a href=https://www.lvbibir.cn/tags/k8s/>k8s</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>æ–‡ç« ç›®å½•</span></summary><div class=inner><ul><li><a href=#kubeadm-%e6%90%ad%e5%bb%ba-k8s-%e9%9b%86%e7%be%a4-%e7%a6%bb%e7%ba%bf%e7%89%88-v1186 aria-label="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6">kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6</a><ul><li><a href=#kubernetes-%e6%a6%82%e8%bf%b0 aria-label="Kubernetes æ¦‚è¿°">Kubernetes æ¦‚è¿°</a><ul><li><a href=#kubernetes-%e6%98%af%e4%bb%80%e4%b9%88 aria-label="kubernetes æ˜¯ä»€ä¹ˆ">kubernetes æ˜¯ä»€ä¹ˆ</a></li><li><a href=#kubernetes-%e7%89%b9%e6%80%a7 aria-label="Kubernetes ç‰¹æ€§">Kubernetes ç‰¹æ€§</a></li><li><a href=#kubeadm-%e6%a6%82%e8%bf%b0 aria-label="Kubeadm æ¦‚è¿°">Kubeadm æ¦‚è¿°</a></li></ul></li><li><a href=#kuberadm-%e7%a6%bb%e7%ba%bf%e9%83%a8%e7%bd%b2-k8s-%e9%9b%86%e7%be%a4 aria-label="Kuberadm ç¦»çº¿éƒ¨ç½² k8s é›†ç¾¤">Kuberadm ç¦»çº¿éƒ¨ç½² k8s é›†ç¾¤</a><ul><li><a href=#%e6%9e%b6%e6%9e%84%e5%9b%be aria-label=æ¶æ„å›¾>æ¶æ„å›¾</a></li><li><a href=#%e7%8e%af%e5%a2%83%e8%a7%84%e5%88%92 aria-label=ç¯å¢ƒè§„åˆ’>ç¯å¢ƒè§„åˆ’</a></li><li><a href=#%e5%ae%89%e8%a3%85%e5%89%8d%e6%8f%90%e6%9d%a1%e4%bb%b6 aria-label=å®‰è£…å‰ææ¡ä»¶>å®‰è£…å‰ææ¡ä»¶</a></li><li><a href=#%e4%b8%8b%e8%bd%bd%e7%a6%bb%e7%ba%bf%e7%a8%8b%e5%ba%8f%e5%8c%85 aria-label=ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…>ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…</a></li><li><a href=#%e9%83%a8%e7%bd%b2master%e8%8a%82%e7%82%b9 aria-label=éƒ¨ç½²MasterèŠ‚ç‚¹>éƒ¨ç½²MasterèŠ‚ç‚¹</a></li><li><a href=#%e9%83%a8%e7%bd%b2node%e8%8a%82%e7%82%b9 aria-label=éƒ¨ç½²nodeèŠ‚ç‚¹>éƒ¨ç½²nodeèŠ‚ç‚¹</a></li></ul></li><li><a href=#k8s-%e9%9b%86%e7%be%a4%e7%ae%80%e5%8d%95%e6%b5%8b%e8%af%95 aria-label="k8s é›†ç¾¤ç®€å•æµ‹è¯•">k8s é›†ç¾¤ç®€å•æµ‹è¯•</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=kubeadm-æ­å»º-k8s-é›†ç¾¤-ç¦»çº¿ç‰ˆ-v1186>kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6<a hidden class=anchor aria-hidden=true href=#kubeadm-æ­å»º-k8s-é›†ç¾¤-ç¦»çº¿ç‰ˆ-v1186>#</a></h1><p>å‚è€ƒï¼šhttps://www.cnblogs.com/hukey/p/13773927.html</p><h2 id=kubernetes-æ¦‚è¿°>Kubernetes æ¦‚è¿°<a hidden class=anchor aria-hidden=true href=#kubernetes-æ¦‚è¿°>#</a></h2><h3 id=kubernetes-æ˜¯ä»€ä¹ˆ>kubernetes æ˜¯ä»€ä¹ˆ<a hidden class=anchor aria-hidden=true href=#kubernetes-æ˜¯ä»€ä¹ˆ>#</a></h3><ul><li>kubernetes æ˜¯ Google åœ¨ 2014å¹´å¼€æºçš„ä¸€ä¸ªå®¹å™¨é›†ç¾¤ç®¡ç†å¹³å°ï¼Œkubernetesç®€ç§° k8s</li><li>k8sç”¨äºå®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ï¼Œæ‰©å±•å’Œç®¡ç†ã€‚</li><li>k8sæä¾›äº†å®¹å™¨çš„ç¼–æ’ï¼Œèµ„æºè°ƒåº¦ï¼Œå¼¹æ€§ä¼¸ç¼©ï¼Œéƒ¨ç½²ç®¡ç†ï¼ŒæœåŠ¡å‘ç°ç­‰ä¸€ç³»åˆ—åŠŸèƒ½</li><li>kubernetesç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–åº”ç”¨ç®€å•é«˜æ•ˆ</li></ul><h3 id=kubernetes-ç‰¹æ€§>Kubernetes ç‰¹æ€§<a hidden class=anchor aria-hidden=true href=#kubernetes-ç‰¹æ€§>#</a></h3><ul><li>è‡ªæˆ‘ä¿®å¤<ul><li>åœ¨èŠ‚ç‚¹æ•…éšœæ—¶é‡æ–°å¯åŠ¨å¤±è´¥çš„å®¹å™¨ï¼Œæ›¿æ¢å’Œé‡æ–°éƒ¨ç½²ï¼Œä¿è¯é¢„æœŸçš„å‰¯æœ¬æ•°é‡ï¼›æ€æ­»å¥åº·æ£€æŸ¥å¤±è´¥çš„å®¹å™¨ï¼Œå¹¶ä¸”åœ¨æœªå‡†å¤‡å¥½ä¹‹å‰ä¸ä¼šå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç¡®ä¿çº¿ä¸ŠæœåŠ¡ä¸ä¸­æ–­ã€‚</li></ul></li><li>ä¼¸ç¼©æ€§<ul><li>ä½¿ç”¨å‘½ä»¤ã€UIæˆ–è€…åŸºäºCPUä½¿ç”¨æƒ…å†µè‡ªåŠ¨å¿«é€Ÿæ‰©å®¹å’Œç¼©å®¹åº”ç”¨ç¨‹åºå®ä¾‹ï¼Œä¿è¯åº”ç”¨ä¸šåŠ¡é«˜å³°å¹¶å‘æ—¶çš„é«˜å¯ç”¨æ€§ï¼›ä¸šåŠ¡ä½å³°æ—¶å›æ”¶èµ„æºï¼Œä»¥æœ€å°æˆæœ¬è¿è¡ŒæœåŠ¡ã€‚</li></ul></li><li>è‡ªåŠ¨éƒ¨ç½²å’Œå›æ»š<ul><li>K8Sé‡‡ç”¨æ»šåŠ¨æ›´æ–°ç­–ç•¥æ›´æ–°åº”ç”¨ï¼Œä¸€æ¬¡æ›´æ–°ä¸€ä¸ªPodï¼Œè€Œä¸æ˜¯åŒæ—¶åˆ é™¤æ‰€æœ‰Podï¼Œå¦‚æœæ›´æ–°è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œå°†å›æ»šæ›´æ”¹ï¼Œç¡®ä¿å‡çº§ä¸å—å½±å“ä¸šåŠ¡ã€‚</li></ul></li><li>æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡<ul><li>K8Sä¸ºå¤šä¸ªå®¹å™¨æä¾›ä¸€ä¸ªç»Ÿä¸€è®¿é—®å…¥å£ï¼ˆå†…éƒ¨IPåœ°å€å’Œä¸€ä¸ªDNSåç§°ï¼‰ï¼Œå¹¶ä¸”è´Ÿè½½å‡è¡¡å…³è”çš„æ‰€æœ‰å®¹å™¨ï¼Œä½¿å¾—ç”¨æˆ·æ— éœ€è€ƒè™‘å®¹å™¨IPé—®é¢˜ã€‚</li></ul></li><li>æœºå¯†å’Œé…ç½®ç®¡ç†<ul><li>ç®¡ç†æœºå¯†æ•°æ®å’Œåº”ç”¨ç¨‹åºé…ç½®ï¼Œè€Œä¸éœ€è¦æŠŠæ•æ„Ÿæ•°æ®æš´éœ²åœ¨é•œåƒé‡Œï¼Œæé«˜æ•æ„Ÿæ•°æ®å®‰å…¨æ€§ã€‚å¹¶å¯ä»¥å°†ä¸€äº›å¸¸ç”¨çš„é…ç½®å­˜å‚¨åœ¨K8Sä¸­ï¼Œæ–¹ä¾¿åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚</li></ul></li><li>å­˜å‚¨ç¼–æ’<ul><li>æŒ‚è½½å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿï¼Œæ— è®ºæ˜¯æ¥è‡ªæœ¬åœ°å­˜å‚¨ï¼Œå…¬æœ‰äº‘ï¼ˆå¦‚AWSï¼‰ï¼Œè¿˜æ˜¯ç½‘ç»œå­˜å‚¨ï¼ˆå¦‚NFSã€GlusterFSã€Cephï¼‰éƒ½ä½œä¸ºé›†ç¾¤èµ„æºçš„ä¸€éƒ¨åˆ†ä½¿ç”¨ï¼Œæå¤§æé«˜å­˜å‚¨ä½¿ç”¨çµæ´»æ€§ã€‚</li></ul></li><li>æ‰¹å¤„ç†<ul><li>æä¾›ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œå®šæ—¶ä»»åŠ¡ï¼›æ»¡è¶³æ‰¹é‡æ•°æ®å¤„ç†å’Œåˆ†æçš„åœºæ™¯ã€‚</li></ul></li></ul><h3 id=kubeadm-æ¦‚è¿°>Kubeadm æ¦‚è¿°<a hidden class=anchor aria-hidden=true href=#kubeadm-æ¦‚è¿°>#</a></h3><blockquote><p><code>kubeadm</code>æ˜¯<code>Kubernetes</code>é¡¹ç›®è‡ªå¸¦çš„åŠé›†ç¾¤æ„å»ºå·¥å…·ï¼Œè´Ÿè´£æ‰§è¡Œæ„å»ºä¸€ä¸ªæœ€å°åŒ–çš„å¯ç”¨é›†ç¾¤ä»¥åŠå°†å…¶å¯åŠ¨ç­‰çš„å¿…è¦åŸºæœ¬æ­¥éª¤ï¼Œ<code>kubeadm</code>æ˜¯<code>Kubernetes</code>é›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†å·¥å…·ï¼Œå¯ç”¨äºå®ç°é›†ç¾¤çš„éƒ¨ç½²ã€å‡çº§ã€é™çº§åŠæ‹†é™¤ã€‚<code>kubeadm</code>éƒ¨ç½²<code>Kubernetes</code>é›†ç¾¤æ˜¯å°†å¤§éƒ¨åˆ†èµ„æºä»¥<code>pod</code>çš„æ–¹å¼è¿è¡Œï¼Œä¾‹å¦‚ï¼ˆ<code>kube-proxy</code>ã€<code>kube-controller-manager</code>ã€<code>kube-scheduler</code>ã€<code>kube-apiserver</code>ã€<code>flannel</code>)éƒ½æ˜¯ä»¥<code>pod</code>æ–¹å¼è¿è¡Œã€‚</p><p><code>Kubeadm</code>ä»…å…³å¿ƒå¦‚ä½•åˆå§‹åŒ–å¹¶å¯åŠ¨é›†ç¾¤ï¼Œä½™ä¸‹çš„å…¶ä»–æ“ä½œï¼Œä¾‹å¦‚å®‰è£…<code>Kubernetes Dashboard</code>ã€ç›‘æ§ç³»ç»Ÿã€æ—¥å¿—ç³»ç»Ÿç­‰å¿…è¦çš„é™„åŠ ç»„ä»¶åˆ™ä¸åœ¨å…¶è€ƒè™‘èŒƒå›´ä¹‹å†…ï¼Œéœ€è¦ç®¡ç†å‘˜è‡ªè¡Œéƒ¨ç½²ã€‚</p><p><code>Kubeadm</code>é›†æˆäº†<code>Kubeadm init</code>å’Œ<code>kubeadm join</code>ç­‰å·¥å…·ç¨‹åºï¼Œå…¶ä¸­<code>kubeadm init</code>ç”¨äºé›†ç¾¤çš„å¿«é€Ÿåˆå§‹åŒ–ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯éƒ¨ç½²MasterèŠ‚ç‚¹çš„å„ä¸ªç»„ä»¶ï¼Œè€Œ<code>kubeadm join</code>åˆ™ç”¨äºå°†èŠ‚ç‚¹å¿«é€ŸåŠ å…¥åˆ°æŒ‡å®šé›†ç¾¤ä¸­ï¼Œå®ƒä»¬æ˜¯åˆ›å»º<code>Kubernetes</code>é›†ç¾¤æœ€ä½³å®è·µçš„â€œå¿«é€Ÿè·¯å¾„â€ã€‚å¦å¤–ï¼Œ<code>kubeadm token</code>å¯äºé›†ç¾¤æ„å»ºåç®¡ç†ç”¨äºåŠ å…¥é›†ç¾¤æ—¶ä½¿ç”¨çš„è®¤è¯ä»¤ç‰Œï¼ˆt<code>oken</code>)ï¼Œè€Œ<code>kubeadm reset</code>å‘½ä»¤çš„åŠŸèƒ½åˆ™æ˜¯åˆ é™¤é›†ç¾¤æ„å»ºè¿‡ç¨‹ä¸­ç”Ÿæˆçš„æ–‡ä»¶ä»¥é‡ç½®å›åˆå§‹çŠ¶æ€ã€‚</p></blockquote><h2 id=kuberadm-ç¦»çº¿éƒ¨ç½²-k8s-é›†ç¾¤>Kuberadm ç¦»çº¿éƒ¨ç½² k8s é›†ç¾¤<a hidden class=anchor aria-hidden=true href=#kuberadm-ç¦»çº¿éƒ¨ç½²-k8s-é›†ç¾¤>#</a></h2><h3 id=æ¶æ„å›¾>æ¶æ„å›¾<a hidden class=anchor aria-hidden=true href=#æ¶æ„å›¾>#</a></h3><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171931291-1034333699.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171931291-1034333699.png alt=img></a></p><h3 id=ç¯å¢ƒè§„åˆ’>ç¯å¢ƒè§„åˆ’<a hidden class=anchor aria-hidden=true href=#ç¯å¢ƒè§„åˆ’>#</a></h3><table><thead><tr><th>æ“ä½œç³»ç»Ÿ</th><th>IP</th><th>CPU/MEM</th><th>ä¸»æœºå</th><th>è§’è‰²</th></tr></thead><tbody><tr><td>CentOS 7.7-x86_64</td><td>192.168.1.14</td><td>2/4G</td><td>k8s-master</td><td>Master</td></tr><tr><td>CentOS 7.7-x86_64</td><td>192.168.1.15</td><td>2/4G</td><td>k8s-node1</td><td>Work node</td></tr><tr><td>CentOS 7.7-x86_64</td><td>192.168.1.16</td><td>2/4G</td><td>k8s-node2</td><td>Work node</td></tr></tbody></table><p>ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘</p><table><thead><tr><th>name</th><th>version</th></tr></thead><tbody><tr><td>Docker</td><td>3:19.03.13</td></tr><tr><td>kubeadm</td><td>v1.18.6</td></tr><tr><td>kubernetes</td><td>v1.18.6</td></tr></tbody></table><h3 id=å®‰è£…å‰ææ¡ä»¶>å®‰è£…å‰ææ¡ä»¶<a hidden class=anchor aria-hidden=true href=#å®‰è£…å‰ææ¡ä»¶>#</a></h3><ul><li>Centos 7.x æœ€å°åŒ–å®‰è£…</li><li>æ—¶é’ŸåŒæ­¥</li></ul><h3 id=ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…>ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…<a hidden class=anchor aria-hidden=true href=#ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…>#</a></h3><p><strong>æ›´æ–°ä¿®å¤ï¼Œè¯·ä¸‹è½½ k8s-kubeadmin.zip å‹ç¼©åŒ…ï¼ï¼ï¼</strong></p><blockquote><p>é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg
æå–ç ï¼šhhhh</p></blockquote><h3 id=éƒ¨ç½²masterèŠ‚ç‚¹>éƒ¨ç½²MasterèŠ‚ç‚¹<a hidden class=anchor aria-hidden=true href=#éƒ¨ç½²masterèŠ‚ç‚¹>#</a></h3><ol><li><strong>æ‰§è¡Œè‡ªåŠ¨å®‰è£…è„šæœ¬</strong></li></ol><p>å°†ä¸‹è½½åˆ°çš„ç¨‹åºåŒ…æ‹·è´åˆ° k8s-master èŠ‚ç‚¹è§£å‹ï¼Œæˆ‘è¿™é‡Œçš„masterèŠ‚ç‚¹æ˜¯ 192.168.1.14</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip a | egrep global</span>
</span></span><span style=display:flex><span>    inet 192.168.1.14/24 brd 192.168.1.255 scope global noprefixroute eth0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>anaconda-ks.cfg  k8s-kubeadm.tar.gz
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># tar xf k8s-kubeadm.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># cd k8s-kubeadm</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>docker-ce-19.03.12.tar.gz  flannel-v0.12.0-linux-amd64.tar.gz  install.sh  k8s-imagesV1.18.6.tar.gz  k8s-V1.18.6.tar.gz  kube-flannel.yml packages.tar.gz
</span></span><span style=display:flex><span><span style=color:#75715e># æ‰§è¡Œè„šæœ¬ ./install.sh [ä¸»æœºå]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># ./install.sh k8s-master</span>
</span></span></code></pre></div><p>ç­‰å¾…è„šæœ¬æ‰§è¡Œè‡ªåŠ¨å®‰è£…ã€‚ã€‚ã€‚</p><p>æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‡ºç°ä»¥ä¸‹æç¤ºï¼š</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930922-2104593063.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930922-2104593063.png alt=img></a></p><p>å› ä¸ºå†…æ ¸è¿›è¡Œäº†å‡çº§ï¼Œè¯·é‡å¯æœåŠ¡å™¨ã€‚</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930656-34274130.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930656-34274130.png alt=img></a></p><p>é‡å¯ä»¥åï¼Œå†…æ ¸ç‰ˆæœ¬æ›´æ–°ä¸º <code>5.8.13</code></p><ol><li><strong>ä½¿ç”¨ kubeadm åˆå§‹åŒ–é›†ç¾¤</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubeadm init --kubernetes-version<span style=color:#f92672>=</span>v1.18.6 --apiserver-advertise-address<span style=color:#f92672>=</span>192.168.1.14 --pod-network-cidr<span style=color:#f92672>=</span>10.244.0.0/16 --service-cidr<span style=color:#f92672>=</span>10.96.0.0/12
</span></span></code></pre></div><p>ç­‰å¾…é›†ç¾¤åˆå§‹åŒ–å®Œæˆã€‚ã€‚ã€‚</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930352-470109468.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930352-470109468.png alt=img></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4
</span></span></code></pre></div><p>ä¸Šé¢å‘½ä»¤è®°å½•ä¸‹æ¥ï¼Œè¿™æ˜¯å°† node èŠ‚ç‚¹åŠ å…¥åˆ° é›†ç¾¤çš„æ‰§è¡Œæ“ä½œå‘½ä»¤ã€‚</p><p>å‡ºç°å¦‚ä¸Šæç¤ºï¼Œé›†ç¾¤åˆå§‹åŒ–æˆåŠŸï¼Œæ‰§è¡Œæç¤ºå‘½ä»¤ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># mkdir -p $HOME/.kube</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># chown $(id -u):$(id -g) $HOME/.kube/config</span>
</span></span></code></pre></div><p>ä½¿ç”¨ kubectl æŸ¥çœ‹ nodes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get nodes</span>
</span></span><span style=display:flex><span>NAME         STATUS     ROLES    AGE   VERSION
</span></span><span style=display:flex><span>k8s-master   NotReady   master   74s   v1.18.6
</span></span></code></pre></div><ol><li><strong>åˆå§‹åŒ–ç½‘ç»œæ’ä»¶ flannel</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># è¿›å…¥å‹ç¼©åçš„ç›®å½•é‡Œ</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># cd k8s-kubeadm/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å¼€å§‹è¿›è¡Œ flannel åˆå§‹åŒ–å®‰è£…</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># kubectl apply -f kube-flannel.yml</span>
</span></span><span style=display:flex><span>podsecuritypolicy.policy/psp.flannel.unprivileged created
</span></span><span style=display:flex><span>clusterrole.rbac.authorization.k8s.io/flannel created
</span></span><span style=display:flex><span>clusterrolebinding.rbac.authorization.k8s.io/flannel created
</span></span><span style=display:flex><span>serviceaccount/flannel created
</span></span><span style=display:flex><span>configmap/kube-flannel-cfg created
</span></span><span style=display:flex><span>daemonset.apps/kube-flannel-ds created
</span></span></code></pre></div><p>flannel åˆå§‹åŒ–å®Œæˆåï¼ŒæŸ¥çœ‹ nodes çŠ¶æ€ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get nodes</span>
</span></span><span style=display:flex><span>NAME         STATUS   ROLES    AGE     VERSION
</span></span><span style=display:flex><span>k8s-master   Ready    master   3m58s   v1.18.6
</span></span></code></pre></div><p>åˆ°æ­¤ï¼Œé€šè¿‡ kubeadm åˆå§‹åŒ–å®‰è£… master èŠ‚ç‚¹å®Œæ¯•ã€‚æ¥ä¸‹æ¥æ˜¯ node èŠ‚ç‚¹å°±å¾ˆç®€å•ã€‚</p><h3 id=éƒ¨ç½²nodeèŠ‚ç‚¹>éƒ¨ç½²nodeèŠ‚ç‚¹<a hidden class=anchor aria-hidden=true href=#éƒ¨ç½²nodeèŠ‚ç‚¹>#</a></h3><ol><li>å°†ä¸‹è½½çš„å‹ç¼©åŒ…æ‹·è´åˆ° node èŠ‚ç‚¹æ‰§è¡Œ</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># scp k8s-kubeadm.tar.gz 192.168.1.15:/root/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------ä»¥ä¸‹nodeèŠ‚ç‚¹æ‰§è¡Œ------
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>anaconda-ks.cfg  k8s-kubeadm.tar.gz
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># tar xf k8s-kubeadm.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># cd k8s-kubeadm/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ./install.sh ä¸»æœºå</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># ./install.sh k8s-node1</span>
</span></span></code></pre></div><p>è¿™é‡Œå’Œä¸Šé¢ master åˆå§‹åŒ–ä¸€æ ·ï¼Œå®Œæˆåé‡å¯ä¸»æœºã€‚</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930087-1054624258.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930087-1054624258.png alt=img></a></p><ol><li>é‡å¯å®Œæˆåï¼Œæ‰§è¡Œ join å‘½ä»¤åŠ å…¥é›†ç¾¤</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># å°±æ˜¯ä¸Šé¢è®°å½•çš„å‘½ä»¤</span>
</span></span><span style=display:flex><span>kubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4
</span></span></code></pre></div><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929732-1855734873.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929732-1855734873.png alt=img></a></p><ol><li>åˆ‡æ¢åˆ° k8s-master æŸ¥çœ‹ k8s-node1 æ˜¯å¦åŠ å…¥é›†ç¾¤</li></ol><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929194-630188569.png><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929194-630188569.png alt=img></a></p><p>k8s-node1 æˆåŠŸåŠ å…¥é›†ç¾¤ï¼Œå‰©ä¸‹çš„ node èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„æ“ä½œã€‚</p><p>åˆ°æ­¤ï¼Œé€šè¿‡ kubeadm æ­å»º k8s ç¯å¢ƒå·²ç»å®Œæˆã€‚</p><h2 id=k8s-é›†ç¾¤ç®€å•æµ‹è¯•>k8s é›†ç¾¤ç®€å•æµ‹è¯•<a hidden class=anchor aria-hidden=true href=#k8s-é›†ç¾¤ç®€å•æµ‹è¯•>#</a></h2><blockquote><p>æ³¨æ„ï¼šæœ¬èŠ‚æµ‹è¯•éœ€è¦ç½‘ç»œæ‹‰å–é•œåƒï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œå°† é•œåƒæ‹·è´åˆ°ä¸»æœºé‡Œ æ‰€éœ€é•œåƒï¼š nginx:alpine / busybox</p></blockquote><p>è¿™é‡Œåšä¸€ä¸ªç®€å•çš„å°æµ‹è¯•æ¥è¯æ˜é›†ç¾¤æ˜¯å¥åº·æ­£å¸¸è¿è¡Œçš„ã€‚</p><ol><li>åˆ›å»ºä¸€ä¸ª nginx pod</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl run nginx-deploy --image=nginx:alpine</span>
</span></span><span style=display:flex><span>pod/nginx-deploy created
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get pods</span>
</span></span><span style=display:flex><span>NAME           READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>nginx-deploy   1/1     Running   <span style=color:#ae81ff>0</span>          11s
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get pods -o wide</span>
</span></span><span style=display:flex><span>NAME           READY   STATUS    RESTARTS   AGE   IP           NODE        NOMINATED NODE   READINESS GATES
</span></span><span style=display:flex><span>nginx-deploy   1/1     Running   <span style=color:#ae81ff>0</span>          18s   10.244.1.2   k8s-node1   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><ol><li>ä¸º nginx pod åˆ›å»ºä¸€ä¸ªæœåŠ¡</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl expose pod nginx-deploy --name=nginx --port=80 --target-port=80 --protocol=TCP</span>
</span></span><span style=display:flex><span>service/nginx exposed
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get service</span>
</span></span><span style=display:flex><span>NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>   AGE
</span></span><span style=display:flex><span>kubernetes   ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP   21m
</span></span><span style=display:flex><span>nginx        ClusterIP   10.106.14.253   &lt;none&gt;        80/TCP    9s
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># curl 10.106.14.253</span>
</span></span><span style=display:flex><span>&lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>&lt;html&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;style&gt;
</span></span><span style=display:flex><span>    body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        width: 35em;
</span></span><span style=display:flex><span>        margin: <span style=color:#ae81ff>0</span> auto;
</span></span><span style=display:flex><span>        font-family: Tahoma, Verdana, Arial, sans-serif;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>&lt;/style&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span style=display:flex><span>&lt;p&gt;If you see this page, the nginx web server is successfully installed and
</span></span><span style=display:flex><span>working. Further configuration is required.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;For online documentation and support please refer to
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
</span></span><span style=display:flex><span>Commercial support is available at
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;&lt;em&gt;Thank you <span style=color:#66d9ef>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span></code></pre></div><ol><li>åˆ›å»ºä¸€ä¸ª busybox pod æ¥é€šè¿‡ nginx æœåŠ¡åè®¿é—®</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl run client --image=busybox -it</span>
</span></span><span style=display:flex><span>If you don<span style=color:#960050;background-color:#1e0010>&#39;</span>t see a command prompt, try pressing enter.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------ é€šè¿‡æœåŠ¡åæ¥è®¿é—® nginx æœåŠ¡ ------ 
</span></span><span style=display:flex><span>/ <span style=color:#75715e># wget -O - -q nginx</span>
</span></span><span style=display:flex><span>&lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>&lt;html&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;style&gt;
</span></span><span style=display:flex><span>    body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        width: 35em;
</span></span><span style=display:flex><span>        margin: <span style=color:#ae81ff>0</span> auto;
</span></span><span style=display:flex><span>        font-family: Tahoma, Verdana, Arial, sans-serif;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>&lt;/style&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span style=display:flex><span>&lt;p&gt;If you see this page, the nginx web server is successfully installed and
</span></span><span style=display:flex><span>working. Further configuration is required.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;For online documentation and support please refer to
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
</span></span><span style=display:flex><span>Commercial support is available at
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;&lt;em&gt;Thank you <span style=color:#66d9ef>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/ <span style=color:#75715e># cat /etc/resolv.conf</span>
</span></span><span style=display:flex><span>nameserver 10.96.0.10
</span></span><span style=display:flex><span>search default.svc.cluster.local svc.cluster.local cluster.local
</span></span><span style=display:flex><span>options ndots:5
</span></span></code></pre></div><p>æµ‹è¯•é€šè¿‡ï¼Œç½‘ç»œåŠdnsæœåŠ¡æ­£å¸¸ã€‚é›†ç¾¤å¤„äºæ­£å¸¸å¥åº·çŠ¶æ€ã€‚</p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://www.lvbibir.cn/img/wechat_pay.png alt=wechat_pay></a><p>å¾®ä¿¡</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://www.lvbibir.cn/img/alipay.png alt=alipay></a><p>æ”¯ä»˜å®</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>ğŸ§§ é¼“åŠ±</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://www.lvbibir.cn/posts/tech/kolla-ansible_deploy_allinone_train/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>kolla-ansibleéƒ¨ç½²Trainç‰ˆopenstackï¼ˆall-in-oneï¼‰</span></a>
<a class=next href=https://www.lvbibir.cn/posts/tech/kubeadm_deploy_k8s_v1.22.3/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>kubeadmå¿«é€Ÿæ­å»ºK8sé›†ç¾¤v1.22.3</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>ğŸ’¬è¯„è®º</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.5.11/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo-lvbibir.vercel.app/",el:"#tcomment",lang:"zh-CN",region:"ap-guangzhou",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><footer class=footer><span>Copyright
&copy;
2020-2022
<a href=https://www.lvbibir.cn style=color:#939393>lvbibir's Blog</a>
All Rights Reserved</span>
<a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393>äº¬ICPå¤‡2021023168å·-1</a>&nbsp;
<span id=busuanzi_container><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css>æ€»è®¿å®¢æ•°: <span id=busuanzi_value_site_uv></span>
æ€»è®¿é—®é‡: <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a>
<script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.body.addEventListener("copy",function(e){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let t=e.clipboardData||window.clipboardData;if(t){e.preventDefault();let n=window.getSelection().toString()+`

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œlvbibir's Blogã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
åŸæ–‡é“¾æ¥ï¼š`+location.href,s=window.getSelection().toString()+`

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œlvbibir's Blogã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
åŸæ–‡é“¾æ¥ï¼š`+location.href;t.setData("text/html",n),t.setData("text/plain",s)}}})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="ğŸ“„å¤åˆ¶";function s(){t.innerText="ğŸ‘ŒğŸ»å·²å¤åˆ¶!",setTimeout(()=>{t.innerText="ğŸ“„å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent+`
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œlvbibir's Blogã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
åŸæ–‡é“¾æ¥ï¼š`+location.href;navigator.clipboard.writeText(t),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>