<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6 | lvbibir's Blog</title><meta name=keywords content="linux,centos,kubernetes"><meta name=description content="ç¯å¢ƒè§„åˆ’ æ“ä½œç³»ç»Ÿ IP CPU/MEM ä¸»æœºå è§’è‰² CentOS 7.7-x86_64 192.168.1.14 2/4G k8s-master Master CentOS 7.7-x86_64 192.168.1.15 2/4G k8s-node1 Work node CentOS 7.7-x86_64 192.168.1.16 2/4G k8s-node2 Work node ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘ name version Docker 3:19.03.13 kubeadm v1.18.6 kubernetes v1.18.6 å®‰è£…å‰ææ¡ä»¶ Centos 7.x æœ€å°åŒ–å®‰è£… æ—¶é’ŸåŒæ­¥ ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ… é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg æå–ç ï¼šhhhh éƒ¨ç½²Maste"><meta name=author content="
ä½œè€…:&nbsp;lvbibir"><link rel=canonical href=https://www.lvbibir.cn/posts/tech/kubernetes-v1.18.6-kubeadm-offline/><link crossorigin=anonymous href=/assets/css/stylesheet.27ec2ab56d27168f4436b50fcf541dd26c35482c551d49559610d6fcbac73a35.css integrity="sha256-J+wqtW0nFo9ENrUPz1Qd0mw1SCxVHUlVlhDW/LrHOjU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=16x16 href=https://www.lvbibir.cn/img/avatar.gif><link rel=icon type=image/png sizes=32x32 href=https://www.lvbibir.cn/img/avatar.gif><link rel=apple-touch-icon href=https://www.lvbibir.cn/img/avatar.gif><link rel=mask-icon href=https://www.lvbibir.cn/img/avatar.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6"><meta property="og:description" content="ç¯å¢ƒè§„åˆ’ æ“ä½œç³»ç»Ÿ IP CPU/MEM ä¸»æœºå è§’è‰² CentOS 7.7-x86_64 192.168.1.14 2/4G k8s-master Master CentOS 7.7-x86_64 192.168.1.15 2/4G k8s-node1 Work node CentOS 7.7-x86_64 192.168.1.16 2/4G k8s-node2 Work node ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘ name version Docker 3:19.03.13 kubeadm v1.18.6 kubernetes v1.18.6 å®‰è£…å‰ææ¡ä»¶ Centos 7.x æœ€å°åŒ–å®‰è£… æ—¶é’ŸåŒæ­¥ ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ… é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg æå–ç ï¼šhhhh éƒ¨ç½²Maste"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lvbibir.cn/posts/tech/kubernetes-v1.18.6-kubeadm-offline/"><meta property="og:image" content="https://image.lvbibir.cn/blog/kubernetes.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-01T00:00:00+00:00"><meta property="article:modified_time" content="2021-10-01T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://image.lvbibir.cn/blog/kubernetes.png"><meta name=twitter:title content="kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6"><meta name=twitter:description content="ç¯å¢ƒè§„åˆ’ æ“ä½œç³»ç»Ÿ IP CPU/MEM ä¸»æœºå è§’è‰² CentOS 7.7-x86_64 192.168.1.14 2/4G k8s-master Master CentOS 7.7-x86_64 192.168.1.15 2/4G k8s-node1 Work node CentOS 7.7-x86_64 192.168.1.16 2/4G k8s-node2 Work node ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘ name version Docker 3:19.03.13 kubeadm v1.18.6 kubernetes v1.18.6 å®‰è£…å‰ææ¡ä»¶ Centos 7.x æœ€å°åŒ–å®‰è£… æ—¶é’ŸåŒæ­¥ ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ… é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg æå–ç ï¼šhhhh éƒ¨ç½²Maste"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"ğŸ“š æ–‡ç« ","item":"https://www.lvbibir.cn/posts/"},{"@type":"ListItem","position":3,"name":"ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯","item":"https://www.lvbibir.cn/posts/tech/"},{"@type":"ListItem","position":4,"name":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6","item":"https://www.lvbibir.cn/posts/tech/kubernetes-v1.18.6-kubeadm-offline/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6","name":"kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6","description":"ç¯å¢ƒè§„åˆ’ æ“ä½œç³»ç»Ÿ IP CPU/MEM ä¸»æœºå è§’è‰² CentOS 7.7-x86_64 192.168.1.14 2/4G k8s-master Master CentOS 7.7-x86_64 192.168.1.15 2/4G k8s-node1 Work node CentOS 7.7-x86_64 192.168.1.16 2/4G k8s-node2 Work node ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘ name version Docker 3:19.03.13 kubeadm v1.18.6 kubernetes v1.18.6 å®‰è£…å‰ææ¡ä»¶ Centos 7.x æœ€å°åŒ–å®‰è£… æ—¶é’ŸåŒæ­¥ ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ… é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg æå–ç ï¼šhhhh éƒ¨ç½²Maste","keywords":["linux","centos","kubernetes"],"articleBody":"ç¯å¢ƒè§„åˆ’ æ“ä½œç³»ç»Ÿ IP CPU/MEM ä¸»æœºå è§’è‰² CentOS 7.7-x86_64 192.168.1.14 2/4G k8s-master Master CentOS 7.7-x86_64 192.168.1.15 2/4G k8s-node1 Work node CentOS 7.7-x86_64 192.168.1.16 2/4G k8s-node2 Work node ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘\nname version Docker 3:19.03.13 kubeadm v1.18.6 kubernetes v1.18.6 å®‰è£…å‰ææ¡ä»¶\nCentos 7.x æœ€å°åŒ–å®‰è£… æ—¶é’ŸåŒæ­¥ ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…\né“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg æå–ç ï¼šhhhh\néƒ¨ç½²MasterèŠ‚ç‚¹ æ‰§è¡Œè‡ªåŠ¨å®‰è£…è„šæœ¬ å°†ä¸‹è½½åˆ°çš„ç¨‹åºåŒ…æ‹·è´åˆ° k8s-master èŠ‚ç‚¹è§£å‹ï¼Œæˆ‘è¿™é‡Œçš„masterèŠ‚ç‚¹æ˜¯ 192.168.1.14\n[root@localhost ~]# ip a | egrep global inet 192.168.1.14/24 brd 192.168.1.255 scope global noprefixroute eth0 [root@localhost ~]# ls anaconda-ks.cfg k8s-kubeadm.tar.gz [root@localhost ~]# tar xf k8s-kubeadm.tar.gz [root@localhost ~]# cd k8s-kubeadm [root@localhost k8s-kubeadm]# ls docker-ce-19.03.12.tar.gz flannel-v0.12.0-linux-amd64.tar.gz install.sh k8s-imagesV1.18.6.tar.gz k8s-V1.18.6.tar.gz kube-flannel.yml packages.tar.gz # æ‰§è¡Œè„šæœ¬ ./install.sh [ä¸»æœºå] [root@localhost k8s-kubeadm]# ./install.sh k8s-master ç­‰å¾…è„šæœ¬æ‰§è¡Œè‡ªåŠ¨å®‰è£…ã€‚ã€‚ã€‚\næ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‡ºç°ä»¥ä¸‹æç¤ºï¼š\nå› ä¸ºå†…æ ¸è¿›è¡Œäº†å‡çº§ï¼Œè¯·é‡å¯æœåŠ¡å™¨ã€‚\né‡å¯ä»¥åï¼Œå†…æ ¸ç‰ˆæœ¬æ›´æ–°ä¸º 5.8.13\nä½¿ç”¨ kubeadm åˆå§‹åŒ–é›†ç¾¤ kubeadm init --kubernetes-version=v1.18.6 --apiserver-advertise-address=192.168.1.14 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12 ç­‰å¾…é›†ç¾¤åˆå§‹åŒ–å®Œæˆã€‚ã€‚ã€‚\nkubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e \\ --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4 ä¸Šé¢å‘½ä»¤è®°å½•ä¸‹æ¥ï¼Œè¿™æ˜¯å°† node èŠ‚ç‚¹åŠ å…¥åˆ° é›†ç¾¤çš„æ‰§è¡Œæ“ä½œå‘½ä»¤ã€‚\nå‡ºç°å¦‚ä¸Šæç¤ºï¼Œé›†ç¾¤åˆå§‹åŒ–æˆåŠŸï¼Œæ‰§è¡Œæç¤ºå‘½ä»¤ï¼š\n[root@k8s-master ~]# mkdir -p $HOME/.kube [root@k8s-master ~]# cp -i /etc/kubernetes/admin.conf $HOME/.kube/config [root@k8s-master ~]# chown $(id -u):$(id -g) $HOME/.kube/config ä½¿ç”¨ kubectl æŸ¥çœ‹ nodes\n[root@k8s-master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSION k8s-master NotReady master 74s v1.18.6 åˆå§‹åŒ–ç½‘ç»œæ’ä»¶ flannel # è¿›å…¥å‹ç¼©åçš„ç›®å½•é‡Œ [root@k8s-master ~]# cd k8s-kubeadm/ # å¼€å§‹è¿›è¡Œ flannel åˆå§‹åŒ–å®‰è£… [root@k8s-master k8s-kubeadm]# kubectl apply -f kube-flannel.yml podsecuritypolicy.policy/psp.flannel.unprivileged created clusterrole.rbac.authorization.k8s.io/flannel created clusterrolebinding.rbac.authorization.k8s.io/flannel created serviceaccount/flannel created configmap/kube-flannel-cfg created daemonset.apps/kube-flannel-ds created flannel åˆå§‹åŒ–å®Œæˆåï¼ŒæŸ¥çœ‹ nodes çŠ¶æ€ï¼š\n[root@k8s-master k8s-kubeadm]# kubectl get nodes NAME STATUS ROLES AGE VERSION k8s-master Ready master 3m58s v1.18.6 åˆ°æ­¤ï¼Œé€šè¿‡ kubeadm åˆå§‹åŒ–å®‰è£… master èŠ‚ç‚¹å®Œæ¯•ã€‚æ¥ä¸‹æ¥æ˜¯ node èŠ‚ç‚¹å°±å¾ˆç®€å•ã€‚\néƒ¨ç½²nodeèŠ‚ç‚¹ å°†ä¸‹è½½çš„å‹ç¼©åŒ…æ‹·è´åˆ° node èŠ‚ç‚¹æ‰§è¡Œ [root@k8s-master ~]# scp k8s-kubeadm.tar.gz 192.168.1.15:/root/ ------ä»¥ä¸‹nodeèŠ‚ç‚¹æ‰§è¡Œ------ [root@localhost ~]# ls anaconda-ks.cfg k8s-kubeadm.tar.gz [root@localhost ~]# tar xf k8s-kubeadm.tar.gz [root@localhost ~]# cd k8s-kubeadm/ # ./install.sh ä¸»æœºå [root@localhost k8s-kubeadm]# ./install.sh k8s-node1 è¿™é‡Œå’Œä¸Šé¢ master åˆå§‹åŒ–ä¸€æ ·ï¼Œå®Œæˆåé‡å¯ä¸»æœºã€‚\né‡å¯å®Œæˆåï¼Œæ‰§è¡Œ join å‘½ä»¤åŠ å…¥é›†ç¾¤ # å°±æ˜¯ä¸Šé¢è®°å½•çš„å‘½ä»¤ kubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e \\ --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4 åˆ‡æ¢åˆ° k8s-master æŸ¥çœ‹ k8s-node1 æ˜¯å¦åŠ å…¥é›†ç¾¤ k8s-node1 æˆåŠŸåŠ å…¥é›†ç¾¤ï¼Œå‰©ä¸‹çš„ node èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„æ“ä½œã€‚\nåˆ°æ­¤ï¼Œé€šè¿‡ kubeadm æ­å»º k8s ç¯å¢ƒå·²ç»å®Œæˆã€‚\nk8s é›†ç¾¤ç®€å•æµ‹è¯• æ³¨æ„ï¼šæœ¬èŠ‚æµ‹è¯•éœ€è¦ç½‘ç»œæ‹‰å–é•œåƒï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œå°† é•œåƒæ‹·è´åˆ°ä¸»æœºé‡Œ æ‰€éœ€é•œåƒï¼š nginx:alpine / busybox\nè¿™é‡Œåšä¸€ä¸ªç®€å•çš„å°æµ‹è¯•æ¥è¯æ˜é›†ç¾¤æ˜¯å¥åº·æ­£å¸¸è¿è¡Œçš„ã€‚\nåˆ›å»ºä¸€ä¸ª nginx pod [root@k8s-master ~]# kubectl run nginx-deploy --image=nginx:alpine pod/nginx-deploy created [root@k8s-master ~]# kubectl get pods NAME READY STATUS RESTARTS AGE nginx-deploy 1/1 Running 0 11s [root@k8s-master ~]# kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES nginx-deploy 1/1 Running 0 18s 10.244.1.2 k8s-node1 ä¸º nginx pod åˆ›å»ºä¸€ä¸ªæœåŠ¡ [root@k8s-master ~]# kubectl expose pod nginx-deploy --name=nginx --port=80 --target-port=80 --protocol=TCP service/nginx exposed [root@k8s-master ~]# kubectl get service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.96.0.1 443/TCP 21m nginx ClusterIP 10.106.14.253 80/TCP 9s [root@k8s-master ~]# curl 10.106.14.253 \u003c!DOCTYPE html\u003e Welcome to nginx! Welcome to nginx! If you see this page, the nginx web server is successfully installed and working. Further configuration is required.\nFor online documentation and support please refer to ","wordCount":"1109","inLanguage":"en","image":"https://image.lvbibir.cn/blog/kubernetes.png","datePublished":"2021-10-01T00:00:00Z","dateModified":"2021-10-01T00:00:00Z","author":{"@type":"Person","name":"lvbibir"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lvbibir.cn/posts/tech/kubernetes-v1.18.6-kubeadm-offline/"},"publisher":{"@type":"Organization","name":"lvbibir's Blog","logo":{"@type":"ImageObject","url":"https://www.lvbibir.cn/img/avatar.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.lvbibir.cn accesskey=h title="lvbibir's Blog (Alt + H)"><img src=https://www.lvbibir.cn/img/avatar.gif alt aria-label=logo height=35>lvbibir's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li class=menu-item><a href=https://www.lvbibir.cn/search title="ğŸ” æœç´¢ (Alt + /)" accesskey=/><span>ğŸ” æœç´¢</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/ title="ğŸ¡ ä¸»é¡µ"><span>ğŸ¡ ä¸»é¡µ</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/posts title="ğŸ“š æ–‡ç« "><span>ğŸ“š æ–‡ç« </span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/tags title="ğŸ·ï¸ æ ‡ç­¾"><span>ğŸ·ï¸ æ ‡ç­¾</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/archives title="ğŸ“ˆ å½’æ¡£"><span>ğŸ“ˆ å½’æ¡£</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/links title="ğŸ¤ å‹é“¾"><span>ğŸ¤ å‹é“¾</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/talk title="ğŸ’¬ è¯´è¯´"><span>ğŸ’¬ è¯´è¯´</span></a></li><li class=menu-item><a href=https://www.lvbibir.cn/about title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº"><span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span></a></li></ul></nav></header><main class="main page"><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://www.lvbibir.cn>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://www.lvbibir.cn/posts/>ğŸ“š æ–‡ç« </a>&nbsp;Â»&nbsp;<a href=https://www.lvbibir.cn/posts/tech/>ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div><h1 class=post-title>kubeadm æ­å»º k8s é›†ç¾¤ [ç¦»çº¿ç‰ˆ] v1.18.6</h1><div class=post-meta>åˆ›å»º:&nbsp;<span title='2021-10-01 00:00:00 +0000 UTC'>2021-10-01</span>&nbsp;|&nbsp;æ›´æ–°:&nbsp;2021-10-01&nbsp;|&nbsp;å­—æ•°:&nbsp;1109å­—&nbsp;|&nbsp;æ—¶é•¿:&nbsp;3åˆ†é’Ÿ&nbsp;|&nbsp;
ä½œè€…:&nbsp;lvbibir
&nbsp;|&nbsp;æ ‡ç­¾: &nbsp;<ul class=post-tags-meta><a href=https://www.lvbibir.cn/tags/kubernetes/>kubernetes</a></ul><span id=busuanzi_container_page_pv>&nbsp;| è®¿é—®: <span id=busuanzi_value_page_pv></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>æ–‡ç« ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e7%8e%af%e5%a2%83%e8%a7%84%e5%88%92 aria-label=ç¯å¢ƒè§„åˆ’>ç¯å¢ƒè§„åˆ’</a></li><li><a href=#%e9%83%a8%e7%bd%b2master%e8%8a%82%e7%82%b9 aria-label=éƒ¨ç½²MasterèŠ‚ç‚¹>éƒ¨ç½²MasterèŠ‚ç‚¹</a></li><li><a href=#%e9%83%a8%e7%bd%b2node%e8%8a%82%e7%82%b9 aria-label=éƒ¨ç½²nodeèŠ‚ç‚¹>éƒ¨ç½²nodeèŠ‚ç‚¹</a></li><li><a href=#k8s-%e9%9b%86%e7%be%a4%e7%ae%80%e5%8d%95%e6%b5%8b%e8%af%95 aria-label="k8s é›†ç¾¤ç®€å•æµ‹è¯•">k8s é›†ç¾¤ç®€å•æµ‹è¯•</a></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=å‚è€ƒ>å‚è€ƒ</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=ç¯å¢ƒè§„åˆ’>ç¯å¢ƒè§„åˆ’<a hidden class=anchor aria-hidden=true href=#ç¯å¢ƒè§„åˆ’>#</a></h1><table><thead><tr><th>æ“ä½œç³»ç»Ÿ</th><th>IP</th><th>CPU/MEM</th><th>ä¸»æœºå</th><th>è§’è‰²</th></tr></thead><tbody><tr><td>CentOS 7.7-x86_64</td><td>192.168.1.14</td><td>2/4G</td><td>k8s-master</td><td>Master</td></tr><tr><td>CentOS 7.7-x86_64</td><td>192.168.1.15</td><td>2/4G</td><td>k8s-node1</td><td>Work node</td></tr><tr><td>CentOS 7.7-x86_64</td><td>192.168.1.16</td><td>2/4G</td><td>k8s-node2</td><td>Work node</td></tr></tbody></table><p>ã€è½¯ä»¶åŒ…ç‰ˆæœ¬å·ã€‘</p><table><thead><tr><th>name</th><th>version</th></tr></thead><tbody><tr><td>Docker</td><td>3:19.03.13</td></tr><tr><td>kubeadm</td><td>v1.18.6</td></tr><tr><td>kubernetes</td><td>v1.18.6</td></tr></tbody></table><p>å®‰è£…å‰ææ¡ä»¶</p><ul><li>Centos 7.x æœ€å°åŒ–å®‰è£…</li><li>æ—¶é’ŸåŒæ­¥</li></ul><p>ä¸‹è½½ç¦»çº¿ç¨‹åºåŒ…</p><blockquote><p>é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Q3jbJcgq0rH8jK-LTpa6Vg
æå–ç ï¼šhhhh</p></blockquote><h1 id=éƒ¨ç½²masterèŠ‚ç‚¹>éƒ¨ç½²MasterèŠ‚ç‚¹<a hidden class=anchor aria-hidden=true href=#éƒ¨ç½²masterèŠ‚ç‚¹>#</a></h1><ol><li><strong>æ‰§è¡Œè‡ªåŠ¨å®‰è£…è„šæœ¬</strong></li></ol><p>å°†ä¸‹è½½åˆ°çš„ç¨‹åºåŒ…æ‹·è´åˆ° k8s-master èŠ‚ç‚¹è§£å‹ï¼Œæˆ‘è¿™é‡Œçš„masterèŠ‚ç‚¹æ˜¯ 192.168.1.14</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip a | egrep global</span>
</span></span><span style=display:flex><span>    inet 192.168.1.14/24 brd 192.168.1.255 scope global noprefixroute eth0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>anaconda-ks.cfg  k8s-kubeadm.tar.gz
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># tar xf k8s-kubeadm.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># cd k8s-kubeadm</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>docker-ce-19.03.12.tar.gz  flannel-v0.12.0-linux-amd64.tar.gz  install.sh  k8s-imagesV1.18.6.tar.gz  k8s-V1.18.6.tar.gz  kube-flannel.yml packages.tar.gz
</span></span><span style=display:flex><span><span style=color:#75715e># æ‰§è¡Œè„šæœ¬ ./install.sh [ä¸»æœºå]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># ./install.sh k8s-master</span>
</span></span></code></pre></div><p>ç­‰å¾…è„šæœ¬æ‰§è¡Œè‡ªåŠ¨å®‰è£…ã€‚ã€‚ã€‚</p><p>æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‡ºç°ä»¥ä¸‹æç¤ºï¼š</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930922-2104593063.png target=_blank rel=noopener style=color:#42b983 ;><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930922-2104593063.png alt=img></a></p><p>å› ä¸ºå†…æ ¸è¿›è¡Œäº†å‡çº§ï¼Œè¯·é‡å¯æœåŠ¡å™¨ã€‚</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930656-34274130.png target=_blank rel=noopener style=color:#42b983 ;><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930656-34274130.png alt=img></a></p><p>é‡å¯ä»¥åï¼Œå†…æ ¸ç‰ˆæœ¬æ›´æ–°ä¸º <code>5.8.13</code></p><ol><li><strong>ä½¿ç”¨ kubeadm åˆå§‹åŒ–é›†ç¾¤</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubeadm init --kubernetes-version<span style=color:#f92672>=</span>v1.18.6 --apiserver-advertise-address<span style=color:#f92672>=</span>192.168.1.14 --pod-network-cidr<span style=color:#f92672>=</span>10.244.0.0/16 --service-cidr<span style=color:#f92672>=</span>10.96.0.0/12
</span></span></code></pre></div><p>ç­‰å¾…é›†ç¾¤åˆå§‹åŒ–å®Œæˆã€‚ã€‚ã€‚</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930352-470109468.png target=_blank rel=noopener style=color:#42b983 ;><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930352-470109468.png alt=img></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4
</span></span></code></pre></div><p>ä¸Šé¢å‘½ä»¤è®°å½•ä¸‹æ¥ï¼Œè¿™æ˜¯å°† node èŠ‚ç‚¹åŠ å…¥åˆ° é›†ç¾¤çš„æ‰§è¡Œæ“ä½œå‘½ä»¤ã€‚</p><p>å‡ºç°å¦‚ä¸Šæç¤ºï¼Œé›†ç¾¤åˆå§‹åŒ–æˆåŠŸï¼Œæ‰§è¡Œæç¤ºå‘½ä»¤ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># mkdir -p $HOME/.kube</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># chown $(id -u):$(id -g) $HOME/.kube/config</span>
</span></span></code></pre></div><p>ä½¿ç”¨ kubectl æŸ¥çœ‹ nodes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get nodes</span>
</span></span><span style=display:flex><span>NAME         STATUS     ROLES    AGE   VERSION
</span></span><span style=display:flex><span>k8s-master   NotReady   master   74s   v1.18.6
</span></span></code></pre></div><ol><li><strong>åˆå§‹åŒ–ç½‘ç»œæ’ä»¶ flannel</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># è¿›å…¥å‹ç¼©åçš„ç›®å½•é‡Œ</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># cd k8s-kubeadm/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å¼€å§‹è¿›è¡Œ flannel åˆå§‹åŒ–å®‰è£…</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># kubectl apply -f kube-flannel.yml</span>
</span></span><span style=display:flex><span>podsecuritypolicy.policy/psp.flannel.unprivileged created
</span></span><span style=display:flex><span>clusterrole.rbac.authorization.k8s.io/flannel created
</span></span><span style=display:flex><span>clusterrolebinding.rbac.authorization.k8s.io/flannel created
</span></span><span style=display:flex><span>serviceaccount/flannel created
</span></span><span style=display:flex><span>configmap/kube-flannel-cfg created
</span></span><span style=display:flex><span>daemonset.apps/kube-flannel-ds created
</span></span></code></pre></div><p>flannel åˆå§‹åŒ–å®Œæˆåï¼ŒæŸ¥çœ‹ nodes çŠ¶æ€ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get nodes</span>
</span></span><span style=display:flex><span>NAME         STATUS   ROLES    AGE     VERSION
</span></span><span style=display:flex><span>k8s-master   Ready    master   3m58s   v1.18.6
</span></span></code></pre></div><p>åˆ°æ­¤ï¼Œé€šè¿‡ kubeadm åˆå§‹åŒ–å®‰è£… master èŠ‚ç‚¹å®Œæ¯•ã€‚æ¥ä¸‹æ¥æ˜¯ node èŠ‚ç‚¹å°±å¾ˆç®€å•ã€‚</p><h1 id=éƒ¨ç½²nodeèŠ‚ç‚¹>éƒ¨ç½²nodeèŠ‚ç‚¹<a hidden class=anchor aria-hidden=true href=#éƒ¨ç½²nodeèŠ‚ç‚¹>#</a></h1><ol><li>å°†ä¸‹è½½çš„å‹ç¼©åŒ…æ‹·è´åˆ° node èŠ‚ç‚¹æ‰§è¡Œ</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># scp k8s-kubeadm.tar.gz 192.168.1.15:/root/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------ä»¥ä¸‹nodeèŠ‚ç‚¹æ‰§è¡Œ------
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>anaconda-ks.cfg  k8s-kubeadm.tar.gz
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># tar xf k8s-kubeadm.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># cd k8s-kubeadm/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ./install.sh ä¸»æœºå</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost k8s-kubeadm<span style=color:#f92672>]</span><span style=color:#75715e># ./install.sh k8s-node1</span>
</span></span></code></pre></div><p>è¿™é‡Œå’Œä¸Šé¢ master åˆå§‹åŒ–ä¸€æ ·ï¼Œå®Œæˆåé‡å¯ä¸»æœºã€‚</p><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930087-1054624258.png target=_blank rel=noopener style=color:#42b983 ;><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171930087-1054624258.png alt=img></a></p><ol><li>é‡å¯å®Œæˆåï¼Œæ‰§è¡Œ join å‘½ä»¤åŠ å…¥é›†ç¾¤</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># å°±æ˜¯ä¸Šé¢è®°å½•çš„å‘½ä»¤</span>
</span></span><span style=display:flex><span>kubeadm join 192.168.1.14:6443 --token utml0h.gj2nafii8xm1512e <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --discovery-token-ca-cert-hash sha256:e91fb35667cf51c76b9afa288e4416a1314a1244158123ffbcee55b7ac4a70d4
</span></span></code></pre></div><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929732-1855734873.png target=_blank rel=noopener style=color:#42b983 ;><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929732-1855734873.png alt=img></a></p><ol><li>åˆ‡æ¢åˆ° k8s-master æŸ¥çœ‹ k8s-node1 æ˜¯å¦åŠ å…¥é›†ç¾¤</li></ol><p><a href=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929194-630188569.png target=_blank rel=noopener style=color:#42b983 ;><img loading=lazy src=https://img2020.cnblogs.com/blog/828019/202010/828019-20201006171929194-630188569.png alt=img></a></p><p>k8s-node1 æˆåŠŸåŠ å…¥é›†ç¾¤ï¼Œå‰©ä¸‹çš„ node èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„æ“ä½œã€‚</p><p>åˆ°æ­¤ï¼Œé€šè¿‡ kubeadm æ­å»º k8s ç¯å¢ƒå·²ç»å®Œæˆã€‚</p><h1 id=k8s-é›†ç¾¤ç®€å•æµ‹è¯•>k8s é›†ç¾¤ç®€å•æµ‹è¯•<a hidden class=anchor aria-hidden=true href=#k8s-é›†ç¾¤ç®€å•æµ‹è¯•>#</a></h1><blockquote><p>æ³¨æ„ï¼šæœ¬èŠ‚æµ‹è¯•éœ€è¦ç½‘ç»œæ‹‰å–é•œåƒï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œå°† é•œåƒæ‹·è´åˆ°ä¸»æœºé‡Œ æ‰€éœ€é•œåƒï¼š nginx:alpine / busybox</p></blockquote><p>è¿™é‡Œåšä¸€ä¸ªç®€å•çš„å°æµ‹è¯•æ¥è¯æ˜é›†ç¾¤æ˜¯å¥åº·æ­£å¸¸è¿è¡Œçš„ã€‚</p><ol><li>åˆ›å»ºä¸€ä¸ª nginx pod</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl run nginx-deploy --image=nginx:alpine</span>
</span></span><span style=display:flex><span>pod/nginx-deploy created
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get pods</span>
</span></span><span style=display:flex><span>NAME           READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>nginx-deploy   1/1     Running   <span style=color:#ae81ff>0</span>          11s
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get pods -o wide</span>
</span></span><span style=display:flex><span>NAME           READY   STATUS    RESTARTS   AGE   IP           NODE        NOMINATED NODE   READINESS GATES
</span></span><span style=display:flex><span>nginx-deploy   1/1     Running   <span style=color:#ae81ff>0</span>          18s   10.244.1.2   k8s-node1   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><ol><li>ä¸º nginx pod åˆ›å»ºä¸€ä¸ªæœåŠ¡</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl expose pod nginx-deploy --name=nginx --port=80 --target-port=80 --protocol=TCP</span>
</span></span><span style=display:flex><span>service/nginx exposed
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get service</span>
</span></span><span style=display:flex><span>NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>   AGE
</span></span><span style=display:flex><span>kubernetes   ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP   21m
</span></span><span style=display:flex><span>nginx        ClusterIP   10.106.14.253   &lt;none&gt;        80/TCP    9s
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># curl 10.106.14.253</span>
</span></span><span style=display:flex><span>&lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>&lt;html&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;style&gt;
</span></span><span style=display:flex><span>    body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        width: 35em;
</span></span><span style=display:flex><span>        margin: <span style=color:#ae81ff>0</span> auto;
</span></span><span style=display:flex><span>        font-family: Tahoma, Verdana, Arial, sans-serif;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>&lt;/style&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span style=display:flex><span>&lt;p&gt;If you see this page, the nginx web server is successfully installed and
</span></span><span style=display:flex><span>working. Further configuration is required.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;For online documentation and support please refer to
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
</span></span><span style=display:flex><span>Commercial support is available at
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;&lt;em&gt;Thank you <span style=color:#66d9ef>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span></code></pre></div><ol><li>åˆ›å»ºä¸€ä¸ª busybox pod æ¥é€šè¿‡ nginx æœåŠ¡åè®¿é—®</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl run client --image=busybox -it</span>
</span></span><span style=display:flex><span>If you don<span style=color:#960050;background-color:#1e0010>&#39;</span>t see a command prompt, try pressing enter.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------ é€šè¿‡æœåŠ¡åæ¥è®¿é—® nginx æœåŠ¡ ------ 
</span></span><span style=display:flex><span>/ <span style=color:#75715e># wget -O - -q nginx</span>
</span></span><span style=display:flex><span>&lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>&lt;html&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;style&gt;
</span></span><span style=display:flex><span>    body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        width: 35em;
</span></span><span style=display:flex><span>        margin: <span style=color:#ae81ff>0</span> auto;
</span></span><span style=display:flex><span>        font-family: Tahoma, Verdana, Arial, sans-serif;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>&lt;/style&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span style=display:flex><span>&lt;p&gt;If you see this page, the nginx web server is successfully installed and
</span></span><span style=display:flex><span>working. Further configuration is required.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;For online documentation and support please refer to
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
</span></span><span style=display:flex><span>Commercial support is available at
</span></span><span style=display:flex><span>&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;p&gt;&lt;em&gt;Thank you <span style=color:#66d9ef>for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/ <span style=color:#75715e># cat /etc/resolv.conf</span>
</span></span><span style=display:flex><span>nameserver 10.96.0.10
</span></span><span style=display:flex><span>search default.svc.cluster.local svc.cluster.local cluster.local
</span></span><span style=display:flex><span>options ndots:5
</span></span></code></pre></div><p>æµ‹è¯•é€šè¿‡ï¼Œç½‘ç»œåŠdnsæœåŠ¡æ­£å¸¸ã€‚é›†ç¾¤å¤„äºæ­£å¸¸å¥åº·çŠ¶æ€ã€‚</p><h1 id=å‚è€ƒ>å‚è€ƒ<a hidden class=anchor aria-hidden=true href=#å‚è€ƒ>#</a></h1><p><a href=https://www.cnblogs.com/hukey/p/13773927.html target=_blank rel=noopener style=color:#42b983 ;>https://www.cnblogs.com/hukey/p/13773927.html</a></p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://www.lvbibir.cn/img/wechat_pay.png alt=wechat_pay></a><p>å¾®ä¿¡</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://www.lvbibir.cn/img/alipay.png alt=alipay></a><p>æ”¯ä»˜å®</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>ğŸ§§ é¼“åŠ±</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://www.lvbibir.cn/posts/tech/openstack-kolla-ansible-allinone-train/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>kolla-ansibleéƒ¨ç½²Trainç‰ˆopenstackï¼ˆall-in-oneï¼‰</span></a>
<a class=next href=https://www.lvbibir.cn/posts/tech/kubernetes-v1.22.3-kubeadm/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>kubernetes | ç®€ä»‹ | kubeadmæ­å»ºK8sé›†ç¾¤v1.22.3</span></a></nav></footer></div><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>ğŸ’¬è¯„è®º</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo.lvbibir.cn/",el:"#tcomment",lang:"zh-CN",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><a href=https://gohugo.io/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/frame-hugo-blue.svg></a>
<a href=https://github.com/adityatelange/hugo-PaperMod target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/theme-papermod-lightgrey.svg></a>
<a href=https://cn.aliyun.com/ target=_blank><img style=display:unset src=https://image.lvbibir.cn/blog/å›¾åºŠ-é˜¿é‡Œäº‘-orange.svg></a><br><span id=runtime_span></span>
<script type=text/javascript>function show_runtime(){window.setTimeout("show_runtime()",1e3),X=new Date("7/13/2021 1:00:00"),Y=new Date,T=Y.getTime()-X.getTime(),M=24*60*60*1e3,a=T/M,A=Math.floor(a),b=(a-A)*24,B=Math.floor(b),c=(b-B)*60,C=Math.floor((b-B)*60),D=Math.floor((c-C)*60),runtime_span.innerHTML="ç½‘ç«™å·²è¿è¡Œ"+A+"å¤©"+B+"å°æ—¶"+C+"åˆ†"+D+"ç§’"}show_runtime()</script>|
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span id=busuanzi_container>æ€»è®¿å®¢æ•°: <span id=busuanzi_value_site_uv></span>
|
æ€»è®¿é—®é‡: <span id=busuanzi_value_site_pv></span></span><br><a href=https://beian.miit.gov.cn/ target=_blank style="border-bottom:1px solid">äº¬ICPå¤‡2021023168å·-1</a>&nbsp;
|
<span>Copyright
&copy;
2020-2023
<a href=https://www.lvbibir.cn style="border-bottom:1px solid">lvbibir's Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a>
<script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="ğŸ“„å¤åˆ¶";function s(){t.innerText="ğŸ‘ŒğŸ»å·²å¤åˆ¶!",setTimeout(()=>{t.innerText="ğŸ“„å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild===n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>